<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    

    <!--Author-->
    
        <meta name="author" content="杨CC">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="杨CC的小世界"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="杨CC的小世界"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>杨CC的小世界</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="杨CC的小世界" type="application/atom+xml">
</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    首页
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    标签
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    分类
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    关于我?
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    归档文章
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">杨CC的小世界</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/APKDeeplens-%E8%87%AA%E5%8A%A8%E5%AF%B9APK%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0-%E9%A1%BA%E4%BE%BF%E5%87%BA%E4%B8%AA%E6%8A%A5%E5%91%8A/">
                APKDeeplens-自动对APK进行安全评估-顺便出个报告
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="APKDeepLens"><a href="#APKDeepLens" class="headerlink" title="APKDeepLens"></a>APKDeepLens</h1><p>APKDeepLens 是一个基于 Python 的工具，旨在扫描 Android 应用程序（APK 文件）是否存在安全漏洞。它专门针对 OWASP Top 10 移动漏洞，为开发人员、渗透测试人员和安全研究人员提供一种简单有效的方法来评估 Android 应用程序的安全状况。</p>
<p><a target="_blank" rel="noopener" href="https://private-user-images.githubusercontent.com/27950739/299625348-c9236e3d-60d5-4832-85dc-f09a449bade3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTA0MDAyOTksIm5iZiI6MTcxMDM5OTk5OSwicGF0aCI6Ii8yNzk1MDczOS8yOTk2MjUzNDgtYzkyMzZlM2QtNjBkNS00ODMyLTg1ZGMtZjA5YTQ0OWJhZGUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzE0VDA3MDYzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTYyOWZjNzRkYWUwNDlkMzUxMTI3ZDhkMjU0NjMwYTE1NTdlMzg3ZTVkYTFlZjJhNWNkNTcxM2ZiMDNhYTE3ZjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.gDYBdiQYyoOiNWTv-gbi43Wac2hmrEOiNiw9D3FK5dc"><img src="https://private-user-images.githubusercontent.com/27950739/299625348-c9236e3d-60d5-4832-85dc-f09a449bade3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTA0MDAyOTksIm5iZiI6MTcxMDM5OTk5OSwicGF0aCI6Ii8yNzk1MDczOS8yOTk2MjUzNDgtYzkyMzZlM2QtNjBkNS00ODMyLTg1ZGMtZjA5YTQ0OWJhZGUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzE0VDA3MDYzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTYyOWZjNzRkYWUwNDlkMzUxMTI3ZDhkMjU0NjMwYTE1NTdlMzg3ZTVkYTFlZjJhNWNkNTcxM2ZiMDNhYTE3ZjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.gDYBdiQYyoOiNWTv-gbi43Wac2hmrEOiNiw9D3FK5dc" alt="图像"></a></p>
<h2 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h2><p>APKDeepLens 是一个基于 Python 的工具，可对 APK 文件执行各种操作。其主要特点包括：</p>
<ul>
<li><strong>APK 分析</strong>-&gt; 扫描 Android 应用程序包 (APK) 文件是否存在安全漏洞。</li>
<li><strong>OWASP 覆盖范围</strong>-&gt; 涵盖 OWASP Top 10 漏洞，以确保全面的安全评估。</li>
<li><strong>高级检测</strong>-&gt; 利用自定义 python 代码进行 APK 文件分析和漏洞检测。</li>
<li><strong>敏感信息提取</strong>-&gt; 通过从APK文件中提取敏感信息来识别潜在的安全风险，例如不安全的身份验证&#x2F;授权密钥和不安全的请求协议。</li>
<li><strong>深入分析</strong>-&gt; 检测不安全的数据存储实践，包括与 SD 卡相关的数据，并突出显示代码中不安全请求协议的使用。</li>
<li><strong>意图过滤器漏洞</strong>-&gt; 通过分析从 AndroidManifest.xml 中提取的意图过滤器来查明漏洞。</li>
<li><strong>本地文件漏洞检测</strong>-&gt; 通过识别与本地文件操作相关的潜在错误处理来保护您的应用程序</li>
<li><strong>报告生成</strong>-&gt; 为每个扫描的 APK 生成详细且易于理解的报告，为开发人员提供可操作的见解。</li>
<li><strong>CI&#x2F;CD 集成</strong>-&gt; 旨在轻松集成到 CI&#x2F;CD 管道中，从而在开发工作流程中实现自动化安全测试。</li>
<li><strong>用户友好的界面</strong>-&gt; 颜色编码的终端输出可以轻松区分不同类型的结果。</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>要使用 APKDeepLens，您需要在系统上安装 Python 3.8 或更高版本。然后，您可以使用以下命令安装 APKDeepLens：</p>
<h3 id="对于Linux"><a href="#对于Linux" class="headerlink" title="对于Linux"></a>对于Linux</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/d78ui98/APKDeepLens/tree/main</span><br><span class="line">cd /APKDeepLens</span><br><span class="line">python3 -m venv venv</span><br><span class="line">source venv/bin/activate</span><br><span class="line">pip install -r requirements.txt</span><br><span class="line">python APKDeepLens.py --help</span><br></pre></td></tr></table></figure>



<h3 id="对于-Windows"><a href="#对于-Windows" class="headerlink" title="对于 Windows"></a>对于 Windows</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/d78ui98/APKDeepLens/tree/main</span><br><span class="line">cd \APKDeepLens</span><br><span class="line">python3 -m venv venv</span><br><span class="line">.\venv\Scripts\activate</span><br><span class="line">pip install -r .\requirements.txt</span><br><span class="line">python APKDeepLens.py --help</span><br></pre></td></tr></table></figure>



<h3 id="使用手动下载方式"><a href="#使用手动下载方式" class="headerlink" title="#使用手动下载方式"></a>#使用手动下载方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/d78ui98/APKDeepLens #打开链接</span><br><span class="line">#选择code</span><br><span class="line">#选择Download zip</span><br><span class="line">#解压</span><br><span class="line">#打开终端</span><br><span class="line">cd 解压目录</span><br><span class="line">python -m pip install -r requirements.txt #安装环境</span><br><span class="line">python -m venv venv #进入虚拟环境</span><br><span class="line">.\venv\Scripts\activate #进入虚拟环境</span><br><span class="line">python -m pip install -r .\requirements.txt #安装库</span><br><span class="line">python APKDeepLens.py --help #查看帮助</span><br></pre></td></tr></table></figure>



<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><p>要简单地扫描 APK，请使用以下命令。使用参数提及 apk 文件<code>-apk</code>。扫描完成后，详细报告将显示在控制台中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 APKDeepLens.py -apk file.apk</span><br></pre></td></tr></table></figure>

<p>如果您已经提取了源代码并希望提供其路径以进行更快的扫描，您可以使用以下命令。使用参数提及 android 应用程序的源代码<code>-source</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 APKDeepLens.py -apk file.apk -source &lt;source-code-path&gt;</span><br></pre></td></tr></table></figure>

<p>要在扫描后生成详细的 PDF 和 HTML 报告，您可以传递<code>-report</code>如下所述的参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 APKDeepLens.py -apk file.apk -report</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/apk2url-%E8%87%AA%E5%8A%A8%E6%8F%90%E5%8F%96apk%E4%B8%AD%E7%9A%84ip%E5%92%8C%E5%9F%9F%E5%90%8D%E5%B7%A5%E5%85%B7/">
                apk2url-自动提取apk中的ip和域名工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>在渗透测试中，攻击者可以通过对app进行逆向分析。获取app访问的url或者IP。从而对IP进行攻击，本文为大家介绍的这款工具，可以方便的为你分析app中存在的url。</p>
</blockquote>
<p>注意：本文仅供学习和研究，坚决反对一切危害网络安全的行为。</p>
<h1 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h1><p><code>apk2url</code> 可以轻松地将 URL 和 IP 端点从 APK 文件提取到 .txt 输出。这适合红队、渗透测试人员和开发人员收集信息，以快速识别与应用程序关联的端点。与 APKleaks、MobSF和 AppInfoScanner 相比，apk2url 识别出的端点数量明显增多。apk2url 进行了重写和升级，增加了 IP 支持、更强的正则表达式、自动过滤和 Jadx 反编译。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>在<code>kali</code>中安装也很简单，我们只需执行下面命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/n0mi1k/apk2url</span><br><span class="line"># 安装依赖工具</span><br><span class="line">apt-get install apktool</span><br><span class="line">apt-get install jadx</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/c66bf7935c99da01b8f2c6a1f63e20e979b2d193a53511db906363c338915a53/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a574b473335536a6d6b4e75737a6369634967676c3546586a316c5658686b5439647841766133393469634b69614e374f556d6d6b6d6a696257772f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31"><img src="https://camo.githubusercontent.com/c66bf7935c99da01b8f2c6a1f63e20e979b2d193a53511db906363c338915a53/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a574b473335536a6d6b4e75737a6369634967676c3546586a316c5658686b5439647841766133393469634b69614e374f556d6d6b6d6a696257772f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31" alt="图片"></a></p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>安装完成后，我们执行下面命令即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apk2url</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/27ae1c7aa9805c02be0486fc78b380879cc86398e7b115354e222b0d60ab407f/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a4f696174744365643152384153506a59774d3631657a4b57713538424e767063484649437436336963537476696231696237523038653469624e512f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31"><img src="https://camo.githubusercontent.com/27ae1c7aa9805c02be0486fc78b380879cc86398e7b115354e222b0d60ab407f/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a4f696174744365643152384153506a59774d3631657a4b57713538424e767063484649437436336963537476696231696237523038653469624e512f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31" alt="图片"></a>接下来，我们随便下载一个app 进行测试。</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/2f54a5cafdc067aecd386c43eac684769895853fdacf85204a08f4ae8d797b47/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a69634a6f564a345a61567469614f496963765a48644c6c306137786d44513645713957783652464f7769613067386f65625439396e36577775412f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31"><img src="https://camo.githubusercontent.com/2f54a5cafdc067aecd386c43eac684769895853fdacf85204a08f4ae8d797b47/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a69634a6f564a345a61567469614f496963765a48644c6c306137786d44513645713957783652464f7769613067386f65625439396e36577775412f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31" alt="图片"></a>为了方便，app随便重命名。这里我改为了33.apk。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apk2url &quot;33.apk&quot;</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/7659f3c105bfdbc2720e6a54aa49ec9d32a8c7acda1bd6ec9659675a8805a1a9/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a4a56396a4a6d51756577727a576a544f6578326e5650655152565573634c3443473868616f36684d467a586c7a4867503635773752772f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31"><img src="https://camo.githubusercontent.com/7659f3c105bfdbc2720e6a54aa49ec9d32a8c7acda1bd6ec9659675a8805a1a9/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a4a56396a4a6d51756577727a576a544f6578326e5650655152565573634c3443473868616f36684d467a586c7a4867503635773752772f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31" alt="图片"></a>完成之后，在endpoints目录下会有txt文件。便是app中存在的url和IP地址。</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/71661ce9a7dc16d85d5b28862fb21ac7c7310be089fbc10b90f93648370fee38/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a416c32463974304a52717843617452745a477338346551485676684e664372554f5454746174534c45645763555142485771754f42672f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31"><img src="https://camo.githubusercontent.com/71661ce9a7dc16d85d5b28862fb21ac7c7310be089fbc10b90f93648370fee38/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f5862334c33776e4169617469614668626d696275645176696163797a4a486c745950557a416c32463974304a52717843617452745a477338346551485676684e664372554f5454746174534c45645763555142485771754f42672f3634303f77785f666d743d706e672666726f6d3d6170706d73672674703d777870696326777866726f6d3d352677785f6c617a793d312677785f636f3d31" alt="图片"></a></p>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><p>在实际中，我们通过对app逆向分析，得到app访问的网站或者IP地址，然后对IP或者域名进行端口扫描，从而进一步获取相关信息。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/X-Recon-XSS%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%99%A8/">
                X-Recon-XSS漏洞扫描器
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><a target="_blank" rel="noopener" href="https://github.com/joshkar/X-Recon"><img src="https://github.com/joshkar/X-Recon/raw/main/.imgs/banner.jpg" alt="X-侦察"></a></p>
<h4 id="用于识别网页输入并进行-XSS-扫描的实用程序。"><a href="#用于识别网页输入并进行-XSS-扫描的实用程序。" class="headerlink" title="用于识别网页输入并进行 XSS 扫描的实用程序。"></a>用于识别网页输入并进行 XSS 扫描的实用程序。</h4><p>目前测试PHP开发的网站比较好用,其他自行测试!</p>
<p><a target="_blank" rel="noopener" href="http://python.org/"><img src="https://camo.githubusercontent.com/2b67215b1f14c2b78b7fbbb0f2de3d1fea1276cc68a9f0fab475ce5a329c8214/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d76332d626c7565" alt="img"> </a><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Linux"><img src="https://camo.githubusercontent.com/1ffbafdfd9ce5312d5640c000f8c4e0b559e538f22773c122e358ccd031bee8f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f506c6174666f726d2d4c696e75782d726564" alt="img"></a></p>
<h3 id="特征："><a href="#特征：" class="headerlink" title="特征："></a>特征：</h3><ul>
<li>子域名发现：<ul>
<li>检索目标网站的相关子域名并将其整合到白名单中。这些子域名可在抓取过程中使用。</li>
</ul>
</li>
<li>全站链接发现：<ul>
<li>根据提供的白名单和指定的 收集整个网站的所有链接<code>max_depth</code>。</li>
</ul>
</li>
<li>表单和输入提取：<ul>
<li>识别提取的链接中找到的所有表单和输入，生成 JSON 输出。此 JSON 输出是利用该工具的 XSS 扫描功能的基础。</li>
</ul>
</li>
<li>XSS 扫描：<ul>
<li>一旦开始侦察选项返回包含提取条目的自定义 JSON，X-Recon 工具就可以启动 XSS 漏洞测试过程并为您提供所需的结果！</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/joshkar/X-Recon"><img src="https://github.com/joshkar/X-Recon/raw/main/.imgs/demo1.jpg" alt="X-侦察"></a></p>
<p><strong>笔记：</strong></p>
<blockquote>
<p>目前，扫描功能在 SPA（单页应用程序）Web 应用程序上不可用，我们仅在使用 PHP 开发的网站上进行了测试，取得了显著的效果。未来，我们计划将这些功能整合到该工具中。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/joshkar/X-Recon"><img src="https://github.com/joshkar/X-Recon/raw/main/.imgs/demo2.jpg" alt="X-Recon XSS 扫描"></a></p>
<p><strong>笔记：</strong></p>
<blockquote>
<p>此工具会维护一个最新的文件扩展名列表，这些文件扩展名会在探索过程中跳过。默认列表包括图像、样式表和脚本 ( <code>&quot;.css&quot;,&quot;.js&quot;,&quot;.mp4&quot;,&quot;.zip&quot;,&quot;png&quot;,&quot;.svg&quot;,&quot;.jpeg&quot;,&quot;.webp&quot;,&quot;.jpg&quot;,&quot;.gif&quot;</code>) 等常见文件类型。您可以通过编辑 setting.json 文件自定义此列表，以更好地满足您的需求。</p>
</blockquote>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/joshkar/X-Recon</span><br><span class="line">$ cd X-Recon</span><br><span class="line">$ python3 -m pip install -r requirements.txt</span><br><span class="line">$ python3 xr.py</span><br></pre></td></tr></table></figure>



<h2 id="测试目标："><a href="#测试目标：" class="headerlink" title="测试目标："></a>测试目标：</h2><blockquote>
<p>您可以在“获取 URL”部分中使用此地址</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://testphp.vulnweb.com</span><br><span class="line">#不可以携带http</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/dirmap-%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F%E7%A5%9E%E5%99%A8/">
                dirmap-路径扫描神器
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="Dirmap"><a href="#Dirmap" class="headerlink" title="Dirmap"></a>Dirmap</h1><p>链接：<a target="_blank" rel="noopener" href="https://github.com/H4ckForJob/dirmap">https://github.com/H4ckForJob/dirmap</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/H4ckForJob/dirmap/blob/master/README_EN.md">English</a></p>
<p>一个高级web目录扫描工具，功能将会强于DirBuster、Dirsearch、cansina、御剑</p>
<p><a target="_blank" rel="noopener" href="https://github.com/H4ckForJob/dirmap/blob/master/doc/dirmap.png"><img src="https://github.com/H4ckForJob/dirmap/raw/master/doc/dirmap.png" alt="dirmap"></a></p>
<h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>经过大量调研，总结一个优秀的web目录扫描工具至少具备以下功能：</p>
<ul>
<li>并发引擎</li>
<li>能使用字典</li>
<li>能纯爆破</li>
<li>能爬取页面动态生成字典</li>
<li>能fuzz扫描</li>
<li>自定义请求</li>
<li>自定义响应结果处理…</li>
</ul>
<p>那么接下来看看Dirmap的<strong>特点</strong>吧</p>
<h1 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h1><ol>
<li>支持n个target*n个payload并发</li>
<li>支持递归扫描</li>
<li>支持自定义需要递归扫描的状态码</li>
<li>支持(单|多)字典扫描</li>
<li>支持自定义字符集爆破</li>
<li>支持爬虫动态字典扫描</li>
<li>支持自定义标签fuzz目标url</li>
<li>自定义请求User-Agent</li>
<li>自定义请求随机延时</li>
<li>自定义请求超时时间</li>
<li>自定义请求代理</li>
<li>自定义正则表达式匹配假性404页面</li>
<li>自定义要处理的响应状态码</li>
<li>自定义跳过大小为x的页面</li>
<li>自定义显示content-type</li>
<li>自定义显示页面大小</li>
<li>按域名去重复保存结果</li>
</ol>
<h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><h2 id="环境准备-python-3-7"><a href="#环境准备-python-3-7" class="headerlink" title="环境准备:python 3.7 +"></a>环境准备:python 3.7 +</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/H4ckForJob/dirmap.git #克隆</span><br><span class="line">cd dirmap #进入目录 </span><br><span class="line">python3 -m pip install -r requirement.txt #安装必须库</span><br></pre></td></tr></table></figure>



<h2 id="快速使用"><a href="#快速使用" class="headerlink" title="快速使用"></a>快速使用</h2><h3 id="输入目标"><a href="#输入目标" class="headerlink" title="输入目标"></a>输入目标</h3><p>单目标，默认为http</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirmap.py -i https://target.com -lcf</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirmap.py -i 192.168.1.1 -lcf</span><br></pre></td></tr></table></figure>



<p>子网（CIDR格式）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirmap.py -i 192.168.1.0/24 -lcf</span><br></pre></td></tr></table></figure>



<p>网络范围</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirmap.py -i 192.168.1.1-192.168.1.100 -lcf</span><br></pre></td></tr></table></figure>



<h3 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirmap.py -iF targets.txt -lcf</span><br></pre></td></tr></table></figure>

<p><code>targets.txt</code>中支持上述格式</p>
<h3 id="结果保存"><a href="#结果保存" class="headerlink" title="结果保存"></a>结果保存</h3><ol>
<li>结果将自动保存在项目根目录下的<code>output</code>文件夹中</li>
<li>每一个目标生成一个txt，命名格式为<code>目标域名.txt</code></li>
<li>结果自动去重复，不用担心产生大量冗余</li>
</ol>
<h2 id="高级使用"><a href="#高级使用" class="headerlink" title="高级使用"></a>高级使用</h2><p>自定义dirmap配置，开始探索dirmap高级功能</p>
<p>暂时采用加载配置文件的方式进行详细配置，<strong>不支持使用命令行参数进行详细配置</strong>！</p>
<p>编辑项目根目录下的<code>dirmap.conf</code>，进行配置</p>
<p><code>dirmap.conf</code>配置详解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">#递归扫描处理配置</span><br><span class="line">[RecursiveScan]</span><br><span class="line">#是否开启递归扫描:关闭:0;开启:1</span><br><span class="line">conf.recursive_scan = 0</span><br><span class="line">#遇到这些状态码，开启递归扫描。默认配置[301,403]</span><br><span class="line">conf.recursive_status_code = [301,403]</span><br><span class="line">#URL超过这个长度就退出扫描</span><br><span class="line">conf.recursive_scan_max_url_length = 60</span><br><span class="line">#这些后缀名不递归扫</span><br><span class="line">conf.recursive_blacklist_exts = [&quot;html&quot;,&#x27;htm&#x27;,&#x27;shtml&#x27;,&#x27;png&#x27;,&#x27;jpg&#x27;,&#x27;webp&#x27;,&#x27;bmp&#x27;,&#x27;js&#x27;,&#x27;css&#x27;,&#x27;pdf&#x27;,&#x27;ini&#x27;,&#x27;mp3&#x27;,&#x27;mp4&#x27;]</span><br><span class="line">#设置排除扫描的目录。默认配置空。其他配置：e.g:[&#x27;/test1&#x27;,&#x27;/test2&#x27;]</span><br><span class="line">#conf.exclude_subdirs = [&#x27;/test1&#x27;,&#x27;/test2&#x27;]</span><br><span class="line">conf.exclude_subdirs = &quot;&quot;</span><br><span class="line"></span><br><span class="line">#扫描模式处理配置(4个模式，1次只能选择1个)</span><br><span class="line">[ScanModeHandler]</span><br><span class="line">#字典模式:关闭:0;单字典:1;多字典:2</span><br><span class="line">conf.dict_mode = 1</span><br><span class="line">#单字典模式的路径</span><br><span class="line">conf.dict_mode_load_single_dict = &quot;dict_mode_dict.txt&quot;</span><br><span class="line">#多字典模式的路径，默认配置dictmult</span><br><span class="line">conf.dict_mode_load_mult_dict = &quot;dictmult&quot;</span><br><span class="line">#爆破模式:关闭:0;开启:1</span><br><span class="line">conf.blast_mode = 0</span><br><span class="line">#生成字典最小长度。默认配置3</span><br><span class="line">conf.blast_mode_min = 3</span><br><span class="line">#生成字典最大长度。默认配置3</span><br><span class="line">conf.blast_mode_max = 3</span><br><span class="line">#默认字符集:a-z。暂未使用。</span><br><span class="line">conf.blast_mode_az = &quot;abcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="line">#默认字符集:0-9。暂未使用。</span><br><span class="line">conf.blast_mode_num = &quot;0123456789&quot;</span><br><span class="line">#自定义字符集。默认配置&quot;abc&quot;。使用abc构造字典</span><br><span class="line">conf.blast_mode_custom_charset = &quot;abc&quot;</span><br><span class="line">#自定义继续字符集。默认配置空。</span><br><span class="line">conf.blast_mode_resume_charset = &quot;&quot;</span><br><span class="line">#爬虫模式:关闭:0;开启:1</span><br><span class="line">conf.crawl_mode = 0</span><br><span class="line">#用于生成动态敏感文件payload的后缀字典</span><br><span class="line">conf.crawl_mode_dynamic_fuzz_suffix = &quot;crawl_mode_suffix.txt&quot;</span><br><span class="line">#解析robots.txt文件。暂未实现。</span><br><span class="line">conf.crawl_mode_parse_robots = 0</span><br><span class="line">#解析html页面的xpath表达式</span><br><span class="line">conf.crawl_mode_parse_html = &quot;//*/@href | //*/@src | //form/@action&quot;</span><br><span class="line">#是否进行动态爬虫字典生成。默认配置1，开启爬虫动态字典生成。其他配置：e.g:关闭:0;开启:1</span><br><span class="line">conf.crawl_mode_dynamic_fuzz = 1</span><br><span class="line">#Fuzz模式:关闭:0;单字典:1;多字典:2</span><br><span class="line">conf.fuzz_mode = 0</span><br><span class="line">#单字典模式的路径。</span><br><span class="line">conf.fuzz_mode_load_single_dict = &quot;fuzz_mode_dir.txt&quot;</span><br><span class="line">#多字典模式的路径。默认配置:fuzzmult</span><br><span class="line">conf.fuzz_mode_load_mult_dict = &quot;fuzzmult&quot;</span><br><span class="line">#设置fuzz标签。默认配置&#123;dir&#125;。使用&#123;dir&#125;标签当成字典插入点，将http://target.com/&#123;dir&#125;.php替换成http://target.com/字典中的每一行.php。其他配置：e.g:&#123;dir&#125;;&#123;ext&#125;</span><br><span class="line">#conf.fuzz_mode_label = &quot;&#123;ext&#125;&quot;</span><br><span class="line">conf.fuzz_mode_label = &quot;&#123;dir&#125;&quot;</span><br><span class="line"></span><br><span class="line">#处理payload配置。暂未实现。</span><br><span class="line">[PayloadHandler]</span><br><span class="line"></span><br><span class="line">#处理请求配置</span><br><span class="line">[RequestHandler]</span><br><span class="line">#自定义请求头。默认配置空。其他配置：e.g:test1=test1,test2=test2</span><br><span class="line">#conf.request_headers = &quot;test1=test1,test2=test2&quot;</span><br><span class="line">conf.request_headers = &quot;&quot;</span><br><span class="line">#自定义请求User-Agent。默认配置chrome的ua。</span><br><span class="line">conf.request_header_ua = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&quot;</span><br><span class="line">#自定义请求cookie。默认配置空，不设置cookie。其他配置e.g:cookie1=cookie1; cookie2=cookie2;</span><br><span class="line">#conf.request_header_cookie = &quot;cookie1=cookie1; cookie2=cookie2&quot;</span><br><span class="line">conf.request_header_cookie = &quot;&quot;</span><br><span class="line">#自定义401认证。暂未实现。因为自定义请求头功能可满足该需求(懒XD)</span><br><span class="line">conf.request_header_401_auth = &quot;&quot;</span><br><span class="line">#自定义请求方法。默认配置get方法。其他配置：e.g:get;head</span><br><span class="line">#conf.request_method = &quot;head&quot;</span><br><span class="line">conf.request_method = &quot;get&quot;</span><br><span class="line">#自定义每个请求超时时间。默认配置3秒。</span><br><span class="line">conf.request_timeout = 3</span><br><span class="line">#随机延迟(0-x)秒发送请求。参数必须是整数。默认配置0秒，无延迟。</span><br><span class="line">conf.request_delay = 0</span><br><span class="line">#自定义单个目标，请求协程线程数。默认配置30线程</span><br><span class="line">conf.request_limit = 30</span><br><span class="line">#自定义最大重试次数。暂未实现。</span><br><span class="line">conf.request_max_retries = 1</span><br><span class="line">#设置持久连接。是否使用session()。暂未实现。</span><br><span class="line">conf.request_persistent_connect = 0</span><br><span class="line">#302重定向。默认False，不重定向。其他配置：e.g:True;False</span><br><span class="line">conf.redirection_302 = False</span><br><span class="line">#payload后添加后缀。默认空，扫描时，不添加后缀。其他配置：e.g:txt;php;asp;jsp</span><br><span class="line">#conf.file_extension = &quot;txt&quot;</span><br><span class="line">conf.file_extension = &quot;&quot;</span><br><span class="line"></span><br><span class="line">#处理响应配置</span><br><span class="line">[ResponseHandler]</span><br><span class="line">#设置要记录的响应状态。默认配置[200]，记录200状态码。其他配置：e.g:[200,403,301]</span><br><span class="line">#conf.response_status_code = [200,403,301]</span><br><span class="line">conf.response_status_code = [200]</span><br><span class="line">#是否记录content-type响应头。默认配置1记录</span><br><span class="line">#conf.response_header_content_type = 0</span><br><span class="line">conf.response_header_content_type = 1</span><br><span class="line">#是否记录页面大小。默认配置1记录</span><br><span class="line">#conf.response_size = 0</span><br><span class="line">conf.response_size = 1</span><br><span class="line">#是否自动检测404页面。默认配置True，开启自动检测404.其他配置参考e.g:True;False</span><br><span class="line">#conf.auto_check_404_page = False</span><br><span class="line">conf.auto_check_404_page = True</span><br><span class="line">#自定义匹配503页面正则。暂未实现。感觉用不着，可能要废弃。</span><br><span class="line">#conf.custom_503_page = &quot;page 503&quot;</span><br><span class="line">conf.custom_503_page = &quot;&quot;</span><br><span class="line">#自定义正则表达式，匹配页面内容</span><br><span class="line">#conf.custom_response_page = &quot;([0-9])&#123;3&#125;([a-z])&#123;3&#125;test&quot;</span><br><span class="line">conf.custom_response_page = &quot;&quot;</span><br><span class="line">#跳过显示页面大小为x的页面，若不设置，请配置成&quot;None&quot;，默认配置“None”。其他大小配置参考e.g:None;0b;1k;1m</span><br><span class="line">#conf.skip_size = &quot;0b&quot;</span><br><span class="line">conf.skip_size = &quot;None&quot;</span><br><span class="line"></span><br><span class="line">#代理选项</span><br><span class="line">[ProxyHandler]</span><br><span class="line">#代理配置。默认设置“None”，不开启代理。其他配置e.g:&#123;&quot;http&quot;:&quot;http://127.0.0.1:8080&quot;,&quot;https&quot;:&quot;https://127.0.0.1:8080&quot;&#125;</span><br><span class="line">#conf.proxy_server = &#123;&quot;http&quot;:&quot;http://127.0.0.1:8080&quot;,&quot;https&quot;:&quot;https://127.0.0.1:8080&quot;&#125;</span><br><span class="line">conf.proxy_server = None</span><br><span class="line"></span><br><span class="line">#Debug选项</span><br><span class="line">[DebugMode]</span><br><span class="line">#打印payloads并退出</span><br><span class="line">conf.debug = 0</span><br><span class="line"></span><br><span class="line">#update选项</span><br><span class="line">[CheckUpdate]</span><br><span class="line">#github获取更新。暂未实现。</span><br><span class="line">conf.update = 0</span><br></pre></td></tr></table></figure>

<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><p>命令行参数解析全局初始化</p>
<p>engine始化</p>
<p>设置线程数</p>
<p>target初始化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">自动解析处理输入格式( -i,inputTarget)</span><br><span class="line"></span><br><span class="line">-  IP</span><br><span class="line">-  Domain</span><br><span class="line">-  URL</span><br><span class="line">-  IP/MASK</span><br><span class="line">-  IP Start-End</span><br></pre></td></tr></table></figure>



<ul>
<li>文件读入(-iF,inputLocalFile)</li>
</ul>
<p>bruter初始化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">加载配置方式()</span><br><span class="line"></span><br><span class="line">-  读取命令行参数值</span><br><span class="line">-  读取配置文件(-lcf,loadConfigFile)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">递归模式选项(RecursiveScan)</span><br><span class="line"></span><br><span class="line">-  递归扫描(-rs,recursive_scan)</span><br><span class="line">-  需要递归的状态码(-rd,recursive_status_code)</span><br><span class="line">-  排除某些目录(-es,exclude_subdirs)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">扫描模式选项(ScanModeHandler)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  字典模式(-dm,dict_mode)</span><br><span class="line"></span><br><span class="line">  -  加载单个字典(-dmlsd,dict_mode_load_single_dict)</span><br><span class="line">  -  加载多个字典(-dmlmd,dict_mode_load_mult_dict)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  爆破模式(-bm,blast_mode)</span><br><span class="line"></span><br><span class="line">  -  </span><br><span class="line"></span><br><span class="line">    爆破目录长度范围(必选)</span><br><span class="line"></span><br><span class="line">    -  最小长度(-bmmin,blast_mode_min)</span><br><span class="line">    -  最大长度(-bmmax,blast_mode_max)</span><br><span class="line"></span><br><span class="line">  -  </span><br><span class="line"></span><br><span class="line">    基于默认字符集</span><br><span class="line"></span><br><span class="line">    -  基于a-z</span><br><span class="line">    -  基于0-9</span><br><span class="line"></span><br><span class="line">  -  基于自定义字符集(-bmcc,blast_mode_custom_charset)</span><br><span class="line"></span><br><span class="line">  -  断点续生成payload(-bmrc,blast_mode_resume_charset)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  爬虫模式(-cm,crawl_mode)</span><br><span class="line"></span><br><span class="line">  -  自定义解析标签(-cmph,crawl_mode_parse_html)(a:href,img:src,form:action,script:src,iframe:src,div:src,frame:src,embed:src)</span><br><span class="line">  -  解析robots.txt(-cmpr,crawl_mode_parse_robots)</span><br><span class="line">  -  爬虫类动态fuzz扫描(-cmdf,crawl_mode_dynamic_fuzz)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  fuzz模式(-fm,fuzz_mode)</span><br><span class="line"></span><br><span class="line">  -  fuzz单个字典(-fmlsd,fuzz_mode_load_single_dict)</span><br><span class="line">  -  fuzz多个字典(-fmlmd,fuzz_mode_load_mult_dict)</span><br><span class="line">  -  fuzz标签(-fml,fuzz_mode_label)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">请求优化选项(RequestHandler)</span><br><span class="line"></span><br><span class="line">-  自定义请求超时(-rt,request_timeout)</span><br><span class="line"></span><br><span class="line">-  自定义请求延时(-rd,request_delay)</span><br><span class="line"></span><br><span class="line">-  限制单个目标主机协程数扫描(-rl,request_limit)</span><br><span class="line"></span><br><span class="line">-  限制重试次数(-rmr,request_max_retries)</span><br><span class="line"></span><br><span class="line">-  http持久连接(-rpc,request_persistent_connect)</span><br><span class="line"></span><br><span class="line">-  自定义请求方法(-rm,request_method)(get、head)</span><br><span class="line"></span><br><span class="line">-  302状态处理(-r3,redirection_302)(是否重定向)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  自定义header</span><br><span class="line"></span><br><span class="line">  -  自定义其他header(-rh,request_headers)(解决需要401认证)</span><br><span class="line">  -  自定义ua(-rhua,request_header_ua)</span><br><span class="line">  -  自定义cookie(-rhc,request_header_cookie)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">字典处理选项(PayloadHandler)</span><br><span class="line"></span><br><span class="line">-  字典处理(payload修改-去斜杠)</span><br><span class="line">-  字典处理(payload修改-首字符加斜杠)</span><br><span class="line">-  字典处理(payload修改-单词首字母大写)</span><br><span class="line">-  字典处理(payload修改-去扩展)</span><br><span class="line">-  字典处理(payload修改-去除非字母数字)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">响应结果处理模块(ResponseHandler)</span><br><span class="line"></span><br><span class="line">-  跳过大小为x字节的文件(-ss,skip_size)</span><br><span class="line"></span><br><span class="line">-  自动检测404页面(-ac4p,auto_check_404_page)</span><br><span class="line"></span><br><span class="line">-  自定义503页面(-c5p,custom_503_page)</span><br><span class="line"></span><br><span class="line">-  </span><br><span class="line"></span><br><span class="line">  自定义正则匹配响应内容并进行某种操作</span><br><span class="line"></span><br><span class="line">  -  自定义正则匹配响应(-crp,custom_response_page)</span><br><span class="line">  -  某种操作(暂时未定义)</span><br><span class="line"></span><br><span class="line">-  输出结果为自定义状态码(-rsc,response_status_code)</span><br><span class="line"></span><br><span class="line">-  输出payload为完整路径(默认输出完成url)</span><br><span class="line"></span><br><span class="line">-  输出结果展示content-type</span><br><span class="line"></span><br><span class="line">-  自动去重复保存结果</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">状态处理模块(StatusHandler)</span><br><span class="line"></span><br><span class="line">-  状态显示(等待开始、进行中、暂停中、异常、完成)</span><br><span class="line">-  进度显示</span><br><span class="line">-  状态控制(开始、暂停、继续、停止)</span><br><span class="line">-  续扫模块(暂未配置)</span><br><span class="line">-  断点续扫</span><br><span class="line">-  选行续扫</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">日志记录模块(ScanLogHandler)</span><br><span class="line"></span><br><span class="line">-  扫描日志</span><br><span class="line">-  错误日志</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">代理模块(ProxyHandler)</span><br><span class="line"></span><br><span class="line">-  单个代理(-ps,proxy_server)</span><br><span class="line">-  代理池</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">调试模式选项(DebugMode)</span><br><span class="line"></span><br><span class="line">-  debug(--debug)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">检查更新选项(CheckUpdate)</span><br><span class="line"></span><br><span class="line">-  update(--update)</span><br></pre></td></tr></table></figure>

<h1 id="默认字典文件"><a href="#默认字典文件" class="headerlink" title="默认字典文件"></a>默认字典文件</h1><p>字典文件存放在项目根目录中的<code>data</code>文件夹中</p>
<ol>
<li>dict_mode_dict.txt “字典模式”字典，使用dirsearch默认字典</li>
<li>crawl_mode_suffix.txt “爬虫模式”字典，使用FileSensor默认字典</li>
<li>fuzz_mode_dir.txt “fuzz模式”字典，使用DirBuster默认字典</li>
<li>fuzz_mode_ext.txt “fuzz模式”字典，使用常见后缀制作的字典</li>
<li>dictmult 该目录为“字典模式”默认多字典文件夹，包含：BAK.min.txt(备份文件小字典)，BAK.txt(备份文件大字典)，LEAKS.txt(信息泄露文件字典)</li>
<li>fuzzmult 该目录为“fuzz模式”默认多字典文件夹，包含：fuzz_mode_dir.txt(默认目录字典)，fuzz_mode_ext.txt(默认后缀字典)</li>
</ol>
<h1 id="已知缺陷"><a href="#已知缺陷" class="headerlink" title="已知缺陷"></a>已知缺陷</h1><ol>
<li>“爬虫模式”只爬取了目标的当前页面，用于生成动态字典。项目将来会将“爬虫模块”与“生成动态字典功能”分离。</li>
<li>关于bruter.py第517行<code>bar.log.start()</code>出错。解决方案：请安装progressbar2。卸载progressbar。防止导入同名模块。感谢某位表哥提醒。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">执行命令：</span><br><span class="line">python3 -m pip uninstall progressbar</span><br><span class="line">python3 -m pip install progressbar2</span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/amass-%E4%B8%80%E6%AC%BE%E5%A5%BD%E7%94%A8%E7%9A%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/">
                amass-一款好用的信息收集工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>OWASP Amass 项目使用开源信息收集和主动侦察技术来执行攻击面的网络映射和外部资产发现。</p>
<h3 id="github链接"><a href="#github链接" class="headerlink" title="github链接:"></a>github链接:</h3><p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass?tab=readme-ov-file">https://github.com/owasp-amass/amass?tab=readme-ov-file</a></p>
<h3 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接:"></a>下载链接:</h3><p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/releases/tag/v4.2.0">https://github.com/owasp-amass/amass/releases/tag/v4.2.0</a></p>
<p><strong>使用的信息收集技术：</strong></p>
<table>
<thead>
<tr>
<th>技术</th>
<th>数据源</th>
</tr>
</thead>
<tbody><tr>
<td>蜜蜂</td>
<td>360PassiveDNS、Ahrefs、AnubisDB、BeVigil、BinaryEdge、BufferOver、BuiltWith、C99、Chaos、CIRCL、DNSDB、DNSRepo、Deepinfo、Detectify、FOFA、FullHunt、GitHub、GitLab、GrepApp、Greynoise、HackerTarget、Hunter、IntelX、LeakIX、Maltiverse、 Mnemonic、Netlas、Pastebin、PassiveTotal、PentestTools、Pulsedive、Quake、SOCRadar、Searchcode、Shodan、Spamhaus、Sublist3rAPI、SubdomainCenter、ThreatBook、ThreatMiner、URLScan、VirusTotal、Yandex、ZETAlytics、ZoomEye</td>
</tr>
<tr>
<td>证书</td>
<td>主动拉取（可选）、Censys、CertCentral、CertSpotter、Crtsh、Digitorus、FacebookCT</td>
</tr>
<tr>
<td>域名系统</td>
<td>暴力破解、反向 DNS 扫描、NSEC 区域行走、区域传输、FQDN 更改&#x2F;排列、FQDN 基于相似性的猜测</td>
</tr>
<tr>
<td>路由</td>
<td>ASNLookup、BGPTools、BGPView、BigDataCloud、IPdata、IPinfo、RADb、Robtex、ShadowServer、TeamCymru</td>
</tr>
<tr>
<td>刮痧</td>
<td>滥用IPDB、Ask、百度、Bing、CSP 标头、DNSDumpster、DNSHistory、DNSSpy、DuckDuckGo、Gists、Google、HackerOne、HyperStat、PKey、RapidDNS、Riddler、Searx、SiteDossier、雅虎</td>
</tr>
<tr>
<td>网络档案</td>
<td>Arquivo、CommonCrawl、HAW、PublicWWW、UKWebArchive、Wayback</td>
</tr>
<tr>
<td>谁是</td>
<td>AlienVault、AskDNS、DNSlytics、ONYPHE、SecurityTrails、SpyOnWeb、WhoisXMLAPI</td>
</tr>
</tbody></table>
<hr>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h2 id=""><a href="#" class="headerlink" title="  "></a><a target="_blank" rel="noopener" href="https://golang.org/dl/"><img src="https://camo.githubusercontent.com/4004c7b3350134d3d4f559db3c9820b398cbf16f069fad8a55a2f088e111e0fb/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f676f2d6d6f642f676f2d76657273696f6e2f6f776173702d616d6173732f616d617373" alt="去版本"></a> <a target="_blank" rel="noopener" href="https://hub.docker.com/r/caffix/amass"><img src="https://camo.githubusercontent.com/15ae103c2a653f12d2862dd74b5b9f78df79baa14dc16a3bbc04460d61705db8/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f6361666669782f616d6173732e737667" alt="Docker 镜像"></a> <a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/releases/latest"><img src="https://camo.githubusercontent.com/6c4e2b61a93f20d608d6e54b59081cbc8bdb5471b4aa050c4b70459c030be6c6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f646f776e6c6f6164732f6f776173702d616d6173732f616d6173732f6c61746573742f746f74616c2e737667" alt="GitHub 下载"></a></h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/install.md">您可以在安装指南</a>中找到一些其他安装变体。</p>
</blockquote>
<h3 id="预建包"><a href="#预建包" class="headerlink" title="预建包"></a>预建包</h3><ol>
<li>只需解压<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/releases/latest">包即可</a></li>
<li>将预编译的二进制文件放入您的路径中</li>
<li>开始使用 OWASP Amass！</li>
</ol>
<h4 id="自制"><a href="#自制" class="headerlink" title="自制"></a>自制</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap owasp-amass/amass</span><br><span class="line">brew install amass</span><br></pre></td></tr></table></figure>



<h3 id="Docker容器"><a href="#Docker容器" class="headerlink" title="Docker容器"></a>Docker容器</h3><ol>
<li>安装<a target="_blank" rel="noopener" href="https://www.docker.com/">Docker</a></li>
<li>通过运行拉取 Docker 镜像<code>docker pull caffix/amass</code></li>
<li>跑步<code>docker run -v OUTPUT_DIR_PATH:/.config/amass/ caffix/amass enum -d example.com</code></li>
</ol>
<p>卷参数允许 Amass 图形数据库在执行和输出文件之间保留以在主机系统上访问。Volume 选项的第一个字段（冒号左侧）是 Docker 外部的 amass 输出目录，而第二个字段是 Docker 内部的路径，amass 将在其中写入输出文件。</p>
<h3 id="从源头"><a href="#从源头" class="headerlink" title="从源头"></a>从源头</h3><ol>
<li>安装<a target="_blank" rel="noopener" href="https://golang.org/doc/install">Go</a>并设置您的 Go 工作区</li>
<li>通过运行下载 OWASP Amass<code>go install -v github.com/owasp-amass/amass/v4/...@master</code></li>
<li>此时，二进制文件应该位于<code>$GOPATH/bin</code></li>
</ol>
<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/owasp-amass/amass/v4"><img src="https://camo.githubusercontent.com/343f881605faf63ad5d6889130b47fa935cc77d5b7841927dbb763466a1bff03/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f6f776173702d616d6173732f616d6173732f76343f75746d5f736f757263653d676f646f63" alt="戈多克"></a></h2><p>使用<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/install.md">安装指南</a>开始。</p>
<p>请参阅<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/user_guide.md">用户指南</a>以获取更多信息。</p>
<p>有关示例用法，请参阅<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/tutorial.md">教程。</a></p>
<p>请参阅<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/scripting.md">Amass 脚本引擎手册，</a>以更好地控制枚举过程。</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>无论您是渗透测试员、审计员、安全研究人员还是 CISO&#x2F;IT 经理，您都可能有几个合理的理由来绘制组织的外部攻击面。此过程也称为侦察或信息收集。</p>
<p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-amass/">OWASP Amass 项目</a> (Amass) 可以在很大程度上根据您的要求提供帮助。在这篇博文中，我们的目标是演示如何使用 Amass 来发现组织的大部分外部暴露资产。</p>
<p>重点将是执行连续的子域发现练习。我们已将这篇博文分为不同的部分，以便您更轻松地掌握 Amass 的各种功能。应该注意的是，可能存在未映射到域的资产，您需要采用其他技术来发现它们，例如在组织拥有的 IP 范围上运行网络扫描。虽然我们不会完全演示如何使用 Amass 提供的所有功能，但我们希望这篇博客能够涵盖足够的内容，让您能够快速掌握该收集工具。</p>
<h2 id="为什么选择-OWASP-Amass？"><a href="#为什么选择-OWASP-Amass？" class="headerlink" title="为什么选择 OWASP Amass？"></a>为什么选择 OWASP Amass？</h2><p>有大量开源工具和软件可用于枚举子域、自治系统编号 (ASN) 以及组织拥有的其他资产。尽管这些工具中的大多数在利用特定方法方面都非常出色，但它们并不总是得到积极维护和更新以跟上最新的技术和方法。说实话，大多数可用的工具都不完整，仅仅依赖这些工具可能会产生错误的安全感或导致丢失易受攻击的资产。现实情况是，子域名现在可以在任何地方公开，例如社交媒体、Pastebin、源代码存储库、HTTP 标头等。</p>
<p>Amass 得到 OWASP 的支持，这应该会为结果带来威望和信心。它得到积极维护，并且可能会得到长期支持，这意味着未来的任何错误都将得到解决。此外，Amass 的采用率很高，这可能意味着更好的数据一致性以及与其他工具的集成。因此，它可以构成一个更好、更值得信赖的工具，用于证明概念和参与。这可以更轻松地说服您的客户或经理使用它来定期绘制组织的攻击面。</p>
<p>还有许多更多的技术原因，我们将在下面解释并稍后更详细地演示：</p>
<ul>
<li>带有 3 个子命令，换句话说就是函数：<ul>
<li>amass intel – 发现枚举的目标命名空间</li>
<li>amass enum – 执行枚举和网络映射</li>
<li>amass db – 操作 Amass 图形数据库</li>
</ul>
</li>
<li>在某些情况下，Amass 的子命令可以结合使用，这可以让您创建执行多个 Amass 操作的脚本。</li>
<li>在撰写本文时，作为其子域发现和信息收集技术的一部分，支持超过 80 个来源，例如 API 和网站。可以使用以下命令列出这些：<ul>
<li>大量枚举列表</li>
<li><code>AlienVault,ArchiveIt,Arquivo,Ask,Baidu,BinaryEdge,Bing,BufferOver,Censys,CertSpotter,CIRCL,CommonCrawl,Crtsh,[...],VirusTotal,Wayback,WhoisXML,Yahoo</code>（完整列表<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass">在这里</a>）</li>
</ul>
</li>
<li>它采用各种信息收集技术进行 DNS 枚举<ul>
<li>使用域名单词列表和更改单词列表对子域进行暴力破解</li>
<li>通过读取 SSL&#x2F;TLS 证书、执行 DNS 区域传输或检查证书透明度日志来识别子域</li>
<li>已识别域的递归子域发现</li>
<li>用于暴力破解子域的 Hashcat 式掩码（如果您有有关命名约定等的内部信息，这可能非常有用）</li>
</ul>
</li>
<li>它可以使用配置文件进行配置，这使得维护、使用或与脚本集成变得容易</li>
</ul>
<p>最后，我们不会在这篇博文中详细介绍安装 Amass，但如果您有兴趣，可以通过多种方式进行安装。如果您有正确配置的 Golang 环境 (Go &gt;&#x3D; 1.20)，则可以从源代码进行编译，使用 Docker 运行它，或者如果您的发行版有可用的包，则可以将其安装为包。详细的安装说明可<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/install.md">在此处</a>获取。</p>
<h2 id="积聚英特尔"><a href="#积聚英特尔" class="headerlink" title="积聚英特尔"></a>积聚英特尔</h2><p>Amass intel 子命令或模块（如果您需要）可以帮助收集有关组织的开源情报，并允许您找到与该组织相关的更多根域名。要查看此子命令的可用选项，只需在终端中键入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ amass intel</span><br><span class="line">[...]</span><br><span class="line">Usage: amass intel [options] [-whois -d DOMAIN] [-addr ADDR -asn ASN -cidr CIDR]</span><br><span class="line">  -active</span><br><span class="line">        Attempt certificate name grabs</span><br><span class="line">  -addr value</span><br><span class="line">        IPs and ranges (192.168.1.1-254) separated by commas</span><br><span class="line">  -asn value</span><br><span class="line">        ASNs separated by commas (can be used multiple times)</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>



<p>此时可能值得注意的是，Amass 的另一个巨大好处是所有子命令都试图保持参数的一致性。</p>
<p>默认情况下，该子命令将使用许多信息收集技术和数据源（例如 WHOIS），以便获取组织拥有的情报和父域，除非在 Amass 的配置文件中明确禁用这些技术和数据源。<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/config/blob/master/examples/config.yaml">GitHub 配置存储库上</a>提供了示例 Amass 配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ amass intel -d owasp.org -whois</span><br><span class="line">appseceu.com</span><br><span class="line">owasp.com</span><br><span class="line">appsecasiapac.com</span><br><span class="line">appsecnorthamerica.com</span><br><span class="line">appsecus.com</span><br><span class="line">[...]</span><br><span class="line">owasp.org</span><br><span class="line">appsecapac.com</span><br><span class="line">appsecla.org</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>



<p>您还可以通过手动浏览数据源来确认上面的一些结果。在下面的屏幕截图中，我们对“OWASP Foundation”执行了反向 WHOIS 搜索，并发现了类似的域：</p>
<p><a target="_blank" rel="noopener" href="https://viewdns.info/reversewhois/?q=OWASP+Foundation">https://viewdns.info/reversewhois/?q=OWASP+Foundation</a> <a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/images/tutorial/viewdnsinfo_example.png?raw=true"><img src="https://github.com/owasp-amass/amass/raw/master/images/tutorial/viewdnsinfo_example.png?raw=true" alt="OWASP Amass 信息收集技术"></a></p>
<p>当使用 amass intel 执行搜索时，您始终可以使用更多配置选项来运行它，例如“-active”参数，它将尝试区域传输并主动扫描以获取 SSL&#x2F;TLS 证书以提取信息。与任何参与一样，确保您有权对目标执行主动搜索。</p>
<p>此时值得注意的是，某些配置标志将无法与其他配置标志一起使用，在这种情况下，Amass 将简单地忽略它们。</p>
<p>Amass 的调查结果并不总是准确的，这可能有多种原因，例如，Amass 使用的数据源可能不一致或不是最新的。Amass 尝试使用 DNS 查询进一步验证信息，未来将实施更多验证技术。尽管 Amass 做得很好，但用户仍然应该对看似与目标无关的结果进行进一步的验证检查。这可以使用多种方法来执行，例如：</p>
<ul>
<li>使用实用程序来解析域（例如 dig、nslookup）</li>
<li>执行 WHOIS 查询以确认组织详细信息</li>
<li>在搜索引擎上的搜索结果，例如父域</li>
</ul>
<p>您还可以使用 Amass 查找组织名称，它可以返回分配给目标的 ASN ID，示例如下所示(已经测试中文)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ amass intel -org &#x27;Example Ltd&#x27;</span><br><span class="line">111111, MAIN_PRODUCT -- Example Ltd</span><br><span class="line">222222, SECONDARY_PRODUCT - Example Ltd</span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">Please note that the above data is fictitious for demonstration purposes. Retrieved ASNs could then be fed back into Amass. The below command attempts to retrieve registered domains found within the specified ASN and return them along with the IP address they resolve to (127.0.0.1 in this case for demonstration purposes):</span><br><span class="line"></span><br><span class="line">$ amass intel -active -asn 222222 -ip</span><br><span class="line">some-example-ltd-domain.com 127.0.0.1</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>



<h2 id="大量枚举"><a href="#大量枚举" class="headerlink" title="大量枚举"></a>大量枚举</h2><p>让我们转向 Amass 枚举，这是 Amass 大部分强大功能所在的地方。Amass 枚举允许您执行 DNS 枚举和目标映射，以确定组织暴露的攻击面。枚举结果存储在图形数据库中，该数据库将位于 Amass 的默认输出文件夹或带有“-dir”标志的指定输出目录中。其他 Amass 子命令也是如此。</p>
<h3 id="在被动或主动配置下运行-Amass"><a href="#在被动或主动配置下运行-Amass" class="headerlink" title="在被动或主动配置下运行 Amass"></a>在被动或主动配置下运行 Amass</h3><p>Amass enum 可以在被动或主动配置模式的上下文中执行。被动模式要快得多，但 Amass 不会验证 DNS 信息，例如通过解析子域。您可以使用“-passive”标志被动运行它，并且您将无法启用许多技术或配置，例如 DNS 暴力破解和名称更改。选择被动模式而不是主动模式有多种原因，例如：</p>
<ul>
<li>您需要了解所有可能已使用过且将来可能会重复使用的子域，这可能是因为您需要不断监控目标攻击面的变化，或者因为您正在进行网络钓鱼活动并寻找子域。</li>
<li>您的周边安全测试流程会在稍后阶段验证 DNS 信息，并需要快速收集结果。</li>
<li>由于安全参与的限制或要求，您只能执行被动信息收集。</li>
</ul>
<p>在下面的示例中，我们在 owasp.org 上被动搜索子域(以测试)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ amass enum -passive -d owasp.org</span><br><span class="line">[...]</span><br><span class="line">update-wiki.owasp.org</span><br><span class="line">[...]</span><br><span class="line">my.owasp.org</span><br><span class="line">www.lists.owasp.org</span><br><span class="line">www.ocms.owasp.org</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>



<p>值得一提的是，尽管 Amass intel 将帮助收集组织拥有的 IP 范围、ASN 和注册域，但 Amass enum 将识别所有子域。在我的测试机器上，这个子域枚举在 2 分钟内完成。这是一个稍微修改过的屏幕截图，显示了此枚举的结果：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/images/tutorial/amass_passive_run_example.png?raw=true"><img src="https://github.com/owasp-amass/amass/raw/master/images/tutorial/amass_passive_run_example.png?raw=true" alt="用于子域发现的 OWASP Amass 枚举教程"></a></p>
<p>在主动配置模式下使用 Amass 意味着您将获得更准确的结果，并且可以发现更多资产，因为所有 DNS 枚举技术都将启用。应该注意的是，“主动配置模式”并不是严格指“-active”标志，该标志启用 SSL&#x2F;TLS 服务的区域传输和端口扫描，并抓取其证书以从证书字段中提取任何子域（例如 Common姓名）。</p>
<p>下面的命令（稍后详细解释）可以被认为是总体活跃的，因为它以多种方式（单词列表、掩码等）执行子域暴力破解，并且启用了“-active”标志。所有结果都将由 Amass 使用默认或指定的解析器进行验证：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ amass enum -active -d owasp.org -brute -w /root/dns_lists/deepmagic.com-top50kprefixes.txt -ip -dir amass4owasp -config /root/amass/config.yaml -o amass_results_owasp.txt</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/images/tutorial/amass_active_run_example.png?raw=true"><img src="https://github.com/owasp-amass/amass/raw/master/images/tutorial/amass_active_run_example.png?raw=true" alt="使用 OWASP Amass 执行子域发现练习"></a></p>
<p>我们上面使用的命令指定 Amass 图形数据库以及日志文件将存储在“.&#x2F;amass4owasp”。我们还要求 Amass 使用“-ip”标志显示其解析名称的 IP 地址。我们使用“-w”参数为 Amass 提供了 <a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/tree/master/Discovery/DNS">deepmagic</a> DNS 单词列表，并使用“-config”指定了 config.yaml 文件的位置，并使用“-o”指定了输出。</p>
<p>虽然上面的命令希望很简单，但我们想提供一些进一步的说明：</p>
<ul>
<li>在这种情况下，Amass 将在 config.yaml 文件中检查 DNS 解析器，或使用 Amass 代码中嵌入的默认解析器。您还可以使用“-r”和“-rf”标志或在 config.yaml 文件中指定自己的 DNS 解析器。使用“-r”标志，您可以在命令行指定 DNS 解析器的 IP 地址，而使用“-rf”，您可以在每行指定包含这些地址的文件。</li>
<li>我们可以在 config.yaml 文件中指定所有这些配置，并使用“-config”将其提供给 Amass。此时值得说明的是，命令行参数将优先于 config.yaml 文件中指定的内容。因此，如果您在 config.yaml 文件中禁用暴力破解，但在命令行上提供“-brute”参数，则将使用暴力破解技术。</li>
<li>除非使用“-norecursive”明确禁用，否则上述命令将对默认识别的子域执行递归 DNS 枚举。</li>
</ul>
<p>此时，您还应该记住，如果您在短时间内从同一 IP 执行多个 Amass 操作，则该 IP 可能会被永久阻止 Amass 抓取的某些来源，例如 Google&#x2F;Yahoo 搜索引擎。</p>
<p>为了以更有趣的方式结束本节，我们假设由于某种原因 OWASP 组织倾向于创建带有“zzz”前缀的子域，例如 zzz-dev.owasp.org。您可以利用 Amass 的 hashcat 式单词列表掩码功能，使用以下命令来暴力破解“zzz-[az][az][az].owasp.org”的所有组合：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ amass enum -d owasp.org -norecursive -wm &quot;zzz-?l?l?l&quot; -dir amass4owasp</span><br></pre></td></tr></table></figure>



<p>请注意，在上面的配置中，我们已明确禁用递归 DNS 枚举，因为我们希望仅使用掩码获得更快的结果。</p>
<p>最后，您可以随时检查输出目录中的 Amass 日志文件，以确保您的配置按预期工作：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/images/tutorial/amass_logs_example2.png?raw=true"><img src="https://github.com/owasp-amass/amass/raw/master/images/tutorial/amass_logs_example2.png?raw=true" alt="OWASP Amass 使用 hashcat 掩码进行高级子域发现"></a></p>
<h2 id="海量数据库"><a href="#海量数据库" class="headerlink" title="海量数据库"></a>海量数据库</h2><p>您可以使用此子命令与 Amass 图形数据库（默认数据库或使用“-dir”标志指定的数据库）进行交互。</p>
<p>例如，以下命令将列出您在 owasp.org 上执行的枚举过程中发现并存储在“amass4owasp”图形数据库中的所有名称：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ amass db -dir amass4owasp -names -d owasp.org</span><br></pre></td></tr></table></figure>



<p>接下来，使用类似的命令，您可以检索 owasp.org 的完整输出并将其存储在“amass4owasp”图形数据库中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ amass db -dir amass4owasp -d owasp.org -show -ip</span><br></pre></td></tr></table></figure>



<p>您可能希望出于统计或历史目的维护相同的 Amass 输出目录，通过该目录执行所有子域枚举练习，因为 Amass 跟踪只能针对相同的图形数据库和输出目录使用。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>最后，OWASP Amass 是一个越来越受欢迎的项目。如果您有信息收集和子域发现需求，我们强烈建议您将 Amass 纳入您的工作流程&#x2F;流程中，并且随着每个版本都会添加越来越多的功能和改进，请继续关注。最后，您可以随时参考 Amass 的官方<a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass/blob/master/doc/user_guide.md">用户指南</a>。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/OpenArk-%E8%93%9D%E9%98%9F%E5%BA%94%E6%80%A5%E5%B7%A5%E5%85%B7%E7%AE%B1/">
                OpenArk-蓝队应急工具箱
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="OpenArk"><a href="#OpenArk" class="headerlink" title="OpenArk "></a>OpenArk <a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/resources/logo.png"><img src="https://github.com/BlackINT3/OpenArk/raw/master/doc/resources/logo.png" alt="image"></a></h1><p>github链接:<a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk?tab=readme-ov-file">https://github.com/BlackINT3/OpenArk?tab=readme-ov-file</a></p>
<p>下载链接:<a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/releases/tag/v1.3.6">https://github.com/BlackINT3/OpenArk/releases/tag/v1.3.6</a></p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/025105f6a4b01fe290dc9ce59b43b85160aa76ce4edac55abe91eed41d4ff319/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4c47504c2d677265656e2e737667"><img src="https://camo.githubusercontent.com/025105f6a4b01fe290dc9ce59b43b85160aa76ce4edac55abe91eed41d4ff319/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4c47504c2d677265656e2e737667" alt="License"></a></p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/README.md">英文说明</a></li>
</ul>
<p>  OpenArk是一款Windows平台上的开源Ark工具. Ark是Anti-Rootkit（对抗恶意程序）的简写, OpenArk目标成为逆向工程师、编程人员的工具，同时也能为那些希望清理恶意软件的用户服务。以后也将会支持更多功能和命令。 <a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/resources/snapshot-zh-v108.png"><img src="https://github.com/BlackINT3/OpenArk/raw/master/doc/resources/snapshot-zh-v108.png" alt="image"></a> <a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/resources/snapshot-zh-01.png"><img src="https://github.com/BlackINT3/OpenArk/raw/master/doc/resources/snapshot-zh-01.png" alt="image"></a> <a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/resources/snapshot-zh-02.png"><img src="https://github.com/BlackINT3/OpenArk/raw/master/doc/resources/snapshot-zh-02.png" alt="image"></a></p>
<h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul>
<li>进程 - 查看进程、线程、模块、句柄、内存、窗口、Token、内存扫描、PPL等信息，还有模块卸载、进程注入等功能。</li>
<li>内核 - 系统内核工具，例如：内存管理、驱动、热键、回调、过滤驱动、存储、IDT&#x2F;SDT&#x2F;NDIS&#x2F;WFP等功能。</li>
<li>编程助手 - 程序员的工具箱。</li>
<li>扫描器 - PE&#x2F;ELF文件解析器，以后会变成病毒分析助手。</li>
<li>捆绑器 - 目录和多个程序可以捆绑成一个exe程序，同时支持脚本。</li>
<li>工具库 - 精心挑选了许多有用的小工具，这些和OpenArk既有功能互补，高效率，我们一直在思考。</li>
<li>控制台 - 这里有很多有用的命令。</li>
<li>语言 - 目前支持中文和英文，以后会支持更多。</li>
<li>更多强大的功能正在开发中。。。</li>
</ul>
<h3 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h3><ul>
<li>程序：独立的exe，无DLL依赖，支持32位、64位。</li>
<li>支持系统：Windows XP … Win7 … Win10 … Win11 …</li>
</ul>
<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/build-openark.md">如何编译OpenArk</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/BlackINT3/none">UNONE &amp; KNONE</a> - 应用层和内核层的基础库</li>
</ul>
<h3 id="参与-捐赠"><a href="#参与-捐赠" class="headerlink" title="参与&#x2F;捐赠"></a>参与&#x2F;捐赠</h3><ul>
<li>欢迎提交Issue和PR.</li>
<li>如果你喜欢OpenArk，可以在软件上点击捐赠，支持我们的开发工作。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/blob/master/doc/code-style-guide.md">OpenArk 代码风格</a></li>
</ul>
<h3 id="技术交流"><a href="#技术交流" class="headerlink" title="技术交流"></a>技术交流</h3><ul>
<li>Discord<ul>
<li><a target="_blank" rel="noopener" href="https://discord.com/invite/w9A8q9naDY">https://discord.com/invite/w9A8q9naDY</a></li>
</ul>
</li>
<li>QQ群:<ul>
<li>4群: 960562534</li>
<li>3群: 706663529(已满)</li>
<li>2群: 535752025(已满)</li>
<li>1群: 836208099(已满)</li>
</ul>
</li>
</ul>
<h3 id="官方链接"><a href="#官方链接" class="headerlink" title="官方链接"></a>官方链接</h3><ul>
<li>官方网站: <a target="_blank" rel="noopener" href="https://openark.blackint3.com/">https://openark.blackint3.com/</a></li>
<li>项目地址: <a target="_blank" rel="noopener" href="https://github.com/BlackINT3/OpenArk/">https://github.com/BlackINT3/OpenArk/</a></li>
<li>帮助手册: <a target="_blank" rel="noopener" href="https://openark.blackint3.com/manuals/">https://openark.blackint3.com/manuals/</a></li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/OneLong-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%A5%9E%E5%99%A8-%E5%8F%AF%E6%94%B6%E9%9B%86%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF/">
                OneLong-信息收集神器(可收集企业信息)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="OneLong"><a href="#OneLong" class="headerlink" title="OneLong"></a>OneLong</h1><p>链接:<a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/">https://github.com/M0nster3/OneLong/</a></p>
<p>下载链接:<a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/releases">https://github.com/M0nster3/OneLong/releases</a></p>
<p>郑重声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担。</p>
<h2 id="0x01、介绍"><a href="#0x01、介绍" class="headerlink" title="0x01、介绍"></a>0x01、介绍</h2><p>作者：<a target="_blank" rel="noopener" href="https://github.com/M0nster3">Monster3</a></p>
<p>定位：为了简化前期信息收集的繁重任务，协助红队人员快速的信息收集，测绘目标资产，寻找薄弱点，暂时实现了收集企业信息，子域名收集，子域名爆破，资产邮箱，指纹探测，漏洞扫描，后台识别，后续会跟新对IP相关的搜集。</p>
<h2 id="0x02、使用"><a href="#0x02、使用" class="headerlink" title="0x02、使用"></a>0x02、使用</h2><p>使用方式比较简单，现在主要针对不同需求实现了两种信息收集的方式，一种是根据企业关键字去进行信息搜集，这里需要填写aqc和qcc的API，第二种方式是需要填写公司域名，去进行搜集</p>
<p>注意：在调用API的时候有些需要科学上网，<em><strong>最好在进行使用的时候加上-proxy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:7897/">http://127.0.0.1:7897</a></strong></em> 进行科学上网。</p>
<p>1、根据企业关键字去进行信息搜集，最后填写正确完整的关键字，这部分主要参考了<a target="_blank" rel="noopener" href="https://github.com/wgpsec/ENScan_GO">ENScan_GO</a>,相关搜索企业细节以及方法和它是一样，注意的是使用这种方式必须填写aqc和qcc的Cookie</p>
<ul>
<li><em><strong>OneLong -n 企业名称 -proxy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a></strong></em></li>
</ul>
<p>2、根据企业域名去进行信息搜集</p>
<ul>
<li><em><strong>OneLong -d target.com -proxy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a></strong></em></li>
</ul>
<p>3、批量域名信息搜集</p>
<ul>
<li><em><strong>OneLong -f file.txt -proxy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a></strong></em></li>
</ul>
<p>4、如果目标企业存在安全设备，并且IP资源不多的话，可以只进行被动扫描，不进行子域名以及端口爆破，不进行漏洞扫描</p>
<ul>
<li><em><strong>OneLong -d target.com&#x2F;-n 企业名称 -low -proxy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a></strong></em></li>
</ul>
<h2 id="0x03、参数讲解"><a href="#0x03、参数讲解" class="headerlink" title="0x03、参数讲解"></a>0x03、参数讲解</h2><p>默认就是上面的三种方式进行使用 <em><strong>-d</strong></em> <em><strong>-f</strong></em> <em><strong>-n</strong></em></p>
<p>有一些相关企业的参数需要结合 <em><strong>-n</strong></em> 使用有 <em><strong>-deep</strong></em> <em><strong>-invest</strong></em> <em><strong>-is-branch</strong></em> 这些参数必须先使用***-n***</p>
<p><em><strong>-low</strong></em> ：使用这个参数就相当于同时使用 <em><strong>-nport</strong></em> <em><strong>-npoc</strong></em> <em><strong>-nbao</strong></em> 只进行被动API进行扫描</p>
<p><em><strong>-o</strong></em>：设置输出Excel的文件夹，最后输出的excel回保存到这个参数重</p>
<p><em><strong>-p</strong></em>：进行端口爆破的时候指定的端口，代码中内置了三种***“–top-ports 1000”*** <em><strong>“–top-ports 100”</strong></em> <em><strong>“–top-ports 10”</strong></em> 默认爆破top 1000</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-d string</span><br><span class="line">  	域名</span><br><span class="line">-deep int</span><br><span class="line">  	递归搜索n层公司 (default 5)</span><br><span class="line">-delay int</span><br><span class="line">  	填写最大延迟时间（秒）将会在1-n间随机延迟</span><br><span class="line">-f string</span><br><span class="line">  	批量扫描</span><br><span class="line">-invest float</span><br><span class="line">  	投资比例  (default 70)</span><br><span class="line">-is-branch</span><br><span class="line">  	深度查询分支机构信息（数量巨大），默认不查询</span><br><span class="line">-low</span><br><span class="line">  	只进行被动扫描，不进行子域名以及端口爆破，不进行漏洞扫描</span><br><span class="line">-n string</span><br><span class="line">  	企业关键词 eg 百度</span><br><span class="line">-nbao</span><br><span class="line">  	不进行爆破子域名</span><br><span class="line">-npoc</span><br><span class="line">  	不进行漏洞扫描</span><br><span class="line">-nport</span><br><span class="line">  	不进行爆破端口</span><br><span class="line">-o string</span><br><span class="line">  	结果输出的文件夹位置(可选)</span><br><span class="line">-p string</span><br><span class="line">  	端口爆破默认为Top1000，还可修改为100或者10 (default &quot;--top-ports 1000&quot;)</span><br><span class="line">-proxy string</span><br><span class="line">  	设置代理例如:-proxy=http://127.0.0.1:7897</span><br><span class="line">-timeout int</span><br><span class="line">  	每个请求默认1（分钟）超时 (default 1)</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/long.jpeg"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/long.jpeg" alt="login"></a></p>
<h2 id="0x04、相关配置文件解读"><a href="#0x04、相关配置文件解读" class="headerlink" title="0x04、相关配置文件解读"></a>0x04、相关配置文件解读</h2><h3 id="子域名相关配置文件"><a href="#子域名相关配置文件" class="headerlink" title="子域名相关配置文件"></a>子域名相关配置文件</h3><ul>
<li><em><strong>OneLong -n 企业名称</strong></em> 在使用这种方式的时候必须添加Aiqicha或者是TYC的token，否则不能正常使用，因为这个流程是需要这两个api去查询相应的备案号，然后才能进行后续的资产收集</li>
<li><em><strong>OneLong -d target.com</strong></em> 在使用这种方式因为工具里面带了一些不需要key的api，所以可以直接跑。</li>
</ul>
<p>想要搜集的信息更加全面，可以添加相应的API，添加的API不含直接收费的，都是一些免费的和一些有免费次数的</p>
<p><a target="_blank" rel="noopener" href="https://app.binaryedge.io/account/api">binaryedge</a> , <a target="_blank" rel="noopener" href="https://fullhunt.io/user/settings/">fullhunt</a> , <a target="_blank" rel="noopener" href="https://hunter.qianxin.com/home/myInfo">qaxhunter</a> , <a target="_blank" rel="noopener" href="https://bevigil.com/osint/api-keys">bevigil</a> , <a target="_blank" rel="noopener" href="https://search.censys.io/account/api">CensysToken&#x2F;CensysSecret</a> , <a target="_blank" rel="noopener" href="https://www.zoomeye.org/profile">zomeye</a> , <a target="_blank" rel="noopener" href="https://user.whoisxmlapi.com/products">whoisxmlapi</a> , <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/user/M0nster3/apikey">virustotal</a> , <a target="_blank" rel="noopener" href="https://account.shodan.io/">shodan</a> , <a target="_blank" rel="noopener" href="https://chaos.projectdiscovery.io/#/">chaos</a> , <a target="_blank" rel="noopener" href="https://leakix.net/settings/api">leakix</a> , <a target="_blank" rel="noopener" href="https://app.netlas.io/profile/">netlax</a> , <a target="_blank" rel="noopener" href="https://quake.360.net/quake/#/personal?tab=message">quake</a> , <a target="_blank" rel="noopener" href="https://developers.google.com/custom-search/v1/overview#search_engine_id">googleid</a> , <a target="_blank" rel="noopener" href="https://developers.google.com/custom-search/v1/overview#api_key">googleapi</a> , <a target="_blank" rel="noopener" href="https://fofa.info/userInfo">fofakey&#x2F;fofaEmail</a> , <a target="_blank" rel="noopener" href="https://github.com/settings/tokens">githubtoken</a> ,</p>
<p><a target="_blank" rel="noopener" href="https://securitytrails.com/app/auth/login?return=/app/account">securitytrails</a>:这个需要企业邮箱注册，可以去网上找一个免费注册一些比如<a target="_blank" rel="noopener" href="https://mailh.qiye.163.com/">网易</a> ,</p>
<p><a target="_blank" rel="noopener" href="https://www.racent.com/">racent</a>:抓包获取数据包里面的token</p>
<p><a target="_blank" rel="noopener" href="https://aiqicha.baidu.com/">Aiqicha</a>：Cookie信息请勿直接 <code>document.cookie</code>，可能因为http-only 选项无法复制全导致登陆失败</p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/image-20221028223835307.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/image-20221028223835307.png" alt="login"></a></p>
<p><a target="_blank" rel="noopener" href="https://www.aldzs.com/">阿拉丁</a>:点击任意请求，拿到请求里的TOKEN</p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/image-20230709132223242.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/image-20230709132223242.png" alt="login"></a></p>
<p><a target="_blank" rel="noopener" href="https://www.tianyancha.com/">TYC tycid</a>:配置COOKIE后配置tycid,这里的cookie也是个Aiqicha一样那样直接从数据包中获取</p>
<p><a target="_blank" rel="noopener" href="https://www.qimai.cn/">Qimai</a>:登陆账号然后把数据包里面的PHPSESSID提取出来就可以，这个也是点击任意链接都可以</p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/20240401153609.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/20240401153609.png" alt="login"></a></p>
<h3 id="MassDns模块"><a href="#MassDns模块" class="headerlink" title="MassDns模块"></a><a target="_blank" rel="noopener" href="https://github.com/blechschmidt/massdns">MassDns模块</a></h3><p>注意：Releases中的文件夹名称不能更换</p>
<p>工具中的爆破主要是引用了MassDns爆破工具，作者称无需特殊配置，MassDNS 就能够使用公开可用的解析器每秒解析超过 350,000 个名称。是一个高效的爆破工具，</p>
<ul>
<li>resolvers: Releases中有一个Script&#x2F;MassDns&#x2F;resolvers.txt文件夹名称添加进去，如果更换了resolvers.txt,必须放在当前文件夹只需要把名称换了即可</li>
<li>wordlist：爆破的目录文件，项目中的爆破文件都在这个目录下Script\Dict，</li>
<li>massdnsPath:将Script&#x2F;MassDns下的MassDns应用程序名称添加进来，如果是Linux的则需要把MassDns.exe改为相应的名称</li>
</ul>
<h3 id="Email模块"><a href="#Email模块" class="headerlink" title="Email模块"></a>Email模块</h3><p>最好设置 <a target="_blank" rel="noopener" href="https://github.com/settings/tokens">githubtoken</a> 这里的Email也会调用这个Cookie里面的token，github搜索效果比较好</p>
<p><a target="_blank" rel="noopener" href="https://hunter.io/">emailhunter</a> , <a target="_blank" rel="noopener" href="https://intelx.io/">intelxEmail</a> , <a target="_blank" rel="noopener" href="https://tomba.io/">tombaKey&#x2F;tombaSecret</a></p>
<h3 id="Port模块"><a href="#Port模块" class="headerlink" title="Port模块"></a>Port模块</h3><p><em><strong>masscanpath</strong></em>: Masscan工具放的位置如果是在环境变量中则默认就行，比如kali之类的 <em><strong>rate</strong></em>: Masscan速率，速率如果太大很有可能直接带宽占满 <em><strong>nmappath</strong></em>: Nmap工具放的位置如果是在环境变量中则默认就行</p>
<h3 id="Afrog"><a href="#Afrog" class="headerlink" title="Afrog"></a><a target="_blank" rel="noopener" href="https://github.com/zan8in/afrog">Afrog</a></h3><p>这个主要还是参考官方网站配置即可</p>
<h4 id="ceye"><a href="#ceye" class="headerlink" title="ceye"></a>ceye</h4><ul>
<li>访问<a target="_blank" rel="noopener" href="http://ceye.io/">ceye.io</a>网站并注册一个帐户。</li>
<li>登录并进入个人设置页面。</li>
<li>复制<code>domain</code>和<code>api-key</code>并在文件中正确配置它们。</li>
</ul>
<h4 id="Dnslogcn"><a href="#Dnslogcn" class="headerlink" title="Dnslogcn"></a>Dnslogcn</h4><ul>
<li>无需配置，但 <a target="_blank" rel="noopener" href="http://dnslog.cn/">dnslog.cn不稳定</a></li>
</ul>
<h4 id="Alphalog"><a href="#Alphalog" class="headerlink" title="Alphalog"></a>Alphalog</h4><ul>
<li>需要构建服务 <a target="_blank" rel="noopener" href="https://github.com/AlphabugX/Alphalog">alphalog</a></li>
</ul>
<h4 id="Xray"><a href="#Xray" class="headerlink" title="Xray"></a>Xray</h4><ul>
<li>需要搭建 <a target="_blank" rel="noopener" href="https://docs.xray.cool/tools/xray/advanced/reverse">xray服务</a></li>
</ul>
<h3 id="相关目录介绍"><a href="#相关目录介绍" class="headerlink" title="相关目录介绍"></a>相关目录介绍</h3><p>目前是有四种目录， AfrogAddPoc:这个目录主要是里面如果添加一些Afrog工具的一些自动POC,可以放到这个文件夹，工具会自动识别</p>
<p>Dict：这个里面现在是放了两个文件一个是Login.txt 这个主要就是在进行查找后台路径的时候，对路径的一些匹配，另一个是一个子域名目录文件，在进行MassDns爆破的时候加载的字典。</p>
<p>Ehole：这和里面主要放的是在进行url访问，进行一些高危漏洞以及CMS进行指纹识别的规则。</p>
<p>MassDns：这个里面主要就是放MassDns进行爆破的应用程序和所需要的resolvers文件。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/20240401165726.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/20240401165726.png" alt="login"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Utils:</span><br><span class="line">  output: &quot;&quot;            # 导出文件位置</span><br><span class="line">cookies:</span><br><span class="line">  aiqicha: &#x27;&#x27;           # 爱企查   Cookie</span><br><span class="line">  tianyancha: &#x27;&#x27;        # 天眼查   Cookie</span><br><span class="line">  tycid: &#x27;&#x27;        		# 天眼查   CApi ID(capi.tianyancha.com)</span><br><span class="line">  aldzs: &#x27;&#x27;             # 阿拉丁   TOKEN(see README)</span><br><span class="line">  qimai: &#x27;&#x27;             # 七麦数据  Cookie</span><br><span class="line">  binaryedge: &#x27;&#x27;		# binaryedge  Cookie 免费查询250次</span><br><span class="line">  fullhunt: &#x27;&#x27;			# Fullhunt Cookie 威胁平台 每月免费100次</span><br><span class="line">  hunter: &#x27;&#x27;			# Hunter Cookie 威胁平台 每日免费500个数据</span><br><span class="line">  bevigil: &#x27;&#x27;           # Bevigil Cookie 威胁平台 每月免费50次</span><br><span class="line">  CensysToken: &#x27;&#x27;       # Censys Token 威胁平台 每月免费250次</span><br><span class="line">  CensysSecret: &#x27;&#x27;      # Censys Secret 威胁平台 每月免费250次</span><br><span class="line">  zoomeye: &#x27;&#x27;			# ZooEye Cookie 每月1000条</span><br><span class="line">  whoisxmlapi: &#x27;&#x27;		# whoisxmlapi Cookie 免费500次</span><br><span class="line">  virustotal: &#x27;&#x27;        # virustotal Cookie 每分钟4次 每天500次</span><br><span class="line">  shodan: &#x27;&#x27;			# shodan Cookie </span><br><span class="line">  chaos: &#x27;&#x27;				# chaos Key</span><br><span class="line">  leakix: &#x27;&#x27;			# leakix Key</span><br><span class="line">  netlas: &#x27;&#x27;			# Netlas key</span><br><span class="line">  quake: &#x27;&#x27;				# Quake key</span><br><span class="line">  securitytrails: &#x27;&#x27;	# securitytrails 需要企业邮箱，每个月50次</span><br><span class="line">  googleid: &#x27;&#x27;			# google id 免费的API只能查询前100条结果,每天免费提供 100 次搜索查询</span><br><span class="line">  googleapi: &#x27;&#x27;			# google Api 免费的API只能查询前100条结果,每天免费提供 100 次搜索查询</span><br><span class="line">  fofaKey: &#x27;&#x27;			# Fofa key</span><br><span class="line">  fofaEmail: &#x27;&#x27;			# Fofa Email</span><br><span class="line">  githubtoken: &#x27;&#x27;		# Github Token </span><br><span class="line">  racent: &#x27;&#x27;			# racent Token</span><br><span class="line">massdns:</span><br><span class="line">  resolvers: &#x27;resolvers.txt&#x27;			# resolvers 文件名称</span><br><span class="line">  wordlist: &#x27;names.txt&#x27;			# 子域名爆破文件名称</span><br><span class="line">  massdnsPath: &#x27;massdns.exe&#x27;		# Massdns工具名称</span><br><span class="line">email:</span><br><span class="line">  emailhunter: &#x27;&#x27;		# Email hunter Token</span><br><span class="line">  intelxEmail: &#x27;&#x27;		# Email Intelx Token</span><br><span class="line">  tombaKey: &#x27;&#x27;			# Email tombaKey</span><br><span class="line">  tombaSecret: &#x27;&#x27;		# Email tombaSecret</span><br><span class="line">port:</span><br><span class="line">  masscan:</span><br><span class="line">    masscanpath: &#x27;masscan&#x27;		    # Masscan放的位置如果是在环境变量中则默认就行</span><br><span class="line">    rate: 5000 										# Masscan速率，速率如果太大很有可能直接带宽占满</span><br><span class="line">  nmappath: &#x27;nmap&#x27;	</span><br><span class="line">#Afrog配置</span><br><span class="line">reverse:</span><br><span class="line">  alphalog:</span><br><span class="line">    domain: &quot;&quot;</span><br><span class="line">    api_url: &quot;&quot;</span><br><span class="line">  ceye:</span><br><span class="line">    api-key: &quot;&quot;</span><br><span class="line">    domain: &quot;&quot;</span><br><span class="line">  dnslogcn:</span><br><span class="line">    domain: dnslog.cn</span><br><span class="line">  xray:</span><br><span class="line">    x_token: &quot;&quot;</span><br><span class="line">    domain: &quot;&quot;</span><br><span class="line">    api_url: http://x.x.x.x:8777</span><br></pre></td></tr></table></figure>



<h2 id="0x05、效果图"><a href="#0x05、效果图" class="headerlink" title="0x05、效果图"></a>0x05、效果图</h2><p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/1711968305378.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/1711968305378.png" alt="login"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/1711968416627.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/1711968416627.png" alt="login"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/M0nster3/OneLong/blob/main/Images/1711968830642.png"><img src="https://github.com/M0nster3/OneLong/raw/main/Images/1711968830642.png" alt="login"></a></p>
<h2 id="0x06、参考"><a href="#0x06、参考" class="headerlink" title="0x06、参考"></a>0x06、参考</h2><p><a target="_blank" rel="noopener" href="https://github.com/wgpsec/ENScan_GO">ENScan_GO</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/hanc00l/nemo_go">nemo_go</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">Oneforall</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/0x727/ShuiZe_0x727">Shuize</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/lc/gau">gau</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/subfinder">subfinder</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/EHole">Ehole</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/burp%E6%8F%92%E4%BB%B6-%E6%8C%87%E7%BA%B9%E6%89%AB%E6%8F%8F/">
                burp插件-指纹扫描
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="Burp-指纹识别"><a href="#Burp-指纹识别" class="headerlink" title="Burp 指纹识别"></a>Burp 指纹识别</h1><p>下载链接:<a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpFingerPrint/releases/download/v1.5/BurpFingerPrint.jar">https://github.com/shuanx/BurpFingerPrint/releases/download/v1.5/BurpFingerPrint.jar</a></p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/aec62dc0b68de45205213e0a66854fd631127f8745f8a42d6340d3028a2cd8f7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f417574686f722d536861756e2d626c7565"><img src="https://camo.githubusercontent.com/aec62dc0b68de45205213e0a66854fd631127f8745f8a42d6340d3028a2cd8f7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f417574686f722d536861756e2d626c7565" alt="img"></a> <a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/a0f773456863099bcf616a51290c7ea9df5f80dad5116aa42793f3f8cffd5ef7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a444b2d392b2d79656c6c6f77"><img src="https://camo.githubusercontent.com/a0f773456863099bcf616a51290c7ea9df5f80dad5116aa42793f3f8cffd5ef7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a444b2d392b2d79656c6c6f77" alt="img"></a> <a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/58e5f7dfab13434e66cf8dc2eb3c2c17e8ef39e24748293fad85aba83a4be899/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2545362538442541312545362542432538462545362539382541462545392539372541382545382538392542412545362539432541462d2545352542452538302545352542452538302545362539432538392545362538342538462545362538332542332545342542382538442545352538382542302545372539412538342545362538382539302545362539452539432d726564"><img src="https://camo.githubusercontent.com/58e5f7dfab13434e66cf8dc2eb3c2c17e8ef39e24748293fad85aba83a4be899/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2545362538442541312545362542432538462545362539382541462545392539372541382545382538392542412545362539432541462d2545352542452538302545352542452538302545362539432538392545362538342538462545362538332542332545342542382538442545352538382542302545372539412538342545362538382539302545362539452539432d726564" alt="img"></a></p>
<blockquote>
<p>攻击过程中，我们通常会用浏览器访问一些资产，该BurpSuite插件实现被动指纹识别+网站提取链接+OA爆破，可帮助我们发现更多资产。</p>
</blockquote>
<h2 id="功能如下"><a href="#功能如下" class="headerlink" title="功能如下"></a>功能如下</h2><blockquote>
<p>下述功能会在2024年5月底完成，如果有更好的建议都可以提，然后再麻烦点个Star，创作不易，打造最强指纹识别库和弱口令探测库</p>
</blockquote>
<ul>
<li>浏览器被动指纹识别，已集成Ehole指纹识别库</li>
<li>提取网站的URL链接和解析JS文件中的URL链接后进行指纹识别</li>
<li>开界面进行指纹库修改，可导入、导出、重置</li>
<li>优化已有指纹库，区分重点指纹和常见指纹，补充部分实战热门漏洞的指纹，方便直接一键getshell <a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpFingerPrint/blob/main/images/importantFinger.png"><img src="https://github.com/shuanx/BurpFingerPrint/raw/main/images/importantFinger.png" alt="img.png"></a></li>
<li>优化算法，提升性能、减少内存开销</li>
<li>使用sqlite存储扫描结果，放置因BurpSuite意外退出而导致数据丢失</li>
<li>收集github上常见的EXP工具，提起其含有EXP漏洞的指纹，当成重要指纹，一旦页面出现该指纹，就表示有戏有戏</li>
<li>1、<a target="_blank" rel="noopener" href="https://github.com/R4gd0ll/I-Wanna-Get-All">https://github.com/R4gd0ll/I-Wanna-Get-All</a></li>
<li>2、<a target="_blank" rel="noopener" href="https://github.com/YinWC/2021hvv_vul">https://github.com/YinWC/2021hvv_vul</a></li>
<li>3、<a target="_blank" rel="noopener" href="https://github.com/zhzyker/vulmap">https://github.com/zhzyker/vulmap</a></li>
<li>4、<a target="_blank" rel="noopener" href="https://github.com/SecWiki/CMS-Hunter">https://github.com/SecWiki/CMS-Hunter</a></li>
<li>5、<a target="_blank" rel="noopener" href="https://github.com/coffeehb/Some-PoC-oR-ExP">https://github.com/coffeehb/Some-PoC-oR-ExP</a></li>
<li>6、<a target="_blank" rel="noopener" href="https://github.com/White-hua/Apt_t00ls">https://github.com/White-hua/Apt_t00ls</a></li>
<li>7、<a target="_blank" rel="noopener" href="https://github.com/biggerwing/nsfocus-rsas-knowledge-base">https://github.com/biggerwing/nsfocus-rsas-knowledge-base</a></li>
<li>优化GUI，指纹识别出来后，可以快速查看对应的利用EXP的github地址</li>
<li>OA类弱口令爆破</li>
<li>与本地Packer Fuzzer JS扫描器配合发现隐秘漏洞</li>
</ul>
<h2 id="支持检测指纹"><a href="#支持检测指纹" class="headerlink" title="支持检测指纹"></a>支持检测指纹</h2><ul>
<li>通达OA</li>
<li>致远OA</li>
<li>蓝凌OA</li>
<li>泛微OA</li>
<li>万户OA</li>
<li>东华OA</li>
<li>信呼OA</li>
<li>等等</li>
</ul>
<h2 id="支持弱口令爆破组件"><a href="#支持弱口令爆破组件" class="headerlink" title="支持弱口令爆破组件"></a>支持弱口令爆破组件</h2><ul>
<li>Apache Tomcat</li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/burp%E6%8F%92%E4%BB%B6-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%9F%A5%E6%89%BE%E5%99%A8/">
                burp插件-敏感信息查找器
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="Burp-API查找器"><a href="#Burp-API查找器" class="headerlink" title="Burp API查找器"></a>Burp API查找器</h1><p>下载链接:<a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/releases/download/v1.7/BurpAPIFinder.jar">https://github.com/shuanx/BurpAPIFinder/releases/download/v1.7/BurpAPIFinder.jar</a></p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/aec62dc0b68de45205213e0a66854fd631127f8745f8a42d6340d3028a2cd8f7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f417574686f722d536861756e2d626c7565"><img src="https://camo.githubusercontent.com/aec62dc0b68de45205213e0a66854fd631127f8745f8a42d6340d3028a2cd8f7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f417574686f722d536861756e2d626c7565" alt="img"></a> <a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/a0f773456863099bcf616a51290c7ea9df5f80dad5116aa42793f3f8cffd5ef7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a444b2d392b2d79656c6c6f77"><img src="https://camo.githubusercontent.com/a0f773456863099bcf616a51290c7ea9df5f80dad5116aa42793f3f8cffd5ef7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a444b2d392b2d79656c6c6f77" alt="img"></a> <a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/58e5f7dfab13434e66cf8dc2eb3c2c17e8ef39e24748293fad85aba83a4be899/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2545362538442541312545362542432538462545362539382541462545392539372541382545382538392542412545362539432541462d2545352542452538302545352542452538302545362539432538392545362538342538462545362538332542332545342542382538442545352538382542302545372539412538342545362538382539302545362539452539432d726564"><img src="https://camo.githubusercontent.com/58e5f7dfab13434e66cf8dc2eb3c2c17e8ef39e24748293fad85aba83a4be899/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2545362538442541312545362542432538462545362539382541462545392539372541382545382538392542412545362539432541462d2545352542452538302545352542452538302545362539432538392545362538342538462545362538332542332545342542382538442545352538382542302545372539412538342545362538382539302545362539452539432d726564" alt="img"></a></p>
<blockquote>
<p>在攻防演练过程中，我们通常会使用浏览器访问一些资产，但很多未授权&#x2F;敏感信息&#x2F;越权隐匿在访问接口过html、JS文件等，通过该Burp插件我们可以： 1、通过某些接口可以发现进行未授权&#x2F;越权获取到所有的账号密码、私钥、凭证 2、发现通过某接口可以枚举用户信息、修改密码、用户创建接口 3、发现登陆后台网址 4、发现在html、JS中漏洞账号密码或者云主机的Access Key和SecretKey …</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/blob/main/images/main.png"><img src="https://github.com/shuanx/BurpAPIFinder/raw/main/images/main.png" alt="图片.png"></a></p>
<h2 id="功能如下"><a href="#功能如下" class="headerlink" title="功能如下"></a>功能如下</h2><blockquote>
<p>如果有更好的建议或者期待使用的，点个免费的星星</p>
</blockquote>
<ul>
<li>网站提取的URL链接并解析JS文件中的URL链接</li>
<li>前段界面可自行定义铭感关键词、敏感url匹配</li>
<li>界面可配置的开启主动探测探测、铭感信息获取</li>
<li>集成主题攻防场景敏感信息的指纹库 <a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/blob/main/images/config.png"><img src="https://github.com/shuanx/BurpAPIFinder/raw/main/images/config.png" alt="图片.png"></a></li>
<li>集成HaE的敏感信息识别指纹 <a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/blob/main/images/HaE.png"><img src="https://github.com/shuanx/BurpAPIFinder/raw/main/images/HaE.png" alt="图片.png"></a></li>
<li>集成APIKit的敏感信息识别指纹 <a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/blob/main/images/APIKit.png"><img src="https://github.com/shuanx/BurpAPIFinder/raw/main/images/APIKit.png" alt="图片.png"></a></li>
<li>集成红薯的敏感信息识别指纹 <a target="_blank" rel="noopener" href="https://github.com/shuanx/BurpAPIFinder/blob/main/images/sweetPotato.png"><img src="https://github.com/shuanx/BurpAPIFinder/raw/main/images/sweetPotato.png" alt="图片.png"></a></li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2025/01/18/zmap-%E4%B8%80%E6%AC%BE%E5%8F%AF%E4%BB%A5%E8%AE%A9%E4%BD%A045%E5%88%86%E9%92%9F%E6%89%AB%E6%8F%8F%E5%85%A8%E7%BD%91ipv4%E7%AB%AF%E5%8F%A3%E7%9A%84%E5%B7%A5%E5%85%B7/">
                zmap-一款可以让你45分钟扫描全网ipv4端口的工具
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2025-01-18</span>
            
            
            
                <span class="category">
                    <a href="/categories/渗透/">渗透</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="ZMap：互联网扫描仪"><a href="#ZMap：互联网扫描仪" class="headerlink" title="ZMap：互联网扫描仪"></a>ZMap：互联网扫描仪</h1><p><a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/actions/workflows/cmake.yml/badge.svg"><img src="https://github.com/zmap/zmap/actions/workflows/cmake.yml/badge.svg" alt="构建状态"></a></p>
<p>ZMap 是一款快速单数据包网络扫描仪，专为互联网范围内的网络调查而设计。在具有千兆位以太网连接的典型台式计算机上，ZMap 能够在 45 分钟内扫描单个端口上的整个公共 IPv4 地址空间。通过 10gigE 连接和<a target="_blank" rel="noopener" href="http://info.iet.unipi.it/~luigi/netmap/">netmap</a>或<a target="_blank" rel="noopener" href="http://www.ntop.org/products/packet-capture/pf_ring/">PF_RING</a>，ZMap 可以在 5 分钟内扫描 IPv4 地址空间。</p>
<p>ZMap 可在 GNU&#x2F;Linux、Mac OS 和 BSD 上运行。 ZMap目前已经完全实现了TCP SYN扫描、ICMP、DNS查询、UPnP、BACNET的探测模块，并且可以发送大量的<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/blob/master/examples/udp-probes/README">UDP探测</a>。如果您希望进行更多复杂的扫描（例如，横幅抓取或 TLS 握手），请查看<a target="_blank" rel="noopener" href="https://github.com/zmap/zgrab2">ZGrab 2</a>，它是 ZMap 的姊妹项目，它执行有状态的应用程序层握手。</p>
<h2 id="使用-ZMap"><a href="#使用-ZMap" class="headerlink" title="使用 ZMap"></a>使用 ZMap</h2><p>如果您以前没有使用过 ZMap，我们有一份分步入门<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki/Getting-Started-Guide">指南</a>，详细介绍了如何执行基本扫描。有关 ZMap 所有选项和更高级功能的文档可以在我们的<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki">GitHub Wiki</a>中找到。</p>
<p>如果您有疑问，请先查看我们的<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki/FAQ">常见问题解答</a>。还有疑问吗？在<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/discussions/categories/q-a">Github 讨论</a>中询问社区。请不要针对使用或支持问题创建问题。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>ZMap 的最新稳定版本是版本<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/releases/tag/v3.0.0">3.0.0</a>，支持 Linux、macOS 和 BSD。 ZMap <a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/releases/tag/v4.1.0-RC2">4.1.0-RC2</a>添加了对扫描多个端口的支持。</p>
<p><strong>从源代码构建 ZMap 的说明</strong>可以在<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/blob/main/INSTALL.md">INSTALL</a>中找到。</p>
<p>blackarch中使用命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syu yay &amp;&amp; sudo yay -S zmap</span><br></pre></td></tr></table></figure>

<p>kali&#x2F;parrot&#x2F;debian系列安装命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install zmap</span><br></pre></td></tr></table></figure>

<p>centos&#x2F;redhat系列安装命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y zmap</span><br></pre></td></tr></table></figure>



<h2 id="建筑学"><a href="#建筑学" class="headerlink" title="建筑学"></a>建筑学</h2><p>有关 ZMap 架构的更多信息以及与其他工具的比较可以在这两篇研究论文中找到：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zmap.io/paper.pdf">ZMap：快速互联网范围扫描及其安全应用</a></li>
<li><a target="_blank" rel="noopener" href="https://jhalderm.com/pub/papers/zmap10gig-woot14.pdf">Zippier ZMap：10 Gbps 的互联网范围扫描</a></li>
</ul>
<p>如果您使用 ZMap 进行已发表的研究，请引用原始研究论文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@inproceedings&#123;durumeric2013zmap,</span><br><span class="line">  title=&#123;&#123;ZMap&#125;: Fast Internet-wide scanning and its security applications&#125;,</span><br><span class="line">  author=&#123;Durumeric, Zakir and Wustrow, Eric and Halderman, J Alex&#125;,</span><br><span class="line">  booktitle=&#123;22nd USENIX Security Symposium&#125;,</span><br><span class="line">  year=&#123;2013&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>引用 ZMap 论文有助于我们跟踪研究社区内的 ZMap 使用情况，并为持续开发寻求资金。</p>
<h2 id="许可和版权"><a href="#许可和版权" class="headerlink" title="许可和版权"></a>许可和版权</h2><p>ZMap 版权所有 2023 密歇根大学董事会</p>
<p>根据 Apache 许可证 2.0 版（“许可证”）获得许可；除非遵守许可证，否则您不得使用此文件。您可以在<a target="_blank" rel="noopener" href="http://www.apache.org/licenses/LICENSE-2.0%E8%8E%B7%E5%8F%96%E8%AE%B8%E5%8F%AF%E8%AF%81%E5%89%AF%E6%9C%AC">http://www.apache.org/licenses/LICENSE-2.0获取许可证副本</a></p>
<p>除非适用法律要求或书面同意，否则根据许可证分发的软件均按“原样”分发，不带任何明示或暗示的保证或条件。请参阅许可证，了解许可证下管理权限和限制的特定语言。</p>
<h1 id="入门指南"><a href="#入门指南" class="headerlink" title="入门指南"></a>入门指南</h1><p><a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki/Getting-Started-Guide/_edit">编辑</a> <a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki/_new">新一页</a></p>
<p>菲利普·斯蒂芬斯编辑了此页面3周前 · <a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/wiki/Getting-Started-Guide/_history">19次修订</a></p>
<p>边做边学最好？想要一些指导示例来演示使用 ZMap 进行基本扫描以入门吗？这是开始的地方！ ZMap 团队创建本指南是为了帮助新手习惯扫描，但如果仍有不清楚的地方，请随时在我们的<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/discussions">Github 讨论</a>中提问。</p>
<p>我们将介绍：</p>
<ul>
<li>安装 ZMap</li>
<li>运行第一次扫描</li>
<li>定向输出</li>
<li>表现</li>
<li>其他扫描类型</li>
<li>默认阻止的子网</li>
<li>更多资源</li>
</ul>
<h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><p>ZMap 可通过许多常见的包管理器获得，或者您也可以从源代码进行编译。完整说明可<a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/blob/main/INSTALL.md">在此处</a>获取。要检查您是否已正确安装所有内容，请运行<code>zmap --version</code>.目前我们建议使用版本 4.1.0-RC2。</p>
<h2 id="⚠️扫描速率警告"><a href="#⚠️扫描速率警告" class="headerlink" title="⚠️扫描速率警告"></a>⚠️扫描速率警告</h2><p>默认情况下，ZMap 将以您的网卡允许的速度进行扫描。由于 ZMap 直接组成以太网帧，因此它没有任何拥塞控制的概念（就像 TCP 默认情况下那样）。这有两个潜在的陷阱：</p>
<ul>
<li><em>目标网络 DoS：<em>如果您以非常高的速率扫描小型子网（例如，单个组织），您很容易意外地对目标网络进行 DOS。我们建议</em>不要</em>以 1Gbps 或更快的速度运行扫描，除非您要扫描整个互联网。如果您扫描单个网络，则以接近 10Mbps 的速率运行会更成功。</li>
<li><em>源网络过载：<em>无论您扫描多少台主机，您都可能面临</em>源</em>网络（即用于扫描 Internet 的网络）过载的风险。许多仅通告<em>吞吐量</em>数字（例如 1Gbps）的网络设备无法使用最小大小的数据包来处理全速（因为这需要处理设备的理论每秒最大数据包速率。）</li>
</ul>
<p>为了减少对目标网络的影响，ZMap 以随机顺序扫描范围内的 IP 地址。这意味着给定时间段内目标子网上的负载取决于 ZMap 的扫描速率和目标范围的大小。</p>
<p><img src="https://private-user-images.githubusercontent.com/23459798/288224881-8642008a-df16-40ac-a7ec-d9389964e7b3.gif?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQ0NjQ0OTEsIm5iZiI6MTcxNDQ2NDE5MSwicGF0aCI6Ii8yMzQ1OTc5OC8yODgyMjQ4ODEtODY0MjAwOGEtZGYxNi00MGFjLWE3ZWMtZDkzODk5NjRlN2IzLmdpZj9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MzAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDMwVDA4MDMxMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWMyM2U1MWQ0MDU4MWI0YmY1ZmM5ODk0YWIzNjA4ZTc5NmU1NTgzZDYxNDUzOTgyNDg2YmNjOGNiNTVlOTNlMTAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.iQ0ZNY5fL4LEUqZ5yCrWVzKPK4naw-G0HqqzIqn4McU" alt="目标子网负载"></p>
<p>在上图中，正在扫描的不同子网由彩色线表示。因此，如果扫描的目标较大，“良好”的扫描速率可能会更快，因为负载更加分散。</p>
<p>这不仅关系到成为无私的互联网公民，目标网络超载可能会导致：</p>
<ol>
<li>网络管理员封锁你的IP</li>
<li>路由器丢弃您的扫描数据包</li>
<li>剥夺其他 LAN 用户的互联网带宽</li>
</ol>
<p>#1 和 #2 都会导致扫描结果不准确，因为无法区分扫描无响应是由于不存在主机、防火墙阻止您的 IP 还是由于途中丢失数据包。更多详细信息，请参阅“提高扫描精度”部分。</p>
<p>我们在给定示例中根据扫描目标的大小列出了我们认为合理的带宽&#x2F;探头节流参数，但一个好的经验法则是以特定应用程序所需的最慢速率进行扫描。</p>
<h2 id="⚠️线程警告"><a href="#⚠️线程警告" class="headerlink" title="⚠️线程警告"></a>⚠️线程警告</h2><p>ZMap CLI 提供了使用 来设置发送线程数量的功能<code>-T number_of_threads</code>。还会创建用于接收数据包和监视扫描进度的线程，因此 ZMap 所需的线程数就是<code>2 + T</code>其中 T 是您设置的线程数（默认为 4，除非主机的核心数 &lt; 4）。</p>
<p>作为一般规则，我们建议坚持 &lt;&#x3D; 8 个发送线程，因为我们发现在此之后性能趋于稳定。此外，使用非常大的线程数 (&gt; 32) 不会<em>提高</em>扫描性能，并且可能会导致您遇到数据包发送问题或遇到数据包丢失，从而导致扫描结果不准确。</p>
<p>需要明确的是，创建比机器上的内核数量更多的线程的好处为零。发送线程都尽可能快地发送，并且增加线程超过核心数量将导致核心争用。</p>
<p>提示</p>
<p>与扫描速率一样，我们建议从较低的速率开始，然后根据需要增加，以确保扫描准确并最大限度地减少主机和网络压力。</p>
<h2 id="运行您的第一次扫描"><a href="#运行您的第一次扫描" class="headerlink" title="运行您的第一次扫描"></a>运行您的第一次扫描</h2><p>让我们开始第一次扫描。我们将通过端口 80 向<code>TCP SYN</code>子网中的所有 IP 发送一个数据包<code>171.67.70.0/23</code>，数据包发送速率为每秒 128 个数据包。如果该 IP&#x2F;端口对上有任何运行，我们应该会收到一个<code>SYN ACK</code>数据包作为回复。</p>
<p>运行以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -r 128 171.67.70.0/23</span><br></pre></td></tr></table></figure>

<p>您应该得到一些类似于以下内容的输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">171.67.71.204</span><br><span class="line">171.67.71.128</span><br><span class="line">171.67.70.245</span><br><span class="line">171.67.71.191</span><br><span class="line">171.67.71.186</span><br><span class="line">171.67.71.202</span><br><span class="line">171.67.70.240</span><br><span class="line">171.67.70.242</span><br><span class="line">171.67.71.192</span><br><span class="line"> 0:05 42% (7s left); send: 512 done (127 p/s avg); recv: 91 17 p/s (17 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:06 50% (6s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (15 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:07 59% (5s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (12 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:08 67% (4s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (11 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:09 75% (3s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (10 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:10 84% (2s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (9 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line"> 0:11 92% (1s left); send: 512 done (127 p/s avg); recv: 91 0 p/s (8 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.77%</span><br><span class="line">Dec 05 22:29:12.352 [INFO] zmap: completed</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>故障排除</strong></p>
<p>ZMap 非常擅长告诉您它遇到的任何问题。一些常见的包括：</p>
<ol>
<li>您的用户可能无权捕获默认接口上的流量，除非您使用<code>sudo</code>.</li>
<li>如果有多个网络适配器可供选择，您可能需要指定您的 MAC 地址。如果您看到类似的情况，请<code>--source-mac=XX:XX:XX:XX:XX:XX</code>在您运行的任何 ZMap 命令中使用该标志。</li>
<li>第一次运行 ZMap 时，ZMap 可能会提到<code>zmap: could not detect GW MAC address...</code>.按照其指示运行命令<code>curl zmap.io</code>，这应该初始化 GW MAC 地址，以便 ZMap 可以正确路由流量。</li>
</ol>
<p>如果您按照说明操作，使用的是受支持的操作系统，但<em>仍然遇到问题，请通过</em><a target="_blank" rel="noopener" href="https://github.com/zmap/zmap/discussions">Github 讨论</a>与我们联系！</p>
</blockquote>
<p>我们可以在这里看到两种类型的输出：</p>
<ol>
<li>响应我们的<code>SYN</code>数据包的 IP</li>
<li>每秒打印详细的扫描状态（完成百分比、剩余秒数、发送&#x2F;接收速率……）</li>
</ol>
<p>我们确实说过“输出类似于”，这提出了一个关键点，您的结果可能会略有不同。可访问 Internet 的主机可以在扫描之间打开&#x2F;离线，并且您的硬件可能比我们正在运行的硬件更快&#x2F;更慢。</p>
<p>将所有输出显示在一个屏幕中固然很好，但您可能希望将 IP&#x2F;端口命中和状态信息分开。</p>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p><code>-o</code>or标志<code>--output-file</code>允许我们指定 IP&#x2F;端口对命中的位置。尝试<code>-o</code>像这样使用该标志：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -o &quot;output.csv&quot; -r 128 171.67.70.0/23</span><br></pre></td></tr></table></figure>



<p>您应该得到类似于以下内容的输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Dec 05 21:52:43.347 [INFO] zmap: By default, ZMap will output the unique IP addresses of hosts that respond successfully (e.g., SYN-ACK packet). This is equivalent to running ZMap with the following flags: --output-module=csv --output-fields=saddr --output-filter=&#x27;success=1 &amp;&amp; repeat=0&#x27; --no-header-row. If you want all responses, explicitly set an output module or set --output-filter=&quot;&quot;.</span><br><span class="line">Dec 05 21:52:43.348 [INFO] dedup: Response deduplication method is full</span><br><span class="line">Dec 05 21:52:43.406 [INFO] recv: duplicate responses will be excluded from output</span><br><span class="line">Dec 05 21:52:43.406 [INFO] recv: unsuccessful responses will be excluded from output</span><br><span class="line"> 0:00 0%; send: 1 1 p/s (22 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line"> 0:00 0%; send: 1 0 p/s (22 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line"> 0:01 9%; send: 134 133 p/s (128 p/s avg); recv: 22 22 p/s (21 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 16.42%</span><br><span class="line"> 0:02 17%; send: 263 129 p/s (128 p/s avg); recv: 22 0 p/s (10 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 8.37%</span><br><span class="line"> 0:03 25%; send: 391 128 p/s (128 p/s avg); recv: 51 29 p/s (16 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 13.04%</span><br><span class="line"> 0:04 34%; send: 512 done (128 p/s avg); recv: 74 23 p/s (18 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 14.45%</span><br><span class="line"> 0:05 42% (7s left); send: 512 done (128 p/s avg); recv: 90 16 p/s (17 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:06 50% (6s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (14 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:07 59% (5s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (12 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:08 67% (4s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (11 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:09 75% (3s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (9 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:10 84% (2s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (8 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line"> 0:11 92% (1s left); send: 512 done (128 p/s avg); recv: 90 0 p/s (8 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 17.58%</span><br><span class="line">Dec 05 21:52:55.412 [INFO] zmap: completed</span><br></pre></td></tr></table></figure>



<p>新<code>output.csv</code>文件（位于运行扫描的文件夹中）现在应该包含在端口 80 上响应的所有 IP，并且我们<code>stdout</code>只会向我们显示扫描的状态，很好！</p>
<h2 id="表现"><a href="#表现" class="headerlink" title="表现"></a>表现</h2><p>ZMap 的一大卖点是它调查大型子网的速度。在千兆位以太网连接上，可以在 40 分钟内勘察单个端口上的整个 IPv4 空间！让我们讨论一下影响性能的各种因素。为此，我们需要更多地了解 ZMap 的运作方式。</p>
<h3 id="发送-接收解耦"><a href="#发送-接收解耦" class="headerlink" title="发送&#x2F;接收解耦"></a>发送&#x2F;接收解耦</h3><p>为了获得如此高性能，ZMap 在设计上是无状态的。这意味着一个&#x2F;多个发送线程发送数据包，一个&#x2F;多个接收线程记录任何回复，但没有线程间通信。正是由于缺乏通信&#x2F;锁定，ZMap 才具有如此高的性能。它还有助于解释我们上面看到的输出。子网 ( <code>/23</code>) 有 512 个 IP，加上每秒 128 个数据包的扫描速率 ( <code>p/s</code>)，探测数据包（<code>SYN</code>默认为 TCP 数据包）的发送在 4 秒内结束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0:04 34%; send: 512 done (128 p/s avg); recv: 74 23 p/s (18 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 14.45%</span><br></pre></td></tr></table></figure>



<p>默认情况下，接收线程在发送线程完成发送后等待 8 秒以等待任何<code>SYN ACK</code>数据包。我们发现 8 秒在等待<code>SYN ACK</code>来自远程主机的潜在慢速和等待时间不长以致回报递减之间取得了良好的平衡。根据您的需要，您可能希望使用 修改此值<code>--cooldown-time=10</code>。这将迫使接收线程等待 10 秒以接收任何落后的数据包。</p>
<p>请注意，在我们上面捕获的输出中，命中率在 后没有增加（至少在百分之一的粒度上）<code>0:05</code>，因此请记住收益递减。</p>
<h3 id="提高发送性能"><a href="#提高发送性能" class="headerlink" title="提高发送性能"></a>提高发送性能</h3><p>我们在上面的部分中介绍了接收线程将等待的恒定时间<code>SYN ACK</code>，<code>--cooldown-time</code>但这并没有解决发送的速率<code>SYN</code>。在较大的扫描中，这是将主导扫描运行时间的组件。</p>
<p>有了足够大的目标范围，就不用担心目标子网过载。为了进一步提高性能，我们需要添加更多线程。使用该<code>--sender-threads=N</code>标志来执行此操作：</p>
<h4 id="1-线程发送速率"><a href="#1-线程发送速率" class="headerlink" title="1 线程发送速率"></a><strong>1 线程发送速率</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -o &quot;output.csv&quot; -B 1G --sender-threads=1 171.67.70.0/2</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0:00 0%; send: 211 1 p/s (3.69 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">0:00 0%; send: 400 274 Kp/s (6.92 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">0:01 0%; send: 505473 505 Kp/s (478 Kp/s avg); recv: 5176 5.17 Kp/s (4.89 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.02%</span><br><span class="line">0:02 0%; send: 1113056 607 Kp/s (541 Kp/s avg); recv: 12962 7.78 Kp/s (6.30 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.16%</span><br><span class="line">0:03 0%; send: 1726996 614 Kp/s (565 Kp/s avg); recv: 20562 7.60 Kp/s (6.72 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.19%</span><br><span class="line">0:04 0%; send: 2335833 609 Kp/s (575 Kp/s avg); recv: 28571 8.01 Kp/s (7.04 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.22%</span><br><span class="line">0:05 0% (30m left); send: 2943829 608 Kp/s (582 Kp/s avg); recv: 36420 7.85 Kp/s (7.20 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.24%</span><br><span class="line">0:06 0% (30m left); send: 3550851 607 Kp/s (586 Kp/s avg); recv: 44122 7.70 Kp/s (7.28 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.24%</span><br><span class="line">0:07 0% (30m left); send: 4156961 606 Kp/s (589 Kp/s avg); recv: 52047 7.92 Kp/s (7.37 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.25%</span><br><span class="line">0:08 0% (30m left); send: 4756743 600 Kp/s (590 Kp/s avg); recv: 59834 7.79 Kp/s (7.42 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.26%</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<h4 id="4线程发送速率"><a href="#4线程发送速率" class="headerlink" title="4线程发送速率"></a><strong>4线程发送速率</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -o &quot;output.csv&quot; -B 1G --sender-threads=4 171.67.70.0/2</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0:00 0%; send: 360 1 p/s (5.31 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">0:00 0%; send: 586 388 Kp/s (8.58 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">0:01 0%; send: 1125395 1.12 Mp/s (1.05 Mp/s avg); recv: 11804 11.8 Kp/s (11.0 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.05%</span><br><span class="line">0:02 0%; send: 2401617 1.28 Mp/s (1.16 Mp/s avg); recv: 28248 16.4 Kp/s (13.7 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.18%</span><br><span class="line">0:03 0%; send: 3667077 1.27 Mp/s (1.19 Mp/s avg); recv: 44305 16.1 Kp/s (14.4 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.21%</span><br><span class="line">0:04 0%; send: 4932812 1.27 Mp/s (1.21 Mp/s avg); recv: 60886 16.6 Kp/s (15.0 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.23%</span><br><span class="line">0:05 1% (14m left); send: 6193698 1.26 Mp/s (1.22 Mp/s avg); recv: 77131 16.2 Kp/s (15.2 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.25%</span><br><span class="line">0:06 1% (14m left); send: 7452466 1.26 Mp/s (1.23 Mp/s avg); recv: 93092 16.0 Kp/s (15.3 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.25%</span><br><span class="line">0:07 1% (14m left); send: 8713445 1.26 Mp/s (1.23 Mp/s avg); recv: 109494 16.4 Kp/s (15.5 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.26%</span><br><span class="line">0:08 1% (14m left); send: 9970806 1.26 Mp/s (1.24 Mp/s avg); recv: 125807 16.3 Kp/s (15.6 Kp/s avg); drops: 0 p/s (0 p/s avg); hitrate: 1.26%</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<p>我们可以看到，增加发送线程的数量提高了数据包发送速率，因此减少了运行时间（预期运行时间为 30 分钟，而预期运行时间为 14 分钟）。对于大多数用途，单个线程可能就足够了，但如果您需要提高性能、拥有高带宽上行链路，并且要扫描大部分 IPv4 空间，则可以使用该线程。</p>
<h2 id="提高扫描精度"><a href="#提高扫描精度" class="headerlink" title="提高扫描精度"></a>提高扫描精度</h2><p>ZMap 将以 的速率发送数据包<code>min(max rate your Network Interface Card (NIC) can sustain, the rate you specify with CLI flags)</code>。该速率<em>可能</em>高于您的 LAN 或目标子网的处理能力，从而导致数据包丢失和扫描结果不精确。</p>
<p>删除的<code>SYN</code>或<code>SYN ACK</code>将在 ZMap 中显示为相同，就好像根本不存在主机一样。由于 ZMap 直接组成以太网帧，因此无法保证交付。考虑到这一点，您可能希望降低<code>--rate=pps</code>或<code>--bandwidth=bps</code>确定您的命中率是否保持一致（表明您没有看到大量丢包&#x2F;漏报）。另一种选择是增加<code>--probes=N (default = 1)</code>. “探测”是 ZMap 术语，指的是 ZMap 发送到潜在主机的数据包，您可以对每个 IP&#x2F;端口对使用多个探测来尝试解决数据包丢失的情况。</p>
<h3 id="探测和重复数据删除"><a href="#探测和重复数据删除" class="headerlink" title="探测和重复数据删除"></a>探测和重复数据删除</h3><p>如上一节所述，您可能希望增加计数<code>--probes=N</code>以减少扫描中出现假阴性的可能性。然而，由于 ZMap 是无状态的，它如何防止给定 IP if<code>--probes=N</code>和 的多个日志<code>N &gt; 1</code>？</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 --probes=5 -B 100M --dedup-method=none 171.67.70.0/10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> 0:00 0%; send: 42 1 p/s (821 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">171.67.224.74</span><br><span class="line">171.67.224.74</span><br><span class="line">171.67.224.74</span><br><span class="line">171.67.224.74</span><br><span class="line">171.67.224.74</span><br><span class="line">171.67.35.131</span><br><span class="line">171.67.35.131</span><br><span class="line">171.67.35.131</span><br><span class="line">171.67.35.131</span><br><span class="line">171.67.35.131</span><br><span class="line">171.67.7.61</span><br><span class="line">171.67.7.61</span><br><span class="line">171.67.7.61</span><br><span class="line">171.67.7.61</span><br><span class="line">171.67.7.61</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<p>每次响应探测时，都会记录下来。默认情况下，<code>--dedup-method=window</code>窗口大小为1M。这意味着 ZMap 将跟踪内存中最后 1M 探测响应，以避免多次记录命中。您可以使用<code>--dedup-method=full</code>，但要了解内存需求将随着扫描空间的大小而增加。</p>
<blockquote>
<p>注意：我们已经说过 ZMap 是无状态的，但在这里我们似乎与该声明相矛盾，提到存储最后 1M 探测响应😄。 ZMap 在发送线程和接收线程之间是无状态的，但 ZMap 的接收线程可以保存状态以免记录重复项。</p>
</blockquote>
<h3 id="预期最大发送速率"><a href="#预期最大发送速率" class="headerlink" title="预期最大发送速率"></a>预期最大发送速率</h3><p>在我们的实验室环境中，具有 1 Gbit 有线以太网的现成 Ubuntu 虚拟机每秒可处理多达 1.3-145 万个数据包。使用无线连接、低端硬件或 LAN 带宽争用都可能对您的性能产生负面影响。</p>
<h2 id="其他扫描"><a href="#其他扫描" class="headerlink" title="其他扫描"></a>其他扫描</h2><h3 id="获取-N-个可达主机"><a href="#获取-N-个可达主机" class="headerlink" title="获取 N 个可达主机"></a>获取 N 个可达主机</h3><p>在前面的示例 ( <code>sudo zmap -p 80 -o &quot;output.csv&quot; -B 1G --sender-threads=4 171.67.70.0/2</code>) 中，我们使用了给定的子网。然而，也许您只想在 IPv4 空间中获得 10 个可访问的主机。您可以使用<code>--max-results=10</code>或<code>-N 10</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -B 100M -N 10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> 0:00 0%; send: 0 0 p/s (0 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line"> 0:00 0%; send: 0 0 p/s (0 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">104.252.154.129</span><br><span class="line">207.241.227.232</span><br><span class="line">34.102.143.17</span><br><span class="line">185.227.252.87</span><br><span class="line">88.218.93.178</span><br><span class="line">206.54.174.210</span><br><span class="line">50.3.14.225</span><br><span class="line">34.43.9.190</span><br><span class="line">184.84.170.239</span><br><span class="line">154.37.15.2</span><br><span class="line">Dec 05 22:19:22.112 [INFO] zmap: completed</span><br></pre></td></tr></table></figure>



<h3 id="再现性和随机搜索"><a href="#再现性和随机搜索" class="headerlink" title="再现性和随机搜索"></a>再现性和随机搜索</h3><p>再次运行上面的命令…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 -B 100M -N 10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> 0:00 0%; send: 0 0 p/s (0 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line"> 0:00 0%; send: 17 62.7 Kp/s (305 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">206.2.159.123</span><br><span class="line">47.251.50.46</span><br><span class="line">144.49.230.210</span><br><span class="line">34.220.245.127</span><br><span class="line">34.160.175.57</span><br><span class="line">216.180.232.245</span><br><span class="line">20.94.252.204</span><br><span class="line">172.65.73.3</span><br><span class="line">38.173.125.213</span><br><span class="line">172.67.201.97</span><br><span class="line">Dec 05 22:33:37.695 [INFO] zmap: completed</span><br></pre></td></tr></table></figure>



<p>这很有趣，我们得到了一组完全不同的 IP！当您定义给定的搜索空间时，ZMap 会随机而不是线性地扫描它。当我们想要像之前的扫描一样搜索整个搜索空间时，这并不是什么大问题，因为我们最终仍然会得到相同的（无序的）结果集。然而，在这种情况下，ZMap 在给定搜索空间中找到前 10 个命中时返回。 ZMap 的随机搜索模式导致输出出现这种差异。</p>
<p>为什么要随机搜索？发送端和接收端都可能发生资源争用。我们希望尽可能分散放置在接收子网上的负载，因此通过随机搜索搜索空间，我们可以分散在给定时间放置在给定网络上的负载。</p>
<p>您可能希望扫描顺序具有可重复性，因此您可以使用 来<code>--seed=n</code>确保后续运行使用相同的顺序。</p>
<h3 id="多个端口"><a href="#多个端口" class="headerlink" title="多个端口"></a>多个端口</h3><blockquote>
<p>ZMap v.4.0.0 中添加</p>
</blockquote>
<p>您可以扫描多个端口。在这种情况下，ZMap 将向<code>SYN</code>每个 IP&#x2F;端口对发送 TCP数据包。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 22,80 -B 100M -N 10 171.67.70.0/10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> 0:00 0%; send: 824 1 p/s (10.7 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line"> 0:00 0%; send: 1163 623 Kp/s (15.0 Kp/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%</span><br><span class="line">125.6.184.89,80</span><br><span class="line">125.6.189.199,80</span><br><span class="line">125.62.85.202,22</span><br><span class="line">125.62.86.43,22</span><br><span class="line">125.103.118.1,22</span><br><span class="line">125.135.32.198,80</span><br><span class="line">125.136.125.185,80</span><br><span class="line">125.140.210.154,80</span><br><span class="line">125.143.130.34,80</span><br><span class="line">125.137.239.225,80</span><br><span class="line">Nov 28 23:15:06.878 [INFO] zmap: completed</span><br></pre></td></tr></table></figure>



<h3 id="多个子网"><a href="#多个子网" class="headerlink" title="多个子网"></a>多个子网</h3><p>您也可以使用同一扫描来扫描多个子网。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zmap -p 80 10.0.0.0/8 192.168.0.0/16 (scan both subnets on TCP/80)</span><br></pre></td></tr></table></figure>



<h2 id="ZMap-的配置文件"><a href="#ZMap-的配置文件" class="headerlink" title="ZMap 的配置文件"></a>ZMap 的配置文件</h2><p>默认情况下，ZMap 不会扫描<em>整个</em>IPv4 空间。有两个文件包含默认情况下不扫描的子网。您可以更改这些文件以显式扫描这些范围，但是在每种情况下，默认情况下不扫描它们都是有原因的。</p>
<h3 id="blocklist-conf"><a href="#blocklist-conf" class="headerlink" title="blocklist.conf"></a><code>blocklist.conf</code></h3><p><code>blocklist.conf</code>包括 RFC 定义的子网（例如多播、保留&#x2F;未分配的<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1918">RFC 1918 ，默认情况下不扫描这些子网。如果您不希望扫描某些 IP&#x2F;子网，可以添加到此文件。</a></p>
<h3 id="zmap-conf"><a href="#zmap-conf" class="headerlink" title="zmap.conf"></a><code>zmap.conf</code></h3><p>如果您发现自己指定了某些设置，例如每次运行 ZMap 时的最大带宽或黑名单文件，您可以在其中指定这些设置<code>/etc/zmap/zmap.conf</code>或使用自定义配置文件。</p>
<h3 id="在您的安装中查找配置文件"><a href="#在您的安装中查找配置文件" class="headerlink" title="在您的安装中查找配置文件"></a>在您的安装中查找配置文件</h3><p><em>您通常</em>可以在安装中找到这些文件，位置为<code>/etc/zmap/...conf</code>。</p>
<p>如果您使用包管理器安装 ZMap，它可能已将配置文件安装在其自己的位置。</p>
<p>例如，<code>homebrew</code>将配置文件安装在<code>/opt/homebrew/etc/zmap/</code>.如果您无法找到这些文件，请尝试<code>sudo find . -name &quot;blocklist.conf&quot; -maxdepth 5</code>在安装 ZMap 后从根目录运行。</p>

        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="disabled" href="/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/2/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                     渗 透 测 试 ， 让 漏 洞 无 所 遁 形 ！ 电 子 取 证 ， 让 证 据 诉 说 答 案 ！ 占 卜 术 ， 一 起 揭 示 宇 宙 奥 秘 ！ 
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2025/01/18/APKDeeplens-%E8%87%AA%E5%8A%A8%E5%AF%B9APK%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0-%E9%A1%BA%E4%BE%BF%E5%87%BA%E4%B8%AA%E6%8A%A5%E5%91%8A/">APKDeeplens-自动对APK进行安全评估-</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/apk2url-%E8%87%AA%E5%8A%A8%E6%8F%90%E5%8F%96apk%E4%B8%AD%E7%9A%84ip%E5%92%8C%E5%9F%9F%E5%90%8D%E5%B7%A5%E5%85%B7/">apk2url-自动提取apk中的ip和域名工具</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/X-Recon-XSS%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%99%A8/">X-Recon-XSS漏洞扫描器</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2025/01/18/dirmap-%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F%E7%A5%9E%E5%99%A8/">dirmap-路径扫描神器</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">电子取证</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/Sgyling/Hack-tools">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://t.me/time_766">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:sgyling@gmail.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    这里要填写备案信息,但...但...但是我忘啦~
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>